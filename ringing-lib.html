<html lang="en">
<head>
<title>The Ringing Class Library</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="The Ringing Class Library">
<meta name="generator" content="makeinfo 4.7">
<link title="Top" rel="top" href="#Top">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc { font-variant:small-caps }
  span.roman { font-family: serif; font-weight: normal; } 
--></style>
</head>
<body>
This is the manual for the Ringing Class Library, version
0.3.0.  Last updated 11 May 2005.

   <p>Copyright 2001&ndash;4 Martin Bright, Mark Banner and Richard Smith

   <p>Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.1
or any later version published by the Free Software Foundation;
with no Invariant Sections, with no Front-Cover Texts,
and with no Back-Cover Texts.  A copy of the license is included in
the section entitled &ldquo;GNU Free Documentation License&rdquo;.

<div class="node">
<p><hr>
<a name="Top"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Introduction">Introduction</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#dir">(dir)</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dir">(dir)</a>
<br>
</div>

<h2 class="unnumbered">The Ringing Class Library</h2>

<p>The Ringing Class Library (ringing-lib) is a library of C++ classes designed
for writing change ringing application programs.

   <p>This menu lists the available topics in the documentation. This
documentation is also available in GNU Info and PDF
versions.

<div class="contents">
<h2>Table of Contents</h2>
<ul>
<li><a name="toc_Top" href="#Top">The Ringing Class Library</a>
<li><a name="toc_Introduction" href="#Introduction">1 Introduction</a>
<li><a name="toc_Installing-and-using-the-library" href="#Installing-and-using-the-library">2 Installing and using the library</a>
<ul>
<li><a href="#Licensing">2.1 Licensing</a>
<li><a href="#The-Standard-Template-Library">2.2 The Standard Template Library</a>
<li><a href="#Unix_002dlike-systems">2.3 Unix-like systems</a>
<li><a href="#Microsoft-Windows">2.4 Microsoft Windows</a>
<li><a href="#Testing-the-library">2.5 Testing the library</a>
<li><a href="#Using-the-library-in-your-programs">2.6 Using the library in your programs</a>
</li></ul>
<li><a name="toc_Rows-and-changes" href="#Rows-and-changes">3 Row and change classes</a>
<ul>
<li><a href="#Row-Operations">3.1 Row operations</a>
<li><a href="#Row-Properties">3.2 Row properties</a>
<li><a href="#Changes">3.3 Changes</a>
<li><a href="#The-bell-Class">3.4 The <code>bell</code> class</a>
<ul>
<li><a href="#bell-Derivation">3.4.1 Derivation</a>
<li><a href="#bell-Constructors">3.4.2 Constructors</a>
<li><a href="#bell-Operators">3.4.3 Operators</a>
<li><a href="#Other-bell-Functions">3.4.4 Other functions</a>
</li></ul>
<li><a href="#The-row-Class">3.5 The <code>row</code> class</a>
<ul>
<li><a href="#row-Derivation">3.5.1 Derivation</a>
<li><a href="#row-Constructors">3.5.2 Constructors</a>
<li><a href="#row-Operators">3.5.3 Operators</a>
<li><a href="#Other-row-Functions">3.5.4 Other functions</a>
<li><a href="#row-static-Functions">3.5.5 <code>static</code> functions</a>
</li></ul>
<li><a href="#The-change-Class">3.6 The <code>change</code> class</a>
<ul>
<li><a href="#change-Derivation">3.6.1 Derivation</a>
<li><a href="#change-Constructors">3.6.2 Constructors</a>
<li><a href="#change-Operators">3.6.3 Operators</a>
<li><a href="#Other-change-Functions">3.6.4 Other functions</a>
</li></ul>
<li><a href="#The-permute-function">3.7 The <code>permute</code> function</a>
<li><a href="#The-row_005fblock-class">3.8 The <code>row_block</code> class</a>
<ul>
<li><a href="#row_005fblock-Derivation">3.8.1 Derivation</a>
<li><a href="#row_005fblock-Constructors">3.8.2 Constructors</a>
<li><a href="#Other-row_005fblock-Functions">3.8.3 Other functions</a>
</li></ul>
<li><a href="#Other-functions-in-row_002eh">3.9 Other functions in <span class="file">row.h</span></a>
</li></ul>
<li><a name="toc_Methods" href="#Methods">4 Method classes</a>
<ul>
<li><a href="#The-method-Class">4.1 The <code>method</code> class</a>
<ul>
<li><a href="#method-Derivation">4.1.1 Derivation</a>
<li><a href="#method-Constructors">4.1.2 Constructors</a>
<li><a href="#Other-method-Functions">4.1.3 Other functions</a>
<li><a href="#method-static-Functions">4.1.4 <code>static</code> functions</a>
<li><a href="#method-static-Variables">4.1.5 <code>static</code> variables</a>
</li></ul>
</li></ul>
<li><a name="toc_Method-libraries" href="#Method-libraries">5 Method libraries</a>
<ul>
<li><a href="#Using-libraries">5.1 Using libraries</a>
<ul>
<li><a href="#Initialisation-for-libraries">5.1.1 Initialisation</a>
<li><a href="#The-library-class">5.1.2 The <code>library</code> class</a>
<ul>
<li><a href="#library-derivation">5.1.2.1 Derivation</a>
<li><a href="#library-constructors">5.1.2.2 Constructors</a>
<li><a href="#library-iteration-functions">5.1.2.3 Iteration functions</a>
<li><a href="#Other-library-functions">5.1.2.4 Other functions</a>
</li></ul>
<li><a href="#The-library_005fentry-class">5.1.3 The <code>library_entry</code> class</a>
<li><a href="#Facets">5.1.4 Facets</a>
<ul>
<li><a href="#Built_002din-facets">5.1.4.1 Built-in facets</a>
</li></ul>
</li></ul>
<li><a href="#Built_002din-library-types">5.2 Built-in library types</a>
<ul>
<li><a href="#XML-libraries">5.2.1 XML libraries</a>
<ul>
<li><a href="#The-xmllib-class">5.2.1.1 The <code>xmllib</code> class</a>
<li><a href="#XML-library-facets">5.2.1.2 XML library facets</a>
</li></ul>
<li><a href="#Central-Council-libraries">5.2.2 Central Council libraries</a>
<ul>
<li><a href="#The-cclib-class">5.2.2.1 The <code>cclib</code> class</a>
<li><a href="#Central-Council-library-facets">5.2.2.2 Central Council library facets</a>
</li></ul>
<li><a href="#MicroSIRIL-libraries">5.2.3 MicroSIRIL libraries</a>
<ul>
<li><a href="#The-mslib-class">5.2.3.1 The <code>mslib</code> class</a>
<li><a href="#MicroSIRIL-library-facets">5.2.3.2 MicroSIRIL library facets</a>
</li></ul>
</li></ul>
<li><a href="#Library-framework">5.3 Library framework</a>
<ul>
<li><a href="#The-library_005fbase-class">5.3.1 The <code>library_base</code> class</a>
<li><a href="#The-library_005fbase-const_005fiterator-class">5.3.2 The <code>library_base::const_iterator</code> class</a>
<li><a href="#library-internals">5.3.3 <code>library</code> internals</a>
<li><a href="#library_005fentry-internals">5.3.4 The <code>library_entry</code> internals</a>
<li><a href="#The-library_005fentry-impl-class">5.3.5 The <code>library_entry::impl</code> class</a>
</li></ul>
<li><a href="#Implementing-new-library-classes">5.4 Implementing new library classes</a>
<ul>
<li><a href="#Supporting-auto_002ddetection">5.4.1 Supporting auto-detection</a>
<li><a href="#Alternative-creation-mechanisms">5.4.2 Alternative creation mechanisms</a>
<li><a href="#Subclassing-library_005fbase">5.4.3 Subclassing library_base</a>
<li><a href="#Subclassing-library_005fentry-impl">5.4.4 Subclassing library_entry impl</a>
</li></ul>
</li></ul>
<li><a name="toc_Proof" href="#Proof">6 Method and Touch Proving</a>
<ul>
<li><a href="#The-proof-class">6.1 The <code>proof</code> class</a>
<ul>
<li><a href="#proof-Derivation">6.1.1 Derivation</a>
<li><a href="#proof-Constructors">6.1.2 Constructors</a>
<li><a href="#proof-Functions">6.1.3 Functions</a>
<li><a href="#proof-Operators">6.1.4 Operators</a>
<li><a href="#proof-Output">6.1.5 Output</a>
<li><a href="#Falseness-Storage">6.1.6 How falseness is stored</a>
<li><a href="#How-Proof-Works">6.1.7 How it works</a>
<li><a href="#How-Proof-Works">6.1.8 Single Extent</a>
<li><a href="#How-Proof-Works">6.1.9 Multiple Extents</a>
</li></ul>
</li></ul>
<li><a name="toc_Musical-Analysis" href="#Musical-Analysis">7 Analysis of Music</a>
<ul>
<li><a href="#Stroke-Enumeration">7.1 Stroke Description</a>
<li><a href="#Music-Regular-Expressions">7.2 Music Regular Expressions</a>
<ul>
<li><a href="#Expression-Language">7.2.1 Music Regular Expression Language</a>
<li><a href="#Music_005fDetails-class">7.2.2 Music Details class</a>
</li></ul>
<li><a href="#Using-the-Music-Class">7.3 Using the Music Class</a>
<li><a href="#music-class-definition">7.4 Music Class definition</a>
<ul>
<li><a href="#Music-Derivation">7.4.1 Derivation</a>
<li><a href="#Music-Constructors">7.4.2 Constructors</a>
<li><a href="#Music-Type-Definitions">7.4.3 Type Definitions</a>
<li><a href="#Music-Functions">7.4.4 Functions</a>
</li></ul>
<li><a href="#music-node-class-definition">7.5 Music Node Class definition</a>
<ul>
<li><a href="#Music_005fNode-Full-Description">7.5.1 Full Description</a>
<li><a href="#Music_005fNode-Derivation">7.5.2 Derivation</a>
<li><a href="#Music_005fNode-Constructors-and-Destructors">7.5.3 Constructors and Destructors</a>
<li><a href="#Music_005fNode-Type-Definitions">7.5.4 Type Definitions</a>
<li><a href="#Music_005fNode-Functions">7.5.5 Functions</a>
<li><a href="#Music_005fNode-Exceptions">7.5.6 Exceptions</a>
</li></ul>
</li></ul>
<li><a name="toc_Producing-printed-output" href="#Producing-printed-output">8 Producing printed output</a>
<ul>
<li><a href="#Auxiliary-classes">8.1 Auxiliary classes</a>
<ul>
<li><a href="#The-dimension-class">8.1.1 The <code>dimension</code> class</a>
<li><a href="#The-colour-class">8.1.2 The <code>colour</code> class</a>
<li><a href="#The-text_005fstyle-class">8.1.3 The <code>text_style</code> class</a>
</li></ul>
<li><a href="#The-printpage-class">8.2 The <code>printpage</code> class</a>
<li><a href="#The-printrow-class">8.3 The <code>printrow</code> class</a>
<ul>
<li><a href="#Using-the-printrow-class">8.3.1 Using the <code>printrow</code> class</a>
<li><a href="#Row-printing-options">8.3.2 Row printing options</a>
</li></ul>
<li><a href="#Printing-whole-methods">8.4 Printing whole methods</a>
<ul>
<li><a href="#Method-printing-parameters">8.4.1 Method printing parameters</a>
<li><a href="#Using-the-printmethod-object">8.4.2 Using the <code>printmethod</code> object</a>
</li></ul>
<li><a href="#Printing-in-PostScript">8.5 Printing in PostScript</a>
<li><a href="#Printing-to-PDF-files">8.6 Printing to <acronym>PDF</acronym> files</a>
</li></ul>
<li><a name="toc_Copying-this-manual" href="#Copying-this-manual">Appendix A Copying this manual</a>
<ul>
<li><a href="#GNU-Free-Documentation-License">A.1 GNU Free Documentation License</a>
<ul>
<li><a href="#GNU-Free-Documentation-License">A.1.1 ADDENDUM: How to use this License for your documents</a>
</li></ul>
</li></ul>
<li><a name="toc_Index" href="#Index">Index</a>
</li></ul>
</div>

<ul class="menu">
<li><a accesskey="1" href="#Introduction">Introduction</a>
<li><a accesskey="2" href="#Installing-and-using-the-library">Installing and using the library</a>
<li><a accesskey="3" href="#Rows-and-changes">Rows and changes</a>
<li><a accesskey="4" href="#Methods">Methods</a>
<li><a accesskey="5" href="#Method-libraries">Method libraries</a>
<li><a accesskey="6" href="#Proof">Proof</a>
<li><a accesskey="7" href="#Musical-Analysis">Musical Analysis</a>
<li><a accesskey="8" href="#Producing-printed-output">Producing printed output</a>
<li><a accesskey="9" href="#Copying-this-manual">Copying this manual</a>
<li><a href="#Index">Index</a>
</ul>

<div class="node">
<p><hr>
<a name="Introduction"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Installing-and-using-the-library">Installing and using the library</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Top">Top</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">1 Introduction</h2>

<p><a name="index-introduction-1"></a>
The Ringing Class Library is a collection of C++ classes which implement
various concepts found in change ringing, and make it possible to
implement programs which use these concepts without having to write the
basic algorithms over and over again.

   <p>The library is split into several sections:
     <ul>
<li>Classes for dealing with individual rows and changes, and how the
interact with each other;

     <li>Classes for building and manipulating methods;

     <li>Classes for accessing method libraries;

     <li>Classes for proving and analysing sequences of rows;

     <li>Classes for producing printed output. 
</ul>

   <p>Thus it is possible to use whatever part of the library is necessary for
your program; for example, a method editing program would use the method
classes, whereas a program to simulate call changes would just use the
row and change classes.

   <p>There are also several utilities included with the library.  These
demonstrate how to use the Ringing Class Library in your own programs,
and are useful in their own right.  Currently included are
<span class="command">gsiril</span>, a peal proving program with an interface similar to
the popular MicroSIRIL program; <span class="command">psline</span>, a utility to print
lines for methods in <acronym>PDF</acronym> or PostScript; and
<span class="command">methsearch</span>, a program which searches for methods satisfying
various given criteria.  These utilities may be found in the <span class="file">apps</span>
subdirectory.

   <p>To get information about latest releases of the Ringing Class Library,
to report bugs, request features, use forums and access the CVS
repository, visit the project web page at
<a href="http://ringing-lib.sourceforge.net">http://ringing-lib.sourceforge.net</a>.

<div class="node">
<p><hr>
<a name="Installing-and-using-the-library"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Rows-and-changes">Rows and changes</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Introduction">Introduction</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">2 Installing and using the library</h2>

<p><a name="index-installation-2"></a>
The Ringing Class Library has been developed primarily for use on
Unix-like and Microsoft Windows platforms.  As the library is written in
portable C++ and uses only standard library functions, it should be
possible to use it on any standard-conforming platform.  If you do find
a platform on which it is not possible to compile and use the library,
the authors would be interested to hear about it.

   <p>Various characteristics of the C++ compiler need to be determined before
compiling the library, and are assumed to be that same when the library
is compiled and linked into an application.  If you get a new C++
compiler or a new standard C++ library, you should reconfigure and
(probably) recompile the library before trying to use it in an
application.  The necessary data is stored in <span class="file">ringing/common.h</span>:
on Unix systems this file is generated automatically; on other systems,
you may have to generate it by hand from the template in
<span class="file">ringing/common.h.in</span>.

<ul class="menu">
<li><a accesskey="1" href="#Licensing">Licensing</a>
<li><a accesskey="2" href="#The-Standard-Template-Library">The Standard Template Library</a>
<li><a accesskey="3" href="#Unix_002dlike-systems">Unix-like systems</a>
<li><a accesskey="4" href="#Microsoft-Windows">Microsoft Windows</a>
<li><a accesskey="5" href="#Testing-the-library">Testing the library</a>
<li><a accesskey="6" href="#Using-the-library-in-your-programs">Using the library in your programs</a>
</ul>

<div class="node">
<p><hr>
<a name="Licensing"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#The-Standard-Template-Library">The Standard Template Library</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Installing-and-using-the-library">Installing and using the library</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Installing-and-using-the-library">Installing and using the library</a>
<br>
</div>

<h3 class="section">2.1 Licensing</h3>

<p>As of version 0.2.9, the Ringing Class Library is split into two parts,
which are licensed differently.  This is explained again in the file
<span class="file">COPYING</span> in the distribution.  A summary is given here, but to be
sure you should consult individual files for their licensing conditions.

     <ul>
<li>Most of the library is released under the GNU Public License
(<acronym>GPL</acronym>).  A copy of this licence can be found in the file
<span class="file">COPYING.GPL</span> in the top directory of the distribution.  This
licence allows you to copy, modify and distribute the library, provided
that you stay within the stated terms.  However, it does <strong>not</strong>
allow you to include the library in your own commercial programs.  Any
programs which use the library must again be free.  For full details,
please read the text of the licence.

     <li>A <dfn>core</dfn> part of the library is under the Lesser GNU Public License
(<acronym>LGPL</acronym>).  A copy of this licence can be found in the file
<span class="file">COPYING.LGPL</span> in the top directory of the distribution.  Unlike
the <acronym>GPL</acronym>, this licence <em>does</em> allow you to use this part
of the library in commercial programs.  The reason for releasing the
core part of the library under the <acronym>LGPL</acronym> is principally to
encourage authors to use the online method database at
<a href="http://methods.ringing.org/">http://methods.ringing.org/</a> in their programs, whether commercial
or not.  All the files you need to use that database are under the
<acronym>LGPL</acronym>. 
</ul>

   <blockquote>
<b>Important:</b> Using any part of the library in a commercial program, <em>except</em> for
those parts specifically stated to be under the weaker <acronym>LGPL</acronym>,
is against the terms of the licence.  If in doubt, ask the authors. 
</blockquote>

<div class="node">
<p><hr>
<a name="The-Standard-Template-Library"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Unix_002dlike-systems">Unix-like systems</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Licensing">Licensing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Installing-and-using-the-library">Installing and using the library</a>
<br>
</div>

<h3 class="section">2.2 The Standard Template Library</h3>

<p><a name="index-Standard-Template-Library-3"></a><a name="index-STL-4"></a>
Before you can use the Ringing Class Library, you will need to have a
copy of the Standard Template Library (<acronym>STL</acronym>) which works with
your compiler. The <acronym>STL</acronym> is a set of templates which define
containers such as lists and sets, iterators to move through them, and
various other useful things.  If your compiler complains about not being
able to find files such as <span class="file">vector.h</span> and <span class="file">list.h</span> then this
probably means that you don't have the <acronym>STL</acronym> and need to get
hold of it.

   <p>A suitable version of the <acronym>STL</acronym> is included with most major C++
compilers.  If you don't have a working version, you may be able to
download one: in particular, there is a free implementation of the
<acronym>STL</acronym> available currently at <a href="http://www.sgi.com/tech/stl">http://www.sgi.com/tech/stl</a>. 
Implementations differ slightly in how the header files are named and
whether namespaces are used.  If you are compiling the Ringing Class
Library on a Unix-like platform, the configuration process should take
care of finding out how your particular implementation works. 
Otherwise, you will need to edit the file <span class="file">ringing/common.h.in</span>
before compiling.

<div class="node">
<p><hr>
<a name="Unix_002dlike-systems"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Microsoft-Windows">Microsoft Windows</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-Standard-Template-Library">The Standard Template Library</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Installing-and-using-the-library">Installing and using the library</a>
<br>
</div>

<h3 class="section">2.3 Unix-like systems</h3>

<p>The Ringing Class Library package uses the GNU tool <span class="command">autoconf</span>
to take away the problems of coping with differences between platforms. 
This means that you should be able to change to the top-level directory
of the source distribution and type
<pre class="example">     ./configure
</pre>
   <p class="noindent">to configure the package.  This will determine the characteristics of
your C++ compiler and create a file <span class="file">ringing/common.h</span> which defines
various symbols used in the compilation.  This file is also installed
with the rest of the class library, so that the installed header files
will have access to it.

   <p>You can control many aspects of how the package is compiled and installed
by passing arguments to the <span class="command">configure</span> script; for example, you
can control where the library is installed (for example, in <span class="file">/usr/lib</span>
or <span class="file">/usr/local/lib</span>).  For details of all the options which are
accepted, type
<pre class="example">     ./configure --help
</pre>
   <p class="noindent">in the top-level directory of the distribution.  Some more instructions
for using the <span class="command">configure</span> script are given in the file
<span class="file">INSTALL</span>.

   <p>On most platforms, it should be possible to build and install either
static or dynamic libraries, or both.

<div class="node">
<p><hr>
<a name="Microsoft-Windows"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Testing-the-library">Testing the library</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Unix_002dlike-systems">Unix-like systems</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Installing-and-using-the-library">Installing and using the library</a>
<br>
</div>

<h3 class="section">2.4 Microsoft Windows</h3>

<p>When compiling on Microsoft Windows, the range of different compilers and
lack of a standard powerful scripting language make it difficult to
provide a genuinely portable infrastructure to the package.  However, the
task of compiling and installing the library is not complicated, and easy
to achieve by hand.  The following steps are necessary:
     <ul>
<li>Create the file <span class="file">ringing/common-ac.h</span> by editing
<span class="file">common-ac.h.in</span> to reflect the characteristics of your C++ compiler;

     <li>Compile all the <span class="file">.cpp</span> source files in the <span class="file">ringing</span>
subdirectory into a library, which you will probably want to call
<span class="file">ringing.lib</span>;

     <li>Install the compiled library and the header files in places where
your compiler and linker will be able to find them;

     <li>Optionally, install and run the tests in the <span class="file">tests</span>
subdirectory.

     <li>Copy the documentation to somewhere permanent.

     <li>If desired, compile and install the utilities in the <span class="file">apps</span>
subdirectory. 
</ul>

   <p>Note that the header files are designed to be included from a
subdirectory called <span class="file">ringing</span> within your system's collection of
header files.

   <p>If you wish to compile only the part of the library which is licensed
for use in commercial programs, make sure you only compile and link
those files which explicitly state that they are under the Lesser GNU
Public License <acronym>LGPL</acronym>.  See <a href="#Licensing">Licensing</a>.

   <p>If you are using Microsoft Developer Studio, then you can use the
supplied workspace file <span class="file">ringing-lib.dsw</span> to accomplish the
compiling and linking of the library without any effort.  In addition,
with the Microsoft Visual Studio compiler you do not need to edit
<span class="file">ringing/common-ac.h</span> by hand: there is a ready-customised version,
called <span class="file">common-msvc.h</span>, which will be found and used automatically.

   <p>Currently the class library should normally be compiled into a static
library (<span class="file">.lib</span> file).  It is not yet straightforward to make the
library into a DLL; if you choose to do this, you are on your own but
the authors would be please to hear of any success.

<div class="node">
<p><hr>
<a name="Testing-the-library"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Using-the-library-in-your-programs">Using the library in your programs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Microsoft-Windows">Microsoft Windows</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Installing-and-using-the-library">Installing and using the library</a>
<br>
</div>

<h3 class="section">2.5 Testing the library</h3>

<p>The library is provided with basic test facilities that
exercise the main classes and provide confidence that they are working
correctly.

   <p>The tests are found under the <span class="file">tests</span> directory and are linked into
one executable called <span class="command">test</span>. If all tests are succesfully a message
will be printed stating this on the last line of output of the program.

<div class="node">
<p><hr>
<a name="Using-the-library-in-your-programs"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Testing-the-library">Testing the library</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Installing-and-using-the-library">Installing and using the library</a>
<br>
</div>

<h3 class="section">2.6 Using the library in your programs</h3>

<p>To use the Ringing Class Library in your programs, you simply include
the relevant header files in your source code, and then link the library
into your final program.

   <p>Header files are expected to be found in the subdirectory <span class="file">ringing</span>;
thus you might type

<pre class="example">     #include &lt;ringing/row.h&gt;
     #include &lt;ringing/proof.h&gt;
</pre>
   <p class="noindent">at the top of a C++ source code file.  If this does not work, either your
compiler is not looking in the right place for the header files, or you
have not installed them in the right place.  You may be able to correct
this by adding an option (<code>-I</code> on most systems) to your compiler
command line.

   <p>To link to the installed library, simply add the appropriate option to
the command line when linking your program.  On most Unix systems, you
will have to add <code>-lringing</code> to link with the library.

<div class="node">
<p><hr>
<a name="Rows-and-changes"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Methods">Methods</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Installing-and-using-the-library">Installing and using the library</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">3 Row and change classes</h2>

<p><a name="index-row-5"></a><a name="index-change-6"></a>
Classes for manupulating rows and changes, and all the other classes and
functions described in this chapter, are declared in <span class="file">ringing/row.h</span>.

   <p>For ease of notation, we use the idea that a <dfn>row</dfn> is an individual
permutation of bells (such as <span class="samp">13572468</span>), and a <dfn>change</dfn> is a
means of getting from one row to another, by swapping pairs of bells;
the most convenient way to write a change is a place notation (for
example <span class="samp">X</span> or <span class="samp">1258</span>).

<ul class="menu">
<li><a accesskey="1" href="#Row-Operations">Row Operations</a>:               Explanation of algebra on rows
<li><a accesskey="2" href="#Row-Properties">Row Properties</a>:               Explanation of other properties of rows
<li><a accesskey="3" href="#Changes">Changes</a>:                      How ringing-lib deals with changes
<li><a accesskey="4" href="#The-bell-Class">The bell Class</a>
<li><a accesskey="5" href="#The-row-Class">The row Class</a>
<li><a accesskey="6" href="#The-change-Class">The change Class</a>
<li><a accesskey="7" href="#The-permute-function">The permute function</a>
<li><a accesskey="8" href="#The-row_005fblock-class">The row_block class</a>
<li><a accesskey="9" href="#Other-functions-in-row_002eh">Other functions in row.h</a>
</ul>

<div class="node">
<p><hr>
<a name="Row-Operations"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Row-Properties">Row Properties</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Rows-and-changes">Rows and changes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Rows-and-changes">Rows and changes</a>
<br>
</div>

<h3 class="section">3.1 Row operations</h3>

<p><a name="index-row-algebra-7"></a><a name="index-algebra-of-rows-8"></a><a name="index-row-operations-9"></a><a name="index-transposition-10"></a>
Rows have a set of operations which we can use on them; in mathematical
terms, they form a group. The most important operation is that of row
multiplication or transposition - in this operation, the bells in one
row are rearranged according to the order given by another row.

   <p>For example,
<pre class="example">     21345678 * 13572468 = 23571468
</pre>
   <p class="noindent">and
<pre class="example">     13572468 * 21345678 = 31572468
</pre>
   <p>Note that the two above examples do <em>not</em> give the same result;
that is, the order in which two things are multiplied does matter.

   <p>As an example of how row multiplication is used, suppose that we want to
know the 4th row of the lead of Plain Bob Major with lead head
<span class="samp">17856342</span>. The 4th row of the first lead (which has a lead head of
rounds) is <span class="samp">42618375</span>. Multiplying these together gives us the
answer we are looking for, namely <span class="samp">57312846</span>.

   <p>The identity for this operation is rounds; in other words, any row
multiplied by rounds gives itself, and rounds multiplied by any row
gives that row.

   <p>It is possible to define the inverse of a row as the row which, when
multiplied by that row, will give rounds. For example, the inverse of
<span class="samp">13572468</span> is <span class="samp">15263748</span>, as
<pre class="example">     13572468 * 15263748 = 12345678
</pre>
   <p>The opposite of row multiplication is row division. If <span class="samp">a * b = c</span>,
we can define <span class="samp">c / b = a</span>. Using the same example as above, suppose
we have a lead of Plain Bob Major and we know that the fourth row is
<span class="samp">57312846</span>, and we wish to find the lead head. Just divide by the
fourth row of the plain course (<span class="samp">42618375</span>) to get the answer.

<div class="node">
<p><hr>
<a name="Row-Properties"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Changes">Changes</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Row-Operations">Row Operations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Rows-and-changes">Rows and changes</a>
<br>
</div>

<h3 class="section">3.2 Row properties</h3>

<p><a name="index-row-properties-11"></a>
There are several properties of rows which arise from group theory and
can be useful in looking at properties of methods.

   <p><a name="index-order-12"></a>The <dfn>order</dfn> of a row is the number of times which that row has to be
multiplied by itself before it gets back to rounds. For example, the row
<span class="samp">21436587</span> has order 2, because if it is multiplied by itself
twice, you get back to rounds. Similarly the row <span class="samp">23145678</span> has
order 3, and the row <span class="samp">23456781</span> has order 8. This can be useful,
for example, in seeing how many leads of a method are needed in a plain
course before it comes round.

   <p><a name="index-sign-13"></a><a name="index-parity-14"></a>Another useful concept is the <dfn>sign</dfn> or <dfn>parity</dfn> of a row. A row
is considered <dfn>even</dfn> if it takes an even number of swaps of pairs of
bells to get from rounds to that row, and <dfn>odd</dfn> if it takes an odd
number of swaps. (It can be shown that whether the number is odd or even
doesn't depend on exactly what the sequence of swaps is).

   <p><a name="index-cycles-15"></a>Finally, every row can be expressed as a set of <dfn>cycles</dfn>. A cycle is
a set of bells which move round in a sequential way as the row is
repeated; for example, <span class="samp">21345678</span> has only one cycle, which is
<span class="samp">(12)</span>; and <span class="samp">12356478</span> has one cycle, which is
<span class="samp">(456)</span>. Combining these two cycles will give us the row <span class="samp">213564678</span>.

<div class="node">
<p><hr>
<a name="Changes"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#The-bell-Class">The bell Class</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Row-Properties">Row Properties</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Rows-and-changes">Rows and changes</a>
<br>
</div>

<h3 class="section">3.3 Changes</h3>

<p><a name="index-change-16"></a>
A <dfn>change</dfn> is a means for getting from one row to another. It works
by swapping over pairs of bells, and no bell may move more than one
place.

   <p><a name="index-place-notation-17"></a><a name="index-swap-18"></a>The normal way of representing a change is by place notation; a single
change is represented by a series of numbers which each correspond to a
place being made; for example, <span class="samp">12</span> means that all bells swap,
apart from the 1 and the 2, which stay in the same place. If all the
bells swap, the place notation is <span class="samp">X</span>.

<div class="node">
<p><hr>
<a name="The-bell-Class"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#The-row-Class">The row Class</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Changes">Changes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Rows-and-changes">Rows and changes</a>
<br>
</div>

<h3 class="section">3.4 The <code>bell</code> class</h3>

<p><a name="index-_0040code_007bbell_007d-class-19"></a>
The <code>bell</code> class represents a single bell.  An object of type
<code>bell</code> is essentially an integer, and bells are numbered starting
with the treble as 0.  Member functions are provided to convert between
this numerical representation and a printable character.  The class
library can cope with up to 256 bells, though only bells numbered from 0
to 32 may be described by a printable character.

<ul class="menu">
<li><a accesskey="1" href="#bell-Derivation">bell Derivation</a>
<li><a accesskey="2" href="#bell-Constructors">bell Constructors</a>
<li><a accesskey="3" href="#bell-Operators">bell Operators</a>
<li><a accesskey="4" href="#Other-bell-Functions">Other bell Functions</a>
</ul>

<div class="node">
<p><hr>
<a name="bell-Derivation"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#bell-Constructors">bell Constructors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-bell-Class">The bell Class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-bell-Class">The bell Class</a>
<br>
</div>

<h4 class="subsection">3.4.1 Derivation</h4>

<p>This class is not derived from any other classes.

<pre class="example">     class bell;
</pre>
   <div class="node">
<p><hr>
<a name="bell-Constructors"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#bell-Operators">bell Operators</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#bell-Derivation">bell Derivation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-bell-Class">The bell Class</a>
<br>
</div>

<h4 class="subsection">3.4.2 Constructors</h4>

<div class="defun">
&mdash; Constructor:  <b>bell::bell</b> (<var>void</var>)<var>;<a name="index-bell_003a_003abell-20"></a></var><br>
<blockquote><p>This constructor initialises the bell object to zero (0). 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>bell::bell</b> (<var>int i</var>)<var>;<a name="index-bell_003a_003abell-21"></a></var><br>
<blockquote><p>This constructor initialises the bell object to the integer <var>i</var>,
where bells are numbered starting from 0. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="bell-Operators"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Other-bell-Functions">Other bell Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#bell-Constructors">bell Constructors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-bell-Class">The bell Class</a>
<br>
</div>

<h4 class="subsection">3.4.3 Operators</h4>

<div class="defun">
&mdash; Operator: bell&amp; <b>bell::operator=</b> (<var>int i</var>)<var>;<a name="index-bell_003a_003aoperator_003d-22"></a></var><br>
<blockquote><p>This assigns the integer value <var>i</var> to the bell object, where bells
are numbered starting from 0. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: int <b>bell::operator int</b> (<var>void</var>)<var>;<a name="index-bell_003a_003aoperator-int-23"></a></var><br>
<blockquote><p>This casts a bell object to the corresponding integer. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: ostream&amp; <b>operator&lt;&lt;</b> (<var>ostream&amp; o, const bell b</var>)<var>;<a name="index-operator_003c_003c-24"></a></var><br>
<blockquote><p>This operator writes the character representing the bell <var>b</var> to the
output stream <var>o</var>. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Other-bell-Functions"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#bell-Operators">bell Operators</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-bell-Class">The bell Class</a>
<br>
</div>

<h4 class="subsection">3.4.4 Other functions</h4>

<div class="defun">
&mdash; Function: bell&amp; <b>bell::from_char</b> (<var>char c</var>)<var>;<a name="index-bell_003a_003afrom_005fchar-25"></a></var><br>
<blockquote><p>This function interprets the character <var>c</var> as a bell, and assigns
that value to the bell object.  See the next function for the mapping
between characters and bells.  If the character does not represent a
valid bell, then an exception of the class <code>bell::invalid</code> is
thrown; if you have disabled exceptions, the bell is set to the value
<code>bell::MAX_BELLS</code>.  The function returns <code>*this</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: char <b>bell::to_char</b> (<var>void</var>)<var> const;<a name="index-bell_003a_003ato_005fchar-26"></a></var><br>
<blockquote><p>This function returns a character indicating the bell represented by the
object.  The characters used are, in order:
     <pre class="example">          1234567890ETABCDFGHJKLMNPQRSUVWYZ
     </pre>
        </blockquote></div>

<div class="node">
<p><hr>
<a name="The-row-Class"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#The-change-Class">The change Class</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-bell-Class">The bell Class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Rows-and-changes">Rows and changes</a>
<br>
</div>

<h3 class="section">3.5 The <code>row</code> class</h3>

<p><a name="index-_0040code_007brow_007d-class-27"></a>
The <code>row</code> class stores a single row. It provides extensive
functions to manipulate rows and perform operations on them.

<ul class="menu">
<li><a accesskey="1" href="#row-Derivation">row Derivation</a>
<li><a accesskey="2" href="#row-Constructors">row Constructors</a>
<li><a accesskey="3" href="#row-Operators">row Operators</a>
<li><a accesskey="4" href="#Other-row-Functions">Other row Functions</a>
<li><a accesskey="5" href="#row-static-Functions">row static Functions</a>
</ul>

<div class="node">
<p><hr>
<a name="row-Derivation"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#row-Constructors">row Constructors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-row-Class">The row Class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-row-Class">The row Class</a>
<br>
</div>

<h4 class="subsection">3.5.1 Derivation</h4>

<p>This class is not derived from any other classes.

<pre class="example">     class row;
</pre>
   <div class="node">
<p><hr>
<a name="row-Constructors"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#row-Operators">row Operators</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#row-Derivation">row Derivation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-row-Class">The row Class</a>
<br>
</div>

<h4 class="subsection">3.5.2 Constructors</h4>

<div class="defun">
&mdash; Constructor:  <b>row::row</b> (<var>void</var>)<var>;<a name="index-row_003a_003arow-28"></a></var><br>
<blockquote><p>This constructs an empty row. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor: explicit <b>row::row</b> (<var>int bells</var>)<var>;<a name="index-row_003a_003arow-29"></a></var><br>
<blockquote><p>This constructs an empty row, where <var>bells</var> is the number of bells
which the row is to contain.  Note that it is not initialised to
anything. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>row::row</b> (<var>const char* s</var>)<var>;<a name="index-row_003a_003arow-30"></a></var><br>
&mdash; Constructor:  <b>row::row</b> (<var>const string&amp; s</var>)<var>;<a name="index-row_003a_003arow-31"></a></var><br>
<blockquote><p>This constructs a row from a string, which should be the textual
representation of the row you wish to construct, for example
<span class="samp">"135246"</span> or <span class="samp">"2143658709TE"</span>.  If the string does not
contain a valid row, and if exceptions are enabled, an exception of
class <code>row::invalid</code> is
thrown. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>row::row</b> (<var>const row&amp; r</var>)<var>;<a name="index-row_003a_003arow-32"></a></var><br>
<blockquote><p>This is the copy constructor; it creates a copy of the given row. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="row-Operators"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Other-row-Functions">Other row Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#row-Constructors">row Constructors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-row-Class">The row Class</a>
<br>
</div>

<h4 class="subsection">3.5.3 Operators</h4>

<div class="defun">
&mdash; Operator: row&amp; <b>row::operator=</b> (<var>const row&amp; r</var>)<var>;<a name="index-row_003a_003aoperator_003d-33"></a></var><br>
<blockquote><p>This copies one row to another. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: row&amp; <b>row::operator=</b> (<var>const char* s</var>)<var>;<a name="index-row_003a_003aoperator_003d-34"></a></var><br>
&mdash; Operator: row&amp; <b>row::operator=</b> (<var>const string&amp; s</var>)<var>;<a name="index-row_003a_003aoperator_003d-35"></a></var><br>
<blockquote><p>This sets the value of a row, given a string. The string <var>s</var> should
contain a textual representation of a row, such as <span class="samp">21436587</span>.  If
the string is not valid, a <code>row::invalid</code> exception is thrown. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: bool <b>row::operator==</b> (<var>const row&amp; r</var>)<var> const;<a name="index-row_003a_003aoperator_003d_003d-36"></a></var><br>
&mdash; Operator: bool <b>row::operator!=</b> (<var>const row&amp; r</var>)<var> const;<a name="index-row_003a_003aoperator_0021_003d-37"></a></var><br>
<blockquote><p>These compare two rows. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: bell <b>row::operator</b>[] (<var>int i</var>)<var> const;<a name="index-row_003a_003aoperator-38"></a></var><br>
<blockquote><p>This returns the <var>i</var>th bell in the row.  Note that this is not an
lvalue, so you cannot assign a value to an individual bell in a row. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: row <b>row::operator*</b> (<var>const row&amp; r</var>)<var> const;<a name="index-row_003a_003aoperator_002a-39"></a></var><br>
&mdash; Operator: row&amp; <b>row::operator*=</b> (<var>const row&amp; r</var>)<var>;<a name="index-row_003a_003aoperator_002a_003d-40"></a></var><br>
<blockquote><p>These functions multiply two rows together as explained above.  If the
rows are not of the same length, the shorter row is considered to be
first padded out to the length of the longer row by adding the extra
bells in order at the end. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: row <b>row::operator/</b> (<var>const row&amp; r</var>)<var> const;<a name="index-row_003a_003aoperator_002f-41"></a></var><br>
&mdash; Operator: row&amp; <b>row::operator/=</b> (<var>const row&amp; r</var>)<var>;<a name="index-row_003a_003aoperator_002f_003d-42"></a></var><br>
<blockquote><p>These functions divide two rows, as explained above.  If the rows are
not of the same length, the shorter row is padded as for multiplication. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: row&amp; <b>operator*=</b> (<var>row&amp; r, const change&amp; c</var>)<var>;<a name="index-operator_002a_003d-43"></a></var><br>
&mdash; Operator: row <b>row::operator*</b> (<var>const change&amp; c</var>)<var> const;<a name="index-row_003a_003aoperator_002a-44"></a></var><br>
<blockquote><p>These functions apply a change to a row.  If the number of bells <var>c</var>
differs from the number of bells in <var>r</var>, then <var>c</var> is considered
to be padded or truncated in the obvious way. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: ostream&amp; <b>operator&lt;&lt;</b> (<var>ostream&amp; o, const row&amp; r</var>)<var>;<a name="index-operator_003c_003c-45"></a></var><br>
<blockquote><p>This writes the row to the given output stream, in the same format as
returned by <code>row::print()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: bool <b>row::operator&lt;</b> (<var>const row&amp; other</var>)<var>;<a name="index-row_003a_003aoperator_003c-46"></a></var><br>
&mdash; Operator: bool <b>row::operator&gt;</b> (<var>const row&amp; other</var>)<var>;<a name="index-row_003a_003aoperator_003e-47"></a></var><br>
&mdash; Operator: bool <b>row::operator&lt;=</b> (<var>const row&amp; other</var>)<var>;<a name="index-row_003a_003aoperator_003c_003d-48"></a></var><br>
&mdash; Operator: bool <b>row::operator&gt;=</b> (<var>const row&amp; other</var>)<var>;<a name="index-row_003a_003aoperator_003e_003d-49"></a></var><br>
<blockquote><p>These functions perform a lexicographical comparison of the two rows. 
They are necessary in order that rows may be put into certain containers. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Other-row-Functions"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#row-static-Functions">row static Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#row-Operators">row Operators</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-row-Class">The row Class</a>
<br>
</div>

<h4 class="subsection">3.5.4 Other functions</h4>

<div class="defun">
&mdash; Function: int <b>row::bells</b> (<var>void</var>)<var> const;<a name="index-row_003a_003abells-50"></a></var><br>
<blockquote><p>This returns the number of bells which the row contains. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>row::swap</b> (<var>row&amp; other</var>)<var>;<a name="index-row_003a_003aswap-51"></a></var><br>
<blockquote><p>This function swaps this row with <var>other</var> in an efficient manner. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>row::find</b> (<var>bell const&amp; b</var>)<var>;<a name="index-row_003a_003afind-52"></a></var><br>
<blockquote><p>This function locates the bell, <var>b</var>, in this row and returns its
place. 
</p></blockquote></div>

<!-- Silly bit to get round a bug -->
<div class="defun">
&mdash; Function: bool <b>row::isrounds</b> (<var>void</var>)<var> const;<a name="index-row_003a_003aisrounds-53"></a></var><br>
<blockquote><p>This returns true if the row is rounds, and false otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>row::ispblh</b> (<var>void</var>)<var> const;<a name="index-row_003a_003aispblh-54"></a></var><br>
<blockquote><p>If the row is a lead head of Plain Bob, Grandsire or, more generally, of
the Plain Bob type method with any number of hunt bells, then this
function returns an integer indicating which lead head it is. 
Otherwise, it returns 0. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>row::ispblh</b> (<var>int h</var>)<var> const;<a name="index-row_003a_003aispblh-55"></a></var><br>
<blockquote><p>If the row is a lead head of Plain Bob, Grandsire or, more generally, of
the Plain Bob type method with <var>h</var> hunt bells, then this
function returns an integer indicating which lead head it is. 
Otherwise, it returns 0. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: string <b>row::print</b> (<var>void</var>)<var> const;<a name="index-row_003a_003aprint-56"></a></var><br>
<blockquote><p>This prints the row to a string object. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: row <b>row::inverse</b> (<var>void</var>)<var> const;<a name="index-row_003a_003ainverse-57"></a></var><br>
<blockquote><p>This returns the inverse of a row, as explained above. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>row::sign</b> (<var>void</var>)<var> const;<a name="index-row_003a_003asign-58"></a></var><br>
<blockquote><p>This returns the sign or parity of a row:  1 for even, -1 for odd. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>row::order</b> (<var>void</var>)<var> const;<a name="index-row_003a_003aorder-59"></a></var><br>
<blockquote><p>This returns the order of the row. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: string <b>row::cycles</b> (<var>void</var>)<var> const;<a name="index-row_003a_003acycles-60"></a></var><br>
<blockquote><p>This expresses the row as separate cycles. The returned string will
afterwards contain a list of all the cycles in the row, separated by
commas; for example <code>row("21453678").cycles()</code> will return the
string <code>"12,345,6,7,8"</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: template &lt;&gt; void <b>swap&lt;row&gt;</b> (<var>row&amp; a, row&amp; b</var>)<var>;<a name="index-swap_003crow_003e-61"></a></var><br>
<blockquote><p>This specialised the <code>swap</code> function which is defined in the
standard library.  The result is that certain standard algorithms may
become much more efficient.  Note that according to your namespace
setup, <code>swap</code> may need to be in namespace <code>std</code>; similarly,
<code>row</code> may or may not be in namespace <code>ringing</code>.  This is all
taken care of. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="row-static-Functions"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Other-row-Functions">Other row Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-row-Class">The row Class</a>
<br>
</div>

<h4 class="subsection">3.5.5 <code>static</code> functions</h4>

<div class="defun">
&mdash; Function: static row <b>row::rounds</b> (<var>int n</var>)<var>;<a name="index-row_003a_003arounds-62"></a></var><br>
&mdash; Function: static row <b>row::queens</b> (<var>int n</var>)<var>;<a name="index-row_003a_003aqueens-63"></a></var><br>
&mdash; Function: static row <b>row::kings</b> (<var>int n</var>)<var>;<a name="index-row_003a_003akings-64"></a></var><br>
&mdash; Function: static row <b>row::tittums</b> (<var>int n</var>)<var>;<a name="index-row_003a_003atittums-65"></a></var><br>
&mdash; Function: static row <b>row::reverse_rounds</b> (<var>int n</var>)<var>;<a name="index-row_003a_003areverse_005frounds-66"></a></var><br>
<blockquote><p>These return the row corresponding to rounds, queens, kings, tittums and
reverse rounds respectively on <var>n</var> bells. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: static row <b>row::pblh</b> (<var>int n, int h = 1</var>)<var>;<a name="index-row_003a_003apblh-67"></a></var><br>
<blockquote><p>This returns the first lead head of Plain Bob (<var>h</var> = 1), Grandsire
(<var>h</var> = 2), or more generally the Plain Bob type method on <var>n</var>
bells with <var>h</var> hunt bells. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: static row <b>row::cyclic</b> (<var>int n, int h = 1, int c = 1</var>)<var>;<a name="index-row_003a_003acyclic-68"></a></var><br>
<blockquote><p>This returns a cyclic row on <var>n</var> bells with <var>h</var> initial fixed
(hunt) bells.  The variable <var>c</var> controls the number of bells moved
from the front of the row to the end.  Thus, <code>cyclic(6,1,2) == "145623"</code>. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="The-change-Class"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#The-permute-function">The permute function</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-row-Class">The row Class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Rows-and-changes">Rows and changes</a>
<br>
</div>

<h3 class="section">3.6 The <code>change</code> class</h3>

<p><a name="index-_0040code_007bchange_007d-class-69"></a>
The <code>change</code> class stores a single change, i.e. a means of getting
from one row to another.

<ul class="menu">
<li><a accesskey="1" href="#change-Derivation">change Derivation</a>
<li><a accesskey="2" href="#change-Constructors">change Constructors</a>
<li><a accesskey="3" href="#change-Operators">change Operators</a>
<li><a accesskey="4" href="#Other-change-Functions">Other change Functions</a>
</ul>

<div class="node">
<p><hr>
<a name="change-Derivation"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#change-Constructors">change Constructors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-change-Class">The change Class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-change-Class">The change Class</a>
<br>
</div>

<h4 class="subsection">3.6.1 Derivation</h4>

<p>This class is not derived from any other classes.

<pre class="example">     class change;
</pre>
   <div class="node">
<p><hr>
<a name="change-Constructors"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#change-Operators">change Operators</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#change-Derivation">change Derivation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-change-Class">The change Class</a>
<br>
</div>

<h4 class="subsection">3.6.2 Constructors</h4>

<div class="defun">
&mdash; Constructor:  <b>change::change</b> (<var>void</var>)<var>;<a name="index-change_003a_003achange-70"></a></var><br>
<blockquote><p>This constructs an empty change. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor: explicit <b>change::change</b> (<var>int n</var>)<var>;<a name="index-change_003a_003achange-71"></a></var><br>
<blockquote><p>This constructs an empty change for <var>n</var> bells, which will initially
contain no swaps, that is, all bells will remain in the same place. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>change::change</b> (<var>const change&amp; c</var>)<var>;<a name="index-change_003a_003achange-72"></a></var><br>
<blockquote><p>This is the copy constructor; it makes a new copy of <var>c</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>change::change</b> (<var>int n, char* pn</var>)<var>;<a name="index-change_003a_003achange-73"></a></var><br>
&mdash; Constructor:  <b>change::change</b> (<var>int n, const string&amp; pn</var>)<var>;<a name="index-change_003a_003achange-74"></a></var><br>
<blockquote><p>This constructs a change on <var>n</var> bells, with place notation as given
in <var>pn</var>. This should consist of a sequence of characters which signify
the places to be made, arranged in ascending order. If no places are to
be made, the string <code>"X"</code> should be used. Note that you
can miss out external places, unless no internal places are made at
all.  If the place notation is not valid, this constructor will throw an
exception of class <code>change::invalid</code>. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="change-Operators"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Other-change-Functions">Other change Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#change-Constructors">change Constructors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-change-Class">The change Class</a>
<br>
</div>

<h4 class="subsection">3.6.3 Operators</h4>

<div class="defun">
&mdash; Operator: change&amp; <b>change::operator=</b> (<var>const change&amp; c</var>)<var>;<a name="index-change_003a_003aoperator_003d-75"></a></var><br>
<blockquote><p>This assigns the value of one change to another. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: bool <b>change::operator==</b> (<var>const change&amp; c</var>)<var> const;<a name="index-change_003a_003aoperator_003d_003d-76"></a></var><br>
&mdash; Operator: bool <b>change::operator!=</b> (<var>const change&amp; c</var>)<var> const;<a name="index-change_003a_003aoperator_0021_003d-77"></a></var><br>
<blockquote><p>These compare two changes.  Note that to be equal, the changes must be
defined on the same number of bells; for example, <span class="samp">"12"</span> on 4
bells is different from <span class="samp">"12"</span> on 6 bells. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: bell&amp; <b>operator*=</b> (<var>bell&amp; b, const change&amp; c</var>)<var>;<a name="index-operator_002a_003d-78"></a></var><br>
&mdash; Operator: bell <b>operator*</b> (<var>bell b, const change&amp; c</var>)<var>;<a name="index-operator_002a-79"></a></var><br>
<blockquote><p>These return the effect of applying the change <var>c</var> to the bell
<var>b</var>. For example, <code>3 * change(4,"34") == 4</code>. This is useful in
tracing the path of one particular bell through a series of changes. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: ostream&amp; <b>operator&lt;&lt;</b> (<var>ostream&amp; o, const change&amp; c</var>)<var>;<a name="index-operator_003c_003c-80"></a></var><br>
<blockquote><p>This writes the place notation for the change <var>c</var> to the given
output stream. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: bool <b>change::operator&lt;</b> (<var>const change&amp; c</var>)<var> const;<a name="index-change_003a_003aoperator_003c-81"></a></var><br>
&mdash; Operator: bool <b>change::operator&gt;</b> (<var>const change&amp; c</var>)<var> const;<a name="index-change_003a_003aoperator_003e-82"></a></var><br>
&mdash; Operator: bool <b>change::operator&lt;=</b> (<var>const change&amp; c</var>)<var> const;<a name="index-change_003a_003aoperator_003c_003d-83"></a></var><br>
&mdash; Operator: bool <b>change::operator&gt;=</b> (<var>const change&amp; c</var>)<var> const;<a name="index-change_003a_003aoperator_003e_003d-84"></a></var><br>
<blockquote><p>If both changes have the same number of bells, these performs a
lexicographical comparison on the swaps present in each changes; for
example <code>change(6, "14")</code> compares less than <code>change(6, "1236")</code>.

        <p>If the two changes have different numbers of bells the one with fewer
bells compares less than the one with more bells. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Other-change-Functions"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#change-Operators">change Operators</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-change-Class">The change Class</a>
<br>
</div>

<h4 class="subsection">3.6.4 Other functions</h4>

<div class="defun">
&mdash; Function: void <b>change::swap</b> (<var>change&amp; c</var>)<var>;<a name="index-change_003a_003aswap-85"></a></var><br>
<blockquote><p>This function swaps this change with the change given by <var>c</var> in an
efficient manner. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>change::bells</b> (<var>void</var>)<var> const;<a name="index-change_003a_003abells-86"></a></var><br>
<blockquote><p>This returns the number of bells on which the change is defined. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>change::sign</b> (<var>void</var>)<var> const;<a name="index-change_003a_003asign-87"></a></var><br>
<blockquote><p>This returns the sign of the change: -1 if an odd number of pairs are
swapped, +1 if an even number of pairs are swapped. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: bool <b>change::findswap</b> (<var>bell i</var>)<var> const;<a name="index-change_003a_003afindswap-88"></a></var><br>
<blockquote><p>Returns true if the change swaps bells <var>i</var> and <var>i+1</var>, and false
otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: bool <b>change::findplace</b> (<var>bell i</var>)<var> const;<a name="index-change_003a_003afindplace-89"></a></var><br>
<blockquote><p>Returns true if the change doesn't move the bell in the <var>i</var>th place
(i.e. if <var>i</var>ths place is made), and false otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>change::count_places</b> (<var>void</var>)<var> const;<a name="index-change_003a_003acount_005fplaces-90"></a></var><br>
<blockquote><p>This function returns the number of places made in the change. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: bool <b>change::swappair</b> (<var>int i</var>)<var>;<a name="index-change_003a_003aswappair-91"></a></var><br>
<blockquote><p>If the change doesn't currently swap bells <var>i</var> and <var>i+1</var>, then
this will add that swap.  If those bells are swapped, this will remove
the swap.  If the bells <var>i-1</var> and <var>i</var>, or <var>i+1</var> and
<var>i+2</var>, are currently swapped, those swaps are removed.

        <p>This returns true if after the function call, the pair of bells <var>i</var>
and <var>i+1</var> are swapped, and false otherwise.  If exceptions are enabled and
the bell <var>i+1</var> is greater the number of bells in the change, an
exception of class <code>change::out_of_range</code> will be thrown.

        <p>This function makes it possible for the user to edit changes in such a
way that they will always end up in a sensible state. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: change <b>change::reverse</b> (<var>void</var>)<var> const;<a name="index-change_003a_003areverse-92"></a></var><br>
<blockquote><p>This returns the reverse of a change; that is, the change is flipped
over so that on 8 bells for example, 2nds place becomes 7ths place and
so on. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: bool <b>change::internal</b> (<var>void</var>)<var> const;<a name="index-change_003a_003ainternal-93"></a></var><br>
<blockquote><p>This returns true if the change contains internal places, and false otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: string <b>change::print</b> (<var>void</var>)<var> const;<a name="index-change_003a_003aprint-94"></a></var><br>
<blockquote><p>This function prints the place notation for the change to a string. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: template &lt;&gt; void <b>swap&lt;change&gt;</b> (<var>change&amp; a, change&amp; b</var>)<var>;<a name="index-swap_003cchange_003e-95"></a></var><br>
<blockquote><p>This specialised the <code>swap</code> function which is defined in the
standard library.  The result is that certain standard algorithms may
become much more efficient.  Note that according to your namespace
setup, <code>swap</code> may need to be in namespace <code>std</code>; similarly,
<code>change</code> may or may not be in namespace <code>ringing</code>.  This is all
taken care of. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="The-permute-function"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#The-row_005fblock-class">The row_block class</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-change-Class">The change Class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Rows-and-changes">Rows and changes</a>
<br>
</div>

<h3 class="section">3.7 The <code>permute</code> function</h3>

<p><a name="index-_0040code_007bpermute_007d-function-96"></a>
The <code>permute</code> function is a utility function which makes it possible to
use some of the standard algorithms contained in the C++ library.  There are
two forms of the function:  the first takes an unsigned integer as
its argument, and the second takes a reference to a row.  In either case,
a function object (of type <code>permuter</code> or <code>row_permuter</code>) is returned,
which can be used with standard algorithms.

<div class="defun">
&mdash; Function: inline permuter <b>permute</b> (<var>unsigned n</var>)<var>;<a name="index-permute-97"></a></var><br>
<blockquote><p>This global function returns a function object of type <code>permuter</code>, which
contains a row initialised to rounds on <var>n</var> bells.  When the function
object is called with an argument of either a row or change, its internal
row is multiplied by that row or change and then returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: inline row_permuter <b>permute</b> (<var>row&amp; r</var>)<var>;<a name="index-permute-98"></a></var><br>
<blockquote><p>This global function creates a <code>row_permuter</code> function object, which
contains a reference to the row <var>r</var>.  When the function object is called
with a row or change as an argument, the row <var>r</var> will be multiplied
by that row or change. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: const row&amp; <b>permuter::operator()</b> (<var>const row&amp; r</var>)<var>;<a name="index-permuter_003a_003aoperator_0028_0029-99"></a></var><br>
&mdash; Operator: const row&amp; <b>permuter::operator()</b> (<var>const change&amp; c</var>)<var>;<a name="index-permuter_003a_003aoperator_0028_0029-100"></a></var><br>
<blockquote><p>These operators multiply the permutation contained in the <code>permuter</code>
object by the given row or change, and return the new permutation. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: const row&amp; <b>row_permuter::operator()</b> (<var>const row&amp; r</var>)<var>;<a name="index-row_005fpermuter_003a_003aoperator_0028_0029-101"></a></var><br>
&mdash; Operator: const row&amp; <b>row_permuter::operator()</b> (<var>const change&amp; c</var>)<var>;<a name="index-row_005fpermuter_003a_003aoperator_0028_0029-102"></a></var><br>
<blockquote><p>These operators multiply the row which the <code>row_permuter</code> object refers
to by the given row or change.  A reference to that row is returned. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="The-row_005fblock-class"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Other-functions-in-row_002eh">Other functions in row.h</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-permute-function">The permute function</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Rows-and-changes">Rows and changes</a>
<br>
</div>

<h3 class="section">3.8 The <code>row_block</code> class</h3>

<p><a name="index-_0040code_007brow_005fblock_007d-class-103"></a>
The <code>row_block</code> class is an array of rows which has associated with
it a reference to an array of changes, and can recalculate itself from
those changes.  For example, suppose that the variable <code>c</code> of type
<code>vector&lt;change&gt;</code> holds one lead of a method; then it is possible to
define a variable of type <code>row_class</code> which, once it is told what
the lead head is, will calculate the rows for one lead of the method.

   <p>Note that the <code>row_block</code> object does not store its own copy of the
<code>vector&lt;change&gt;</code> object from which it is calculated.  This means
that the changes may be altered and the resulting rows recalculated
easily; it also means that the changes must not be deallocated while the
<code>row_block</code> object is in existence.

<ul class="menu">
<li><a accesskey="1" href="#row_005fblock-Derivation">row_block Derivation</a>
<li><a accesskey="2" href="#row_005fblock-Constructors">row_block Constructors</a>
<li><a accesskey="3" href="#Other-row_005fblock-Functions">Other row_block Functions</a>
</ul>

<div class="node">
<p><hr>
<a name="row_005fblock-Derivation"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#row_005fblock-Constructors">row_block Constructors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-row_005fblock-class">The row_block class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-row_005fblock-class">The row_block class</a>
<br>
</div>

<h4 class="subsection">3.8.1 Derivation</h4>

<p>The <code>row_block</code> class is derived from <code>vector&lt;row&gt;</code>.

<pre class="example">     class row_block : public vector&lt;row&gt;;
</pre>
   <div class="node">
<p><hr>
<a name="row_005fblock-Constructors"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Other-row_005fblock-Functions">Other row_block Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#row_005fblock-Derivation">row_block Derivation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-row_005fblock-class">The row_block class</a>
<br>
</div>

<h4 class="subsection">3.8.2 Constructors</h4>

<div class="defun">
&mdash; Constructor:  <b>row_block::row_block</b> (<var>const vector&lt;change&gt;&amp; c</var>)<var>;<a name="index-row_005fblock_003a_003arow_005fblock-104"></a></var><br>
<blockquote><p>This creates a block of rows using the changes in <var>c</var>, starting
from rounds. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>row_block::row_block</b> (<var>const vector&lt;change&gt;&amp; c, const row&amp; r</var>)<var>;<a name="index-row_005fblock_003a_003arow_005fblock-105"></a></var><br>
<blockquote><p>This creates a block of rows using the changes in <var>c</var>, starting from
the row given in <var>r</var>. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Other-row_005fblock-Functions"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#row_005fblock-Constructors">row_block Constructors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-row_005fblock-class">The row_block class</a>
<br>
</div>

<h4 class="subsection">3.8.3 Other functions</h4>

<div class="node">
<p><hr>
<a name="Other-functions-in-row_002eh"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-row_005fblock-class">The row_block class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Rows-and-changes">Rows and changes</a>
<br>
</div>

<h3 class="section">3.9 Other functions in <span class="file">row.h</span></h3>

<div class="defun">
&mdash; Function: template&lt;OutputIterator, ForwardIterator&gt; void <b>interpret_pn</b> (<var>int bells, ForwardIterator start, ForwardIterator finish, OutputIterator out</var>)<var>;<a name="index-interpret_005fpn-106"></a></var><br>
<blockquote><p>This template function is for expanding place notation into changes.  The
arguments are as follows: <var>bells</var> is the number of bells; <var>start</var> and
<var>finish</var> should be forward iterators with value type <code>char</code>, and
indicate a string of characters containing the place notation; and <var>out</var>
is an output iterator of value type <code>change</code>, to which the changes
will be written.

        <p>The syntax of the place notation is as follows: place notation consists of
a sequence of blocks, which are delimited by commas.  Each block is a
sequence of changes, with <span class="samp">X</span> or <span class="samp">-</span> meaning a cross change. 
Changes other than cross changes are separated by full stops. 
A block may optionally be preceded by an ampersand <span class="samp">&amp;</span>, which means
that the entire block, except the last change, is repeated backwards.  All
other characters are ignored.

        <p>For examples of this function in use, look at one of the <code>method</code>
constructors in <span class="file">ringing/method.h</span> or in the example code. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Methods"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Method-libraries">Method libraries</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Rows-and-changes">Rows and changes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">4 Method classes</h2>

<p><a name="index-method-107"></a>
The Ringing Class Library provides many useful functions for dealing with
methods, finding information about them and classifying them.

   <p>A <dfn>method</dfn> consists of one block of changes which is repeated over
and over again; this is called a <dfn>lead</dfn>.  If, at the end of one
lead, every bell is in a different position, then the method is called a
<dfn>principle</dfn> and the leads are called <dfn>divisions</dfn>.  Any bells is
a method which end up in the same place at the end of a lead are called
<dfn>hunt bells</dfn>.

   <p>The Ringing Class Library defines an object <code>method</code> which is
simply a block of changes (it is derived from <code>vector&lt;change&gt;</code>) and
which provides a large range of member functions.  Many of these are
used for finding out things about the method, such as the number of
leads in the plain course, the type of method, the full name and so on.

<ul class="menu">
<li><a accesskey="1" href="#The-method-Class">The method Class</a>
</ul>

<div class="node">
<p><hr>
<a name="The-method-Class"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Methods">Methods</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Methods">Methods</a>
<br>
</div>

<h3 class="section">4.1 The <code>method</code> class</h3>

<p><a name="index-_0040code_007bmethod_007d-class-108"></a>
The <code>method</code> class represents a method by storing the changes which
make up one lead of the method.  This class is declared in
<span class="file">ringing/method.h</span>.

   <p>A method may have a name, which is a string variable.  This name is the
<dfn>base name</dfn> of the method, that is, it is the name without any extra
bits such as `Surprise' or `Triples'.  For example, the base name of
Plain Bob Major is simply `Plain'.  The parts of the name other than the
base can be worked out by the Ringing Class Library.

<ul class="menu">
<li><a accesskey="1" href="#method-Derivation">method Derivation</a>
<li><a accesskey="2" href="#method-Constructors">method Constructors</a>
<li><a accesskey="3" href="#Other-method-Functions">Other method Functions</a>
<li><a accesskey="4" href="#method-static-Functions">method static Functions</a>
<li><a accesskey="5" href="#method-static-Variables">method static Variables</a>
</ul>

<div class="node">
<p><hr>
<a name="method-Derivation"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#method-Constructors">method Constructors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-method-Class">The method Class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-method-Class">The method Class</a>
<br>
</div>

<h4 class="subsection">4.1.1 Derivation</h4>

<p>The <code>method</code> class is derived from <code>vector&lt;change&gt;</code>:
<pre class="example">     class method : public vector&lt;change&gt;
</pre>
   <div class="node">
<p><hr>
<a name="method-Constructors"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Other-method-Functions">Other method Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#method-Derivation">method Derivation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-method-Class">The method Class</a>
<br>
</div>

<h4 class="subsection">4.1.2 Constructors</h4>

<div class="defun">
&mdash; Constructor: explicit <b>method::method</b> (<var>int length = 0, int bells = 0, char* name = "Untitled"</var>)<var>;<a name="index-method_003a_003amethod-109"></a></var><br>
<blockquote><p>This constructor creates an empty method on <var>bells</var> bells, with
<var>length</var> changes in the lead, and with name <var>name</var>.  All the
bells stay in the same place for the entire lead. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>method::method</b> (<var>const char* pn, int bells, char* name = "Untitled"</var>)<var>;<a name="index-method_003a_003amethod-110"></a></var><br>
&mdash; Constructor:  <b>method::method</b> (<var>const string&amp; pn, int bells, const string&amp; name = "Untitled"</var>)<var>;<a name="index-method_003a_003amethod-111"></a></var><br>
<blockquote><p>This constructor creates a method on <var>bells</var> bells from the given
place notation, which should be an entire lead.  The method is given the base
name <var>name</var>.  For information on how to specify
the place notation, see the discussion of <code>interpret_pn</code> in
<a href="#Other-functions-in-row_002eh">Other functions in row.h</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>method::method</b> (<var>const method&amp; m</var>)<var>;<a name="index-method_003a_003amethod-112"></a></var><br>
<blockquote><p>This is the copy constructor. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Other-method-Functions"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#method-static-Functions">method static Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#method-Constructors">method Constructors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-method-Class">The method Class</a>
<br>
</div>

<h4 class="subsection">4.1.3 Other functions</h4>

<div class="defun">
&mdash; Function: const char* <b>method::name</b> (<var>void</var>)<var> const;<a name="index-method_003a_003aname-113"></a></var><br>
<blockquote><p>This returns the base name of the method.  Note that this may be an empty
string, for example in Little Bob. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>method::name</b> (<var>const char* name</var>)<var>;<a name="index-method_003a_003aname-114"></a></var><br>
&mdash; Function: void <b>method::name</b> (<var>const string&amp; name</var>)<var>;<a name="index-method_003a_003aname-115"></a></var><br>
<blockquote><p>This sets the base name of the method to <var>name</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>method::bells</b> (<var>void</var>)<var> const;<a name="index-method_003a_003abells-116"></a></var><br>
<blockquote><p>This returns the number of bells on which the method is defined. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>method::length</b> (<var>void</var>)<var> const;<a name="index-method_003a_003alength-117"></a></var><br>
<blockquote><p>This returns the number of changes in a lead of the method. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>method::push_back</b> (<var>const change&amp; c</var>)<var>;<a name="index-method_003a_003apush_005fback-118"></a></var><br>
&mdash; Function: void <b>method::push_back</b> (<var>const string&amp; s</var>)<var>;<a name="index-method_003a_003apush_005fback-119"></a></var><br>
<blockquote><p>These utility functions add a change to the end of the method.  In
the first case, <var>c</var> is the change to be added; in the second case,
<var>s</var> is place notation for the change to be added. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: row <b>method::lh</b> (<var>void</var>)<var> const;<a name="index-method_003a_003alh-120"></a></var><br>
<blockquote><p>This returns the first lead head of the method. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: bool <b>method::issym</b> (<var>void</var>)<var> const;<a name="index-method_003a_003aissym-121"></a></var><br>
<blockquote><p>This returns true if the method is symmetrical about the half lead (and has
an even number of changes in the lead), or false otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: bool <b>method::isdouble</b> (<var>void</var>)<var> const;<a name="index-method_003a_003aisdouble-122"></a></var><br>
<blockquote><p>This returns true if the method is double, or false otherwise.  Note that
double does not imply symmetrical. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: bool <b>method::isregular</b> (<var>void</var>)<var> const;<a name="index-method_003a_003aisregular-123"></a></var><br>
<blockquote><p>This returns true if the method is regular (that is, has Plain Bob lead
heads), or false otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>method::huntbells</b> (<var>void</var>)<var> const;<a name="index-method_003a_003ahuntbells-124"></a></var><br>
<blockquote><p>This returns the number of hunt bells in the method. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>method::leads</b> (<var>void</var>)<var> const;<a name="index-method_003a_003aleads-125"></a></var><br>
<blockquote><p>This returns the number of leads in the plain course of the method. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: char* <b>method::lhcode</b> (<var>void</var>)<var> const;<a name="index-method_003a_003alhcode-126"></a></var><br>
<blockquote><p>This returns the standard code for the lead end and lead head of the
method.  The result is stored in a static internal buffer. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: bool <b>method::issym</b> (<var>bell b</var>)<var> const;<a name="index-method_003a_003aissym-127"></a></var><br>
<blockquote><p>This returns true if the path of bell <var>b</var> in a lead of the method is
symmetrical about the half lead, or false otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: bool <b>method::isplain</b> (<var>bell b = 0</var>)<var> const;<a name="index-method_003a_003aisplain-128"></a></var><br>
<blockquote><p>This returns true if bell <var>b</var> plain hunts for the whole lead of the
method, or false otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: bool <b>method::hasdodges</b> (<var>bell b</var>)<var> const;<a name="index-method_003a_003ahasdodges-129"></a></var><br>
<blockquote><p>This returns true if bell <var>b</var> dodges during the lead, or false otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: bool <b>method::hasplaces</b> (<var>bell b</var>)<var> const;<a name="index-method_003a_003ahasplaces-130"></a></var><br>
<blockquote><p>This returns true if bell <var>b</var> makes any internal places during the lead,
or false otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>method::methclass</b> (<var>void</var>)<var> const;<a name="index-method_003a_003amethclass-131"></a></var><br>
<blockquote><p>This function returns an integer which depends on the class of the
method.  The following values are defined:
     <pre class="example">          enum method::m_class {
            M_UNKNOWN, M_PRINCIPLE, M_BOB, M_PLACE, M_TREBLE_BOB, M_SURPRISE,
            M_DELIGHT, M_TREBLE_PLACE, M_ALLIANCE, M_HYBRID, M_SLOW_COURSE,
            M_MASK = 0x0f,
            M_DIFFERENTIAL = 0x10,
            M_LITTLE = 0x80
          };
     </pre>
        <p>The <code>M_DIFFERENTIAL</code> and <code>M_LITTLE</code> bits are flags which will be
either set or cleared accordingly.  (For the purpose of this function,
&ldquo;Differential&rdquo; is considered a method class.  Differential hunters will have
the <code>M_DIFFERENTIAL</code> bit set, together with one of the other classes;
differential methods will return <code>M_DIFFERENTIAL | M_PRINCIPLE</code>.) 
</p></blockquote></div>

<div class="defun">
&mdash; Function: char* <b>method::fullname</b> (<var>char* buffer</var>)<var> const;<a name="index-method_003a_003afullname-132"></a></var><br>
<blockquote><p>This function places the full name of the method in <var>buffer</var>, which
should be long enough to receive it, and returns a pointer to it.  The
full name consists of:
          <ul>
<li>the base name of the method;
<li>the word &ldquo;Little&rdquo;, if appropriate;
<li>the class of the method, or none if it is a principle;
<li>the stage (number of bells) of the method. 
</ul>

        <p>Note that Grandsire, Union and their related methods are treated specially:
the full name of these methods does not include their class, nor in the
case of Little Grandsire does it contain &ldquo;Little&rdquo;. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: string <b>method::fullname</b> (<var>void</var>)<var> const;<a name="index-method_003a_003afullname-133"></a></var><br>
<blockquote><p>This function returns the full name of the method as a string. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>method::maxblows</b> (<var>void</var>)<var> const;<a name="index-method_003a_003amaxblows-134"></a></var><br>
<blockquote><p>This function returns the maximum consecutive blows made in any place in
this method.  (If the method has one bell fixed throughout, the lead length
is returned.) 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="method-static-Functions"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#method-static-Variables">method static Variables</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Other-method-Functions">Other method Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-method-Class">The method Class</a>
<br>
</div>

<h4 class="subsection">4.1.4 <code>static</code> functions</h4>

<div class="defun">
&mdash; Function: static const char* <b>method::stagename</b> (<var>int bells</var>)<var>;<a name="index-method_003a_003astagename-135"></a></var><br>
<blockquote><p>This function returns a pointer to a string describing the stage of
<var>bells</var> bells:  thus <code>"Minimus"</code>, <code>"Doubles"</code>, and so on. 
For stages above Sixteen, the number is given in digits. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: static string <b>method::classname</b> (<var>int class</var>)<var>;<a name="index-method_003a_003aclassname-136"></a></var><br>
<blockquote><p>This function returns a string describing the method class
given in <var>class</var>, which should be as indicated in the explanation
of <code>method::methclass()</code> above.  For the purpose of this function,
&ldquo;Differential&rdquo; and &ldquo;Little&rdquo; are both considered to be method classes. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="method-static-Variables"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#method-static-Functions">method static Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-method-Class">The method Class</a>
<br>
</div>

<h4 class="subsection">4.1.5 <code>static</code> variables</h4>

<div class="defun">
&mdash; Variable: static const char* <b>method::txt_double;</b><var><a name="index-method_003a_003atxt_005fdouble_003b-137"></a></var><br>
<blockquote><p>This points to the string <code>"Double"</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: static const char* <b>method::txt_little;</b><var><a name="index-method_003a_003atxt_005flittle_003b-138"></a></var><br>
<blockquote><p>This points to the string <code>"Little"</code>. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Method-libraries"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Proof">Proof</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Methods">Methods</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">5 Method libraries</h2>

<p><a name="index-library-139"></a><a name="index-method-library-140"></a>
The Ringing Class Library provides a extensible framework for loading
and manipulating method libraries (collections) of various types.  The
classes that provide this framework are declared in
<span class="file">ringing/library.h</span>.

   <p>The class library contains built-in code for accessing certain types of
libraries.  Currently these are:

     <ul>
<li>Central Council libraries in text format;

     <li>MicroSIRIL libraries;

     <li>XML libraries. 
</ul>

   <p>The class framework is designed so that programmers can easily add their
own types of libraries, and handle them in exactly the same way as the
build-in types.

   <p>When opening a library, it is not necessary to specify what type of
library it is:  usually this can be detected automatically.

<ul class="menu">
<li><a accesskey="1" href="#Using-libraries">Using libraries</a>
<li><a accesskey="2" href="#Built_002din-library-types">Built-in library types</a>
<li><a accesskey="3" href="#Library-framework">Library framework</a>
<li><a accesskey="4" href="#Implementing-new-library-classes">Implementing new library classes</a>
</ul>

<div class="node">
<p><hr>
<a name="Using-libraries"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Built_002din-library-types">Built-in library types</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Method-libraries">Method libraries</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Method-libraries">Method libraries</a>
<br>
</div>

<h3 class="section">5.1 Using libraries</h3>

<p>This section describes how to open and read method libraries.

<ul class="menu">
<li><a accesskey="1" href="#Initialisation-for-libraries">Initialisation for libraries</a>
<li><a accesskey="2" href="#The-library-class">The library class</a>
<li><a accesskey="3" href="#The-library_005fentry-class">The library_entry class</a>
<li><a accesskey="4" href="#Facets">Facets</a>
</ul>

<div class="node">
<p><hr>
<a name="Initialisation-for-libraries"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#The-library-class">The library class</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Using-libraries">Using libraries</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-libraries">Using libraries</a>
<br>
</div>

<h4 class="subsection">5.1.1 Initialisation</h4>

<p>Before the auto-detection of libraries will work, the <code>library</code>
class needs to know which library types it should try when opening a
library.  This is done by <dfn>registering</dfn> the different library types,
and should be done sometime during program startup.  To make this as
simple as possible, each of the built-in library types has a static
member function called <code>registerlib</code> for this purpose.

<pre class="example">     #include &lt;ringing/xmllib.h&gt;
     #include &lt;ringing/cclib.h&gt;
     
     xmllib::registerlib();
     cclib::registerlib();
     
     // Now we can open XML and Central Council libraries automatically
</pre>
   <p>The order in which library types are registered is the order in which
they will be tried when opening a library.

<div class="node">
<p><hr>
<a name="The-library-class"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#The-library_005fentry-class">The library_entry class</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Initialisation-for-libraries">Initialisation for libraries</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-libraries">Using libraries</a>
<br>
</div>

<h4 class="subsection">5.1.2 The <code>library</code> class</h4>

<p><a name="index-_0040code_007blibrary_007d-class-141"></a>
The <code>library</code> class provides all the functions you need for opening
and accessing method libraries.  These include:

     <ul>
<li>Constructors for opening method libraries;

     <li>Iterator-style functions to access methods;

     <li>Functions for accessing methods by name. 
</ul>

   <p>Note that the names of methods in libraries may not be what the user
expects.  For example, in MicroSIRIL libraries, method names are run
together into one word, say <span class="samp">Doubledublin</span>.

<ul class="menu">
<li><a accesskey="1" href="#library-derivation">library derivation</a>
<li><a accesskey="2" href="#library-constructors">library constructors</a>
<li><a accesskey="3" href="#library-iteration-functions">library iteration functions</a>
<li><a accesskey="4" href="#Other-library-functions">Other library functions</a>
</ul>

<div class="node">
<p><hr>
<a name="library-derivation"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#library-constructors">library constructors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-library-class">The library class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-library-class">The library class</a>
<br>
</div>

<h5 class="subsubsection">5.1.2.1 Derivation</h5>

<p>This class is not derived from any other classes.

<pre class="example">     class library;
</pre>
   <div class="node">
<p><hr>
<a name="library-constructors"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#library-iteration-functions">library iteration functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#library-derivation">library derivation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-library-class">The library class</a>
<br>
</div>

<h5 class="subsubsection">5.1.2.2 Constructors</h5>

<div class="defun">
&mdash; Constructor:  <b>library::library</b> (<var>void</var>)<var>;<a name="index-library_003a_003alibrary-142"></a></var><br>
<blockquote><p>Constructs an empty (and useless) library object. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>library::library</b> (<var>const string&amp; filename</var>)<var>;<a name="index-library_003a_003alibrary-143"></a></var><br>
<blockquote><p>This constructor attempts to automatically detect what type of library
<var>filename</var> is, and create an appropriate <code>library</code> object to
interpret it.   For a library type to be correctly auto-detected, that
type must be registered see <a href="#Initialisation-for-libraries">Initialisation for libraries</a>.

        <p>After constructing a library, the <code>library::good</code> function can be
used to see whether auto-detection succeeded. 
</p></blockquote></div>

   <p>In addition to this constructor, which auto-detects the type of library,
it is also possible to open a library of a fixed type, by constructing
an object for a specific library type.  See <a href="#Built_002din-library-types">Built-in library types</a>.

<div class="node">
<p><hr>
<a name="library-iteration-functions"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Other-library-functions">Other library functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#library-constructors">library constructors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-library-class">The library class</a>
<br>
</div>

<h5 class="subsubsection">5.1.2.3 Iteration functions</h5>

<p>The <code>library</code> class has an associated iterator class.

<div class="defun">
&mdash; Data type: <b>library::const_iterator;</b><var><a name="index-library_003a_003aconst_005fiterator_003b-144"></a></var><br>
<blockquote><p>In the language of the Standard Template Library, this is an <dfn>input
iterator</dfn>.  This means that you may only use it to read methods from the
library in order, starting at the beginning.  The value type of the
iterator is <code>library_entry</code> see <a href="#The-library_005fentry-class">The library_entry class</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: library::const_iterator <b>library::begin</b> (<var>void</var>)<var> const;<a name="index-library_003a_003abegin-145"></a></var><br>
&mdash; Function: library::const_iterator <b>library::end</b> (<var>void</var>)<var> const;<a name="index-library_003a_003aend-146"></a></var><br>
<blockquote><p>These functions return iterators pointing to the beginning and end of
the library, respectively. 
</p></blockquote></div>

   <p>This is how these functions may be used to iterate through the library:

<pre class="example">     // Open a library
     library l("my_library.xml");
     library::const_iterator i;
     
     // Print the base name of each method in it
     for(i = l.begin(); i != l.end(); ++i)
       cout &lt;&lt; i-&gt;base_name() &lt;&lt; endl;
</pre>
   <div class="node">
<p><hr>
<a name="Other-library-functions"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#library-iteration-functions">library iteration functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-library-class">The library class</a>
<br>
</div>

<h5 class="subsubsection">5.1.2.4 Other functions</h5>

<div class="defun">
&mdash; Function: bool <b>library::good</b> (<var>void</var>)<var> const;<a name="index-library_003a_003agood-147"></a></var><br>
<blockquote><p>This function returns true if the library is open and ready to read
methods, and false otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: virtual method <b>library::load</b> (<var>const char* name, int stage</var>)<var> const;<a name="index-library_003a_003aload-148"></a></var><br>
<blockquote><p>This function loads a method from the library by name.  Note that the
names under which methods are stored in a library depend entirely on the
type of library.

        <p>If no such method is found, if exceptions are enabled, an exception of class
<code>library_base::invalid_name</code> will be thrown; otherwise, the method
returned will be an empty method with the name <span class="samp">"Not Found"</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: virtual int <b>library::dir</b> (<var>list&lt;string&gt;&amp; result</var>)<var> const;<a name="index-library_003a_003adir-149"></a></var><br>
<blockquote><p>This function returns a list of the names of the methods in the library. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: virtual int <b>library::mdir</b> (<var>list&lt;method&gt;&amp; result</var>)<var> const;<a name="index-library_003a_003amdir-150"></a></var><br>
<blockquote><p>This function loads all the methods in the library and returns them as a
list. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="The-library_005fentry-class"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Facets">Facets</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-library-class">The library class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-libraries">Using libraries</a>
<br>
</div>

<h4 class="subsection">5.1.3 The <code>library_entry</code> class</h4>

<p><a name="index-_0040code_007blibrary_005fentry_007d-class-151"></a>
The <code>library_entry</code> class is the value type of the iterator on a
library.  It is used to get information about the method from the
library without constructing a <code>method</code> object.

<div class="defun">
&mdash; Function: string <b>library_entry::name</b> (<var>void</var>)<var> const;<a name="index-library_005fentry_003a_003aname-152"></a></var><br>
<blockquote><p>This returns the method's name in whatever form the library stores it
internally.  Thus it may or may not contain the class name(s) or stage name
of the method.  In the case of MicroSIRIL libraries, it will not even have
whitespace in the name. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: string <b>library_entry::base_name</b> (<var>void</var>)<var> const;<a name="index-library_005fentry_003a_003abase_005fname-153"></a></var><br>
<blockquote><p>This returns the base name of the method (i.e. the name with the class name(s)
and stage name removed).  The value returned is suitable for passing to
the <code>method</code> constructor. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: string <b>library_entry::pn</b> (<var>void</var>)<var> const;<a name="index-library_005fentry_003a_003apn-154"></a></var><br>
<blockquote><p>This returns a string containing the method's place notation. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>library_entry::bells</b> (<var>void</var>)<var> const;<a name="index-library_005fentry_003a_003abells-155"></a></var><br>
<blockquote><p>This returns the number of bells on which the method is defined. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: method <b>library_entry::meth</b> (<var>void</var>)<var> const<a name="index-library_005fentry_003a_003ameth-156"></a></var><br>
<blockquote><p>This constructs and return a <code>method</code> object. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: template &lt;class Facet&gt; bool <b>library_entry::has_facet</b> (<var>Facet const* f = NULL </var>)<var> const;<a name="index-library_005fentry_003a_003ahas_005ffacet-157"></a></var><br>
<blockquote><p>This function returns <code>true</code> if the method entry contains
information about the given facet.  Note that just because a method
library type supports a certain facet, that does not necessarily mean
that every method in the library actually has that facet.  For example,
an entry in a Central Council library may not contain any information
about the first peals in a method; or an entry in an XML library may not
contain certain elements.

        <p>The contents of the argument <var>f</var> are not used, but this may be used
to indicate the type of the facet as an alternative to explicit template
instantiation. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: template &lt;class Facet&gt; typename Facet::type <b>library_entry::get_facet</b> (<var>Facet const* f = NULL </var>)<var> const;<a name="index-library_005fentry_003a_003aget_005ffacet-158"></a></var><br>
<blockquote><p>This function returns the value of the specified facet of the method
entry.

        <p>The contents of the argument <var>f</var> are not used, but this may be used
to indicate the type of the facet as an alternative to explicit template
instantiation. 
</p></blockquote></div>

   <p>For more information on facets and an example of how these functions are
used, see <a href="#Facets">Facets</a>.

<div class="node">
<p><hr>
<a name="Facets"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-library_005fentry-class">The library_entry class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-libraries">Using libraries</a>
<br>
</div>

<h4 class="subsection">5.1.4 Facets</h4>

<p><a name="index-facets-159"></a>
In addition to usual information such as name, stage and place notation,
some method collections contain further information.  For example, the
Central Council method collections contain the date and place of the
first peal in each method.  To give access to such information, the
Ringing Class Library has a fully typed system of method <dfn>facets</dfn>.

   <p>A facet is something which has a C++ type, and which may or may not be
part of an entry in a method library.  A few facets are declared as
standard; library types are free to declare new facets of their own.

   <p>For example, one of the standard facets is called <code>rw_ref</code> and is
of type <code>string</code>.  The facet is intended to contain a string citing
the method's appearance in the <cite>Ringing World</cite>.  The following code
checks to see whether the first entry in the library <code>l</code> contains
this information, and if so prints it.

<pre class="example">     library::iterator i = l.begin();
     if( i-&gt;has_facet&lt; rw_ref &gt;() )
       cout &lt;&lt; i-&gt;get_facet&lt; rw_ref &gt;();
</pre>
   <p>For more information on these functions, see <a href="#The-library_005fentry-class">The library_entry class</a>.

<ul class="menu">
<li><a accesskey="1" href="#Built_002din-facets">Built-in facets</a>
</ul>

<div class="node">
<p><hr>
<a name="Built_002din-facets"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Facets">Facets</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Facets">Facets</a>
<br>
</div>

<h5 class="subsubsection">5.1.4.1 Built-in facets</h5>

<p>Some facets are declared in <span class="file">ringing/peal.h</span>.  These facets are
available in some of the built-in library types.

     <dl>
<dt><code>rw_ref</code><dd>This facet, of type <code>string</code>, contains a reference to the method's
appearance in the <cite>Ringing World</cite>.

     <br><dt><code>first_tower_peal</code><dd>This facet, of type <code>peal</code>, contains the date and place of the
first tower bell peal in the method.

     <br><dt><code>first_hand_peal</code><dd>This facet, of type <code>peal</code>, contains the date and place of the
first handbell peal in the method. 
</dl>

   <p>The last two are of type <code>peal</code>, which is a class also declared in
<span class="file">ringing/peal.h</span>.  It is a very simple class and defines the
following functions.

<div class="defun">
&mdash; Constructor:  <b>peal</b> (<var>void</var>)<var>;<a name="index-peal-160"></a></var><br>
&mdash; Constructor:  <b>peal</b> (<var>const peal::date&amp; DATE, const string&amp; PLACE</var>)<var>;<a name="index-peal-161"></a></var><br>
<blockquote><p>These functions construct objects in the obvious way. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: peal::date const&amp; <b>peal::when</b> (<var>void</var>)<var>;<a name="index-peal_003a_003awhen-162"></a></var><br>
<blockquote><p>This function returns the date of the peal. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: string const&amp; <b>peal::where</b> (<var>void</var>)<var>;<a name="index-peal_003a_003awhere-163"></a></var><br>
<blockquote><p>This function returns the location of the peal. 
</p></blockquote></div>

   <p>The <code>peal::date</code> type is also very simple.

<pre class="example">     struct peal::date {
       int day, month, year;
     };
</pre>
   <div class="defun">
&mdash; Constructor:  <b>peal::date</b> (<var>void</var>)<var>;<a name="index-peal_003a_003adate-164"></a></var><br>
&mdash; Constructor:  <b>peal::date</b> (<var>int DAY, int MONTH, int YEAR</var>)<var>;<a name="index-peal_003a_003adate-165"></a></var><br>
<blockquote><p>These functions construct objects in the obvious way. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Built_002din-library-types"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Library-framework">Library framework</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Using-libraries">Using libraries</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Method-libraries">Method libraries</a>
<br>
</div>

<h3 class="section">5.2 Built-in library types</h3>

<ul class="menu">
<li><a accesskey="1" href="#XML-libraries">XML libraries</a>
<li><a accesskey="2" href="#Central-Council-libraries">Central Council libraries</a>
<li><a accesskey="3" href="#MicroSIRIL-libraries">MicroSIRIL libraries</a>
</ul>

<div class="node">
<p><hr>
<a name="XML-libraries"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Central-Council-libraries">Central Council libraries</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Built_002din-library-types">Built-in library types</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Built_002din-library-types">Built-in library types</a>
<br>
</div>

<h4 class="subsection">5.2.1 XML libraries</h4>

<p><a name="index-XML-libraries-166"></a>
A specification for method libraries in XML can be found at
<a href="http://methods.ringing.org/">http://methods.ringing.org/</a>.  This site is also home to a server
which serves XML method data in response to HTTP queries.  The classes
declared in <span class="file">ringing/xmllib.h</span> can not only parse the XML data, but
can also automatically download method data from the server.

   <p>To use XML method libraries, you need to have the Xerces library
from the Apache project, available at <a href="http://xml.apache.org/">http://xml.apache.org/</a>.

<ul class="menu">
<li><a accesskey="1" href="#The-xmllib-class">The xmllib class</a>
<li><a accesskey="2" href="#XML-library-facets">XML library facets</a>
</ul>

<div class="node">
<p><hr>
<a name="The-xmllib-class"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#XML-library-facets">XML library facets</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#XML-libraries">XML libraries</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#XML-libraries">XML libraries</a>
<br>
</div>

<h5 class="subsubsection">5.2.1.1 The <code>xmllib</code> class</h5>

<p><a name="index-_0040code_007bxmllib_007d-class-167"></a>
The <code>xmllib</code> class is derived from the <code>library</code> class.

<pre class="example">     class xmllib : public library;
</pre>
   <div class="defun">
&mdash; Constructor:  <b>xmllib::xmllib</b> (<var>xmllib::file_arg_type TYPE, const string&amp; NAME</var>)<var>;<a name="index-xmllib_003a_003axmllib-168"></a></var><br>
<blockquote><p>This constructor opens an XML library.  The first argument <var>TYPE</var>
describes what sort of resource is to be opened, and should be one of
the following:

          <dl>
<dt><code>xmllib::filename</code><dd>Open a file; <var>NAME</var> contains the name of the file.

          <br><dt><code>xmllib::url</code><dd>Open a URL; <var>NAME</var> contains the URL.  To use this, Xerces must have
been built with Internet access.

          <br><dt><code>xmllib::default_url</code><dd>Query the online method database at <a href="http://methods.ringing.org/">http://methods.ringing.org/</a>. 
The argument <var>NAME</var> contains the query string, that is, the part of
the URL after the <span class="samp">?</span> character.  For information on what this
should contain, see the detailed information on the database's web site. 
</dl>
        </p></blockquote></div>

<pre class="example">     // Query the database for all methods named Lincolnshire
     xmllib l(xmllib::default_url, "name=Lincolnshire");
</pre>
   <p>An XML method collection in a file may also be opened using the library
auto-detection mechanism, by simply constructing a <code>library</code>
object.  See <a href="#library-constructors">library constructors</a>.

<div class="defun">
&mdash; Function: static void <b>xmllib::registerlib</b> (<var>void</var>)<var><a name="index-xmllib_003a_003aregisterlib-169"></a></var><br>
<blockquote><p>This function registers the XML library type with the library
auto-detection mechanism. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="XML-library-facets"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-xmllib-class">The xmllib class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#XML-libraries">XML libraries</a>
<br>
</div>

<h5 class="subsubsection">5.2.1.2 XML library facets</h5>

<p>The XML library type supports only the built-in facets.  See <a href="#Built_002din-facets">Built-in facets</a>.

<div class="node">
<p><hr>
<a name="Central-Council-libraries"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#MicroSIRIL-libraries">MicroSIRIL libraries</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#XML-libraries">XML libraries</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Built_002din-library-types">Built-in library types</a>
<br>
</div>

<h4 class="subsection">5.2.2 Central Council libraries</h4>

<p>The Methods Committee of the Central Council publishes collections of
methods on its web site, in a text format.  The classes declared in
<span class="file">ringing/cclib.h</span> can read these method collections.

<ul class="menu">
<li><a accesskey="1" href="#The-cclib-class">The cclib class</a>
<li><a accesskey="2" href="#Central-Council-library-facets">Central Council library facets</a>
</ul>

<div class="node">
<p><hr>
<a name="The-cclib-class"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Central-Council-library-facets">Central Council library facets</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Central-Council-libraries">Central Council libraries</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Central-Council-libraries">Central Council libraries</a>
<br>
</div>

<h5 class="subsubsection">5.2.2.1 The <code>cclib</code> class</h5>

<p>The <code>cclib</code> class is derived from the <code>library</code> class.

<pre class="example">     class cclib : public library;
</pre>
   <p>There is one constructor.

<div class="defun">
&mdash; Constructor:  <b>cclib::cclib</b> (<var>const string&amp; filename</var>)<var>;<a name="index-cclib_003a_003acclib-170"></a></var><br>
<blockquote><p>This function attempts to open the given file as a Central Council method
library. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: static void <b>cclib::registerlib</b> (<var>void</var>)<var><a name="index-cclib_003a_003aregisterlib-171"></a></var><br>
<blockquote><p>This function registers the Central Council library type with the
library auto-detection mechanism.  It will agree to open any file which
has the correct CC copyright notice in the first line. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Central-Council-library-facets"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-cclib-class">The cclib class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Central-Council-libraries">Central Council libraries</a>
<br>
</div>

<h5 class="subsubsection">5.2.2.2 Central Council library facets</h5>

<p>The Central Council library type supports the built-in facets
see <a href="#Built_002din-facets">Built-in facets</a> and one further facet.

     <dl>
<dt><code>cclib::ref</code><dd>This facet, of type <code>int</code>, contains the reference number of the
method in the library file.  This is the number which appears at the
beginning of the line containing the method. 
</dl>

<div class="node">
<p><hr>
<a name="MicroSIRIL-libraries"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Central-Council-libraries">Central Council libraries</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Built_002din-library-types">Built-in library types</a>
<br>
</div>

<h4 class="subsection">5.2.3 MicroSIRIL libraries</h4>

<p>MicroSIRIL was an ingenious and widely-used early peal proving program
for PCs.  The method libraries used are in a simple text format, with
one method per line; they contain, for each method, simply the name,
lead head code and place notation.

   <p>The Ringing Class Library can read MicroSIRIL libraries, providing they
satisfy one requirement: the last portion of the filename, before any
extension, must be the number of bells on which all the methods in the
file are.  This is because it is impossible to tell the stage from just
the place notation.  So, for example, a method library file might be
called <span class="file">s8</span> or <span class="file">new_principles10.txt</span>.

   <p>Beware that the MicroSIRIL library interface will agree to open any file
having a name satisfying the above requirement.  For this reason, if
auto-detecting method library types, you may want to put the MicroSIRIL
library type at the end of your list.

   <p>When reading methods from MicroSIRIL libraries, remember that the name
of each method may only consist of a single word; usually names
consisting of several words are run together into one.

<ul class="menu">
<li><a accesskey="1" href="#The-mslib-class">The mslib class</a>
<li><a accesskey="2" href="#MicroSIRIL-library-facets">MicroSIRIL library facets</a>
</ul>

<div class="node">
<p><hr>
<a name="The-mslib-class"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#MicroSIRIL-library-facets">MicroSIRIL library facets</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#MicroSIRIL-libraries">MicroSIRIL libraries</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#MicroSIRIL-libraries">MicroSIRIL libraries</a>
<br>
</div>

<h5 class="subsubsection">5.2.3.1 The <code>mslib</code> class</h5>

<p>The <code>mslib</code> class is derived from the <code>library</code> class.

<pre class="example">     class mslib : public library;
</pre>
   <p>There is one constructor.

<div class="defun">
&mdash; Constructor:  <b>mslib::mslib</b> (<var>const string&amp; filename</var>)<var>;<a name="index-mslib_003a_003amslib-172"></a></var><br>
<blockquote><p>This function attempts to open the given file as a MicroSIRIL method
library. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: static void <b>mslib::registerlib</b> (<var>void</var>)<var><a name="index-mslib_003a_003aregisterlib-173"></a></var><br>
<blockquote><p>This function registers the MicroSIRIL library type with the
library auto-detection mechanism.  It will agree to open any file which
has a name containing a number just before any extension. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="MicroSIRIL-library-facets"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-mslib-class">The mslib class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#MicroSIRIL-libraries">MicroSIRIL libraries</a>
<br>
</div>

<h5 class="subsubsection">5.2.3.2 MicroSIRIL library facets</h5>

<p>There are no facets available for MicroSIRIL libraries.

<div class="node">
<p><hr>
<a name="Library-framework"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Implementing-new-library-classes">Implementing new library classes</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Built_002din-library-types">Built-in library types</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Method-libraries">Method libraries</a>
<br>
</div>

<h3 class="section">5.3 Library framework</h3>

<p>This section describes in greater detail how the various classes which
implement method libraries interact.  It is intended for those writing
new classes to support new library types.

   <p>The basic library framework comprises five classes, all of which are
declared in the header file <span class="file">ringing/library.h</span>.

<!-- Unfortunately it seems that the @code macro cannot be used in the -->
<!-- name argument of @deftp as makeinfo -html can't cope with it. -->
<div class="defun">
&mdash; Class: <b>class library_base</b><var><a name="index-class-library_005fbase-174"></a></var><br>
<blockquote><p>This is the basic interface that all implementations will need to implement. 
It describes how to iterate through a library, and provides hooks that
can be used to provide more efficient algorithms for searching through the
library. 
</p></blockquote></div>

<div class="defun">
&mdash; Class: <b>class library</b><var><a name="index-class-library-175"></a></var><br>
<blockquote><p>The <code>library</code> class serves two purposes: it acts as a shared pointer
to a library_base, and it handles the auto-detection of libraries. 
Implementations only need to derive from this if they want to provide an
alternative to the standard auto-detection mechansim. 
</p></blockquote></div>

<div class="defun">
&mdash; Class: <b>class library_entry</b><var><a name="index-class-library_005fentry-176"></a></var><br>
<blockquote><p>This class represents an entry in a library.  It has value semantics; thus
it is safe to hold onto multiple entries from a single library. 
</p></blockquote></div>

<div class="defun">
&mdash; Class: <b>class library_base::const_iterator</b><var><a name="index-class-library_005fbase_003a_003aconst_005fiterator-177"></a></var><br>
<blockquote><p>This is an input iterator that iterates over the entries in a library. 
Dereferencing the iterator returns a <code>library_entry</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Class: <b>class library_entry::impl</b><var><a name="index-class-library_005fentry_003a_003aimpl-178"></a></var><br>
<blockquote><p>Each <code>library_entry</code> class holds onto a pointer to one of these.  It
provides an interface to read library entries that all library
implementations must implement. 
</p></blockquote></div>

<ul class="menu">
<li><a accesskey="1" href="#The-library_005fbase-class">The library_base class</a>
<li><a accesskey="2" href="#The-library_005fbase-const_005fiterator-class">The library_base const_iterator class</a>
<li><a accesskey="3" href="#library-internals">library internals</a>
<li><a accesskey="4" href="#library_005fentry-internals">library_entry internals</a>
<li><a accesskey="5" href="#The-library_005fentry-impl-class">The library_entry impl class</a>
</ul>

<div class="node">
<p><hr>
<a name="The-library_005fbase-class"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#The-library_005fbase-const_005fiterator-class">The library_base const_iterator class</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Library-framework">Library framework</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Library-framework">Library framework</a>
<br>
</div>

<h4 class="subsection">5.3.1 The <code>library_base</code> class</h4>

<p><a name="index-_0040code_007blibrary_005fbase_007d-class-179"></a>
The <code>library_base</code> class provides the interface that library
implementations must implement to create iterators on a library.  It also has
virtual functions can be overriden to provide more efficient ways to search
and list libraries.

<div class="defun">
&mdash; Destructor: virtual <b>library_base::~library_base</b> (<var>void</var>)<var>;<a name="index-library_005fbase_003a_003a_007elibrary_005fbase-180"></a></var><br>
<blockquote><p>A virtual destructor. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: virtual library_base::const_iterator <b>library_base::begin</b> (<var>void</var>)<var> const = 0;<a name="index-library_005fbase_003a_003abegin-181"></a></var><br>
<blockquote><p>This should be overriden to construct a <code>library_base::const_iterator</code>
pointing to the start of the library. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: library_base::const_iterator <b>library_base::end</b> (<var>void</var>)<var> const;<a name="index-library_005fbase_003a_003aend-182"></a></var><br>
<blockquote><p>This returns a default constructed <code>library_base::const_iterator</code>
representing one past the end of the library. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: virtual bool <b>library_base::good</b> (<var>void</var>)<var> const = 0;<a name="index-library_005fbase_003a_003agood-183"></a></var><br>
<blockquote><p>This function should be overriden to return true if a valid library is
currently loaded and false otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: virtual method <b>library_base::load</b> (<var>const char* name, int stage</var>)<var> const;<a name="index-library_005fbase_003a_003aload-184"></a></var><br>
<blockquote><p>The default implementation of <code>load</code> iterates through the library
searching for an entry with the correct name.  When comparing method names,
it does so in a case-insensitive manner.  If <var>stage</var> is non-zero,
<code>load</code> requires that the method is on that number of bells.

        <p>If no such method is found, if exceptions are enabled, an exception of class
<code>library_base::invalid_name</code> will be thrown; otherwise, the method
returned will be an empty method with the name <span class="samp">"Not Found"</span>.

        <p>Library implementations may wish to override this if there is a more
efficient way to locate the method. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: virtual int <b>library_base::dir</b> (<var>list&lt;string&gt;&amp; result</var>)<var> const;<a name="index-library_005fbase_003a_003adir-185"></a></var><br>
&mdash; Function: virtual int <b>library_base::mdir</b> (<var>list&lt;method&gt;&amp; result</var>)<var> const;<a name="index-library_005fbase_003a_003amdir-186"></a></var><br>
<blockquote><p>The default implementations of <code>dir</code> and <code>mdir</code> iterate through
the library, pushing each name (in the case of <code>dir</code>) or method
(in the case of <code>mdir</code>) onto <var>result</var>. The return value is
the number of values pushed onto <code>result</code>.

        <p>Library implementations may wish to override this if there is a more
efficient way to locate the method. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: virtual bool <b>library_base::writeable</b> (<var>void</var>)<var> const;<a name="index-library_005fbase_003a_003awriteable-187"></a></var><br>
&mdash; Function: virtual bool <b>library_base::save</b> (<var>const method&amp; m</var>)<var>;<a name="index-library_005fbase_003a_003asave-188"></a></var><br>
&mdash; Function: virtual bool <b>library_base::rename_method</b> (<var>const string&amp; name1, const string&amp; name2</var>)<var>;<a name="index-library_005fbase_003a_003arename_005fmethod-189"></a></var><br>
&mdash; Function: virtual bool <b>library_base::remove</b> (<var>const string&amp; name</var>)<var>;<a name="index-library_005fbase_003a_003aremove-190"></a></var><br>
<blockquote><p>These functions are for writing to method libraries.  This functionality is
still experimental. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="The-library_005fbase-const_005fiterator-class"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#library-internals">library internals</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-library_005fbase-class">The library_base class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Library-framework">Library framework</a>
<br>
</div>

<h4 class="subsection">5.3.2 The <code>library_base::const_iterator</code> class</h4>

<p><a name="index-_0040code_007blibrary_005fbase_003a_003aconst_005fiterator_007d-class-191"></a><a name="index-_0040code_007blibrary_003a_003aconst_005fiterator_007d-class-192"></a>
In the terminology of the STL, the <code>library_entry::const_iterator</code> class
is an Input Iterator but not a Forward Iterator.  This means that multiple
iterators on the same library will not work as expected.

<div class="defun">
&mdash; Constructor:  <b>library_base::const_iterator::const_iterator</b> (<var>void</var>)<var>;<a name="index-library_005fbase_003a_003aconst_005fiterator_003a_003aconst_005fiterator-193"></a></var><br>
<blockquote><p>This is the default constructor.  It is undefined behaviour to dereference
or increment the default constructed <code>library_base::const_iterator</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>library_base::const_iterator::const_iterator</b> (<var>library_base* lb, library_entry::impl* val</var>)<var>;<a name="index-library_005fbase_003a_003aconst_005fiterator_003a_003aconst_005fiterator-194"></a></var><br>
<blockquote><p>This constructor creates an iterator on library <var>lb</var> and with a library
entry implementation of <var>val</var>.  The constructor takes ownership of
<var>val</var>, which must have been allocated using <code>new</code>; it does not take
ownership of <var>lb</var>.  Typically, this function should only be called
by the <code>begin</code> function of classes derived from <code>library_base</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: bool <b>library_base::const_iterator::operator==</b> (<var>const library_base::const_iterator&amp; other</var>)<var> const;<a name="index-library_005fbase_003a_003aconst_005fiterator_003a_003aoperator_003d_003d-195"></a></var><br>
&mdash; Function: bool <b>library_base::const_iterator::operator!=</b> (<var>const library_base::const_iterator&amp; other</var>)<var> const;<a name="index-library_005fbase_003a_003aconst_005fiterator_003a_003aoperator_0021_003d-196"></a></var><br>
<blockquote><p>Compare two iterators.  It is undefined behaviour to compare two iterators
from different libraries. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: library_entry <b>library_base::const_iterator::operator*</b> (<var>void</var>)<var> const;<a name="index-library_005fbase_003a_003aconst_005fiterator_003a_003aoperator_002a-197"></a></var><br>
&mdash; Function: library_entry* <b>library_base::const_iterator::operator-&gt;</b> (<var>void</var>)<var> const;<a name="index-library_005fbase_003a_003aconst_005fiterator_003a_003aoperator_002d_003e-198"></a></var><br>
<blockquote><p>Dereferences an iterator to retrieve the current <code>library_entry</code>.  It
is undefined behaviour to dereference an iterator that compares equal to
the end iterator of that library. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: library_base::const_iterator&amp; <b>library_base::const_iterator::operator++</b> (<var>void</var>)<var> const;<a name="index-library_005fbase_003a_003aconst_005fiterator_003a_003aoperator_002b_002b-199"></a></var><br>
&mdash; Function: library_base::const_iterator <b>library_base::const_iterator::operator++</b> (<var>int</var>)<var> const;<a name="index-library_005fbase_003a_003aconst_005fiterator_003a_003aoperator_002b_002b-200"></a></var><br>
<blockquote><p>The prefix and postfix increment operators move the iterator on to point to
the next entry in the library.  If there are no further entries in the library,
the iterator will compare equal to the library's end iterator. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="library-internals"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#library_005fentry-internals">library_entry internals</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-library_005fbase-const_005fiterator-class">The library_base const_iterator class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Library-framework">Library framework</a>
<br>
</div>

<h4 class="subsection">5.3.3 <code>library</code> internals</h4>

<p><a name="index-_0040code_007blibrary_007d-internals-201"></a>

<div class="defun">
&mdash; Constructor:  <b>library::library</b> (<var>void</var>)<var>;<a name="index-library_003a_003alibrary-202"></a></var><br>
<blockquote><p>Default constructs a library holding a <code>NULL</code> <code>library_base</code>
pointer. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>library::library</b> (<var>const string&amp; filename</var>)<var>;<a name="index-library_003a_003alibrary-203"></a></var><br>
<blockquote><p>This constructor attempts to automatically detect what type of library
<var>filename</var> is, and create an appropriate <code>library_base</code> to
interpret it.   For a library type to be correctly auto-detected a
function of type <code>library::init_function</code> must be registered
with <code>library::addtype</code>. 
After constructing a library, the <code>library::good</code> function can be
used see if auto-detection succeeded. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>library::library</b> (<var>library_base* lb</var>)<var>;<a name="index-library_003a_003alibrary-204"></a></var><br>
<blockquote><p>This constructor is provided to allow libraries the flexibility not to use
the auto-detection mechanism.  The argument, <var>lb</var>, must have allocated
by <code>new</code> and gets deleted by the <code>library</code>'s destructor. 
For more information on how to use this, see
<a href="#Alternative-creation-mechanisms">Alternative creation mechanisms</a>. 
</p></blockquote></div>

<!-- I've used deftypefn rather than deftp because (i) @deftp formats the -->
<!-- type incorrectly and (ii) the typedef is for a function-pointer. -->
<div class="defun">
&mdash; Typedef: typedef library_base* <b>(* library::init_function )</b> (<var>const string&amp; filename</var>)<var>;<a name="index-_0028_002a-library_003a_003ainit_005ffunction-_0029-205"></a></var><br>
<blockquote><p>Functions with this signature are used by the <code>library</code> construtor to
attempt to load a library.  Each derived library class that supports
auto-detection should register a function of this signature
with the <code>library</code> class by calling the <code>library::addtype</code> function. 
When these functions get called, <var>filename</var> is the name of the
library file.  If a library can read the file it should return a pointer to
a class derived from <code>library_base</code> allocated with <code>new</code>; otherwise
the function should return NULL. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: static void <b>library::addtype</b> (<var>library::init_function lt</var>)<var><a name="index-library_003a_003aaddtype-206"></a></var><br>
<blockquote><p>This is used to register a specific (derived) library class to the list of
classes that can be auto-detected.  This function is typically called by the
static function <code>registerlib</code> in the derived classes. 
</p></blockquote></div>

<div class="defun">
&mdash; Typedef: typedef library_base::const_iterator <b>library::const_iterator;</b><var><a name="index-library_003a_003aconst_005fiterator_003b-207"></a></var><br>
&mdash; Function: library::const_iterator <b>library::begin</b> (<var>void</var>)<var> const;<a name="index-library_003a_003abegin-208"></a></var><br>
&mdash; Function: library::const_iterator <b>library::end</b> (<var>void</var>)<var> const;<a name="index-library_003a_003aend-209"></a></var><br>
<blockquote><p>If the library holds a <code>library_base</code>, these function call down to the
corresponding functions on that, otherwise both functions return a default
constructed <code>const_iterator</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: bool <b>library_base::good</b> (<var>void</var>)<var> const;<a name="index-library_005fbase_003a_003agood-210"></a></var><br>
<blockquote><p>This function returns true if the library is valid, and false otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: virtual method <b>library::load</b> (<var>const char* name, int stage</var>)<var> const;<a name="index-library_003a_003aload-211"></a></var><br>
&mdash; Function: virtual int <b>library::dir</b> (<var>list&lt;string&gt;&amp; result</var>)<var> const;<a name="index-library_003a_003adir-212"></a></var><br>
&mdash; Function: virtual int <b>library::mdir</b> (<var>list&lt;method&gt;&amp; result</var>)<var> const;<a name="index-library_003a_003amdir-213"></a></var><br>
&mdash; Function: virtual bool <b>library::writeable</b> (<var>void</var>)<var> const;<a name="index-library_003a_003awriteable-214"></a></var><br>
&mdash; Function: virtual bool <b>library::save</b> (<var>const method&amp; m</var>)<var>;<a name="index-library_003a_003asave-215"></a></var><br>
&mdash; Function: virtual bool <b>library::rename_method</b> (<var>const string&amp; name1, const string&amp; name2</var>)<var>;<a name="index-library_003a_003arename_005fmethod-216"></a></var><br>
&mdash; Function: virtual bool <b>library::remove</b> (<var>const string&amp; name</var>)<var>;<a name="index-library_003a_003aremove-217"></a></var><br>
<blockquote><p>These functions all call down to the corresponding functions on the
<code>library_base</code>; see <a href="#The-library_005fbase-class">The library_base class</a> for details. 
They must not be called if <code>library::good()</code> is false. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="library_005fentry-internals"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#The-library_005fentry-impl-class">The library_entry impl class</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#library-internals">library internals</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Library-framework">Library framework</a>
<br>
</div>

<h4 class="subsection">5.3.4 The <code>library_entry</code> internals</h4>

<p><a name="index-_0040code_007blibrary_005fentry_007d-internals-218"></a>
The <code>library_entry</code> class holds a pointer to a class derived from
<code>library_entry::impl</code> which reads data from a particular library entry.

<div class="defun">
&mdash; Constructor:  <b>library_entry::library_entry</b> (<var>void</var>)<var>;<a name="index-library_005fentry_003a_003alibrary_005fentry-219"></a></var><br>
<blockquote><p>This constructor initialises the <code>library_entry</code> with a <code>NULL</code>
<code>library_entry::impl</code> pointer.  It is undefined behaviour to call
any accessor functions on a default constructed <code>library_entry</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>library_entry::library_entry</b> (<var>library_entry::impl* PIMPL</var>)<var>;<a name="index-library_005fentry_003a_003alibrary_005fentry-220"></a></var><br>
<blockquote><p>This constructor creates a new object from the given pointer. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: string <b>name</b> (<var>void</var>)<var> const;<a name="index-name-221"></a></var><br>
&mdash; Function: string <b>base_name</b> (<var>void</var>)<var> const;<a name="index-base_005fname-222"></a></var><br>
&mdash; Function: string <b>pn</b> (<var>void</var>)<var> const;<a name="index-pn-223"></a></var><br>
&mdash; Function: int <b>bells</b> (<var>void</var>)<var> const;<a name="index-bells-224"></a></var><br>
&mdash; Function: method <b>meth</b> (<var>void</var>)<var> const<a name="index-meth-225"></a></var><br>
<blockquote><p>These functions all call the corresponding function on the
<code>library_entry::impl</code> object. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="The-library_005fentry-impl-class"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#library_005fentry-internals">library_entry internals</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Library-framework">Library framework</a>
<br>
</div>

<h4 class="subsection">5.3.5 The <code>library_entry::impl</code> class</h4>

<p><a name="index-_0040code_007blibrary_005fentry_003a_003aimpl_007d-class-226"></a>
The <code>library_entry::impl</code> class provides the interface that library
implementations must implement to parse individual library entries.  Each
<code>library_entry</code> and <code>library::const_iterator</code> holds onto one of
these.

<div class="defun">
&mdash; Destructor: virtual <b>library_entry::impl::~impl</b> (<var>void</var>)<var>;<a name="index-library_005fentry_003a_003aimpl_003a_003a_007eimpl-227"></a></var><br>
<blockquote><p>A virtual destructor. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: virtual library_entry::impl* <b>library_entry::impl::clone</b> (<var>void</var>)<var> const = 0;<a name="index-library_005fentry_003a_003aimpl_003a_003aclone-228"></a></var><br>
<blockquote><p>This must be overriden to perform a deep copy of the library.  Almost always
this should be implemented as follows:
     <pre class="example">          virtual library_entry::impl* mylib::entry_type::clone() const {
            return new mylib::entry_type(*this);
          }
     </pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: virtual bool <b>library_entry::impl::readentry</b> (<var>library_base&amp; lb</var>)<var> const = 0;<a name="index-library_005fentry_003a_003aimpl_003a_003areadentry-229"></a></var><br>
<blockquote><p>The function should be overriden to read the next entry from the library and
return true unless the end of the library has been reached.  The source of the
data should be held within the <code>library_base</code> implementation, and not
this class.  For example, if the library implementation reads from a file via
an <code>ifstream</code>, the <code>library_base</code> class should contain the
<code>ifstream</code> and this class should access it via <var>lb</var>:
     <pre class="example">          virtual bool mylib::entry_type::readentry( library_base&amp; lb ) {
            ifstream&amp; ifs = dynamic_cast&lt; mylib&amp; &gt;( lb ).ifs;
            std::getline( ifs, this-&gt;entry );
          }
     </pre>
        <p>None of <code>library_entry</code>'s other functions should ever access the parent
<code>library_base</code> class.

        <p>This function gets called whenever a <code>library::const_iterator</code> is
constructed or incremented. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: virtual string <b>library_entry::impl::name</b> (<var>void</var>)<var> const = 0;<a name="index-library_005fentry_003a_003aimpl_003a_003aname-230"></a></var><br>
&mdash; Function: virtual string <b>library_entry::impl::base_name</b> (<var>void</var>)<var> const = 0;<a name="index-library_005fentry_003a_003aimpl_003a_003abase_005fname-231"></a></var><br>
<blockquote><p>These should be overriden to return the name of the current entry.  The
<code>name</code> function should return a name which is unique within the library
(this may require the class name(s) and/or stage name be included);
the <code>base_name</code> function should return the name without either the
class or stage name.

        <p>These functions may be implemented to simply return a name that was parsed by
<code>readentry</code>; alternatively it might be implemented to parse some
internal representation of the entry (such as a string containing the
whole entry).  It must not attempt to access the parent <code>library_base</code>
which may no longer exist.  The <code>readentry</code> function will always have
been called before this function gets called. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: virtual string <b>library_entry::impl::pn</b> (<var>void</var>)<var> const = 0;<a name="index-library_005fentry_003a_003aimpl_003a_003apn-232"></a></var><br>
<blockquote><p>This should be overriden to return the place notation of the current method. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: virtual string <b>library_entry::impl::pn</b> (<var>void</var>)<var> const = 0;<a name="index-library_005fentry_003a_003aimpl_003a_003apn-233"></a></var><br>
<blockquote><p>This should be overriden to return the number of bells that the current method
is on. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Implementing-new-library-classes"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Library-framework">Library framework</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Method-libraries">Method libraries</a>
<br>
</div>

<h3 class="section">5.4 Implementing new library classes</h3>

<p>There are two ways to implement new library classes, depending on whether or
not the new library class can support the automatic detection of library type
done in the <code>library(const string&amp; </code><var>filename</var><code>)</code> constructor.  In
general, if the library is based on a single text file, the auto-detection
mechanism adequately provides a simple way for users of to transparently use
various types of library.  More complicated types of library, such as those
based on a database, or on multiple files, fit less well with the
auto-detection mechanism, and some alternative mechanism is often better.

<ul class="menu">
<li><a accesskey="1" href="#Supporting-auto_002ddetection">Supporting auto-detection</a>
<li><a accesskey="2" href="#Alternative-creation-mechanisms">Alternative creation mechanisms</a>
<li><a accesskey="3" href="#Subclassing-library_005fbase">Subclassing library_base</a>
<li><a accesskey="4" href="#Subclassing-library_005fentry-impl">Subclassing library_entry impl</a>
</ul>

<div class="node">
<p><hr>
<a name="Supporting-auto_002ddetection"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Alternative-creation-mechanisms">Alternative creation mechanisms</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Implementing-new-library-classes">Implementing new library classes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Implementing-new-library-classes">Implementing new library classes</a>
<br>
</div>

<h4 class="subsection">5.4.1 Supporting auto-detection</h4>

<p>The implementation of a new type of library that can be auto-detected needs to
register a function with the signature <code>library::init_function</code> with
<code>library::addtype</code>.  This gets used by the library class when it attempts
to open a file.  It is often convenient to provide
the library user with a <code>registerlib</code> function that handles this
registration.  For example, for a type of library file that always starts
with the line &ldquo;My Library File&rdquo;, the following might be used.

<pre class="example">     class mylibrary : public library_base {
     public:
       // Allow the user to initialise the library
       static void registerlib(void) {
         library::addtype(&amp;canread);
       }
     
     private:
       static library_base *canread(const string&amp; name) {
         ifstream ifs(name); string first_line;  getline(ifs, first_line);
         if (first_line == "My Library File") return new mylibrary(name);
         return NULL;
       }
     
       mylibrary(const string &amp;name);
     };
</pre>
   <p>In addition, the implementation must override the <code>library_base::good</code>
and <code>library_base::begin</code> virtual functions.  This is discussed elsewhere.

<div class="node">
<p><hr>
<a name="Alternative-creation-mechanisms"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Subclassing-library_005fbase">Subclassing library_base</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Supporting-auto_002ddetection">Supporting auto-detection</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Implementing-new-library-classes">Implementing new library classes</a>
<br>
</div>

<h4 class="subsection">5.4.2 Alternative creation mechanisms</h4>

<p>In cases where it is inappropriate to use the auto-detection mechanism an
alternative way of initialising <code>library</code> with a pointer to a subclass of
<code>library_base</code> must be provided.  To do this, the implementation should
provide subclasses of both <code>library</code> and <code>library_base</code>.  The
constructor of the subclass of <code>library</code> should call down to
protected <code>library::library (library_base* </code><var>lb</var><code>)</code> constrctor with
a newly allocated subclass of <code>library_base</code>.  For example,

<pre class="example">     class mylibrary : public library {
     private:
       class impl : public library_base {
         // override virtual functions
       };
     
       impl *init_library() {
         // Do any necessary initialisation
         return new impl;
       }
     
     public:
       mylibrary() : library( init_library() ) {}
     };
</pre>
   <p>Usually it is sensible to avoid putting any data members or virtual
functions in <code>mylibrary</code>, and to put them into <code>mylibrary::impl</code>
instead.  This means that if a <code>mylibrary</code> class is sliced to a
<code>library</code> during a copy (for example when passing to a function taking
a <code>library</code> by value) the class will still work correctly.

   <p>Note that <code>library::~library</code> is <em>not</em> virtual, and thus,
if <code>mylibrary</code> is ever allocated on the heap, care is required to avoid
deletion via a pointer to its base class.

<div class="node">
<p><hr>
<a name="Subclassing-library_005fbase"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Subclassing-library_005fentry-impl">Subclassing library_entry impl</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Alternative-creation-mechanisms">Alternative creation mechanisms</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Implementing-new-library-classes">Implementing new library classes</a>
<br>
</div>

<h4 class="subsection">5.4.3 Subclassing library_base</h4>

<p>In addition to providing mechanism for opening libraries, implementations
of new library types must also override at least the <code>library_base::good</code>
and <code>library_base::begin</code> virtual functions.  The implementation of the
<code>good</code> function is usually trivial, and <code>begin</code> only slightly less
so.  Continuing with the example used in <a href="#Supporting-auto_002ddetection">Supporting auto-detection</a>, they
might be as follows:

<pre class="example">     class mylibrary : public library_base {
       mylibrary(const string &amp;filename) : ifs(filename) {}
     
       class entry_type : public library_entry {
         // ...
       };
     
       const_iterator make_begin() {
         ifs.clear(); ifs.seekg(0, ios::beg); // Rewind the stream
         return const_iterator( this, new entry_type );
       }
     
       virtual bool good() const { return ifs; }
     
       virtual const_iterator begin() const {
         return const_cast&lt; mylibrary* &gt;( this )-&gt;make_begin();
       }
     
       ifstream ifs;
     }
</pre>
   <p>Notice the slight awkwardness of the <code>const_cast</code> in <code>begin</code>.  This
is necessary because the <code>begin</code> function is sematically constant&mdash;it
does not change the visible state of the library&mdash;but it needs to rewind
<var>ifs</var>.  The stream's position is not part of the visible state
of the library because the <code>library::const_iterator</code> is only an
Input Iterator and so only one of them can ever be present at any time.

<div class="node">
<p><hr>
<a name="Subclassing-library_005fentry-impl"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Subclassing-library_005fbase">Subclassing library_base</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Implementing-new-library-classes">Implementing new library classes</a>
<br>
</div>

<h4 class="subsection">5.4.4 Subclassing library_entry impl</h4>

<p>The last step of implementing a library is to provide a class that implements
the <code>library_entry::impl</code> interface, and most importantly, the
<code>library_entry::impl::readentry</code> function.  There are various possible
implementation strategies: the simplest is to get <code>readentry</code> to parse
the whole of the library entry, store the name, place notation and so on in
data members, and then have the <code>name</code>, <code>pn</code>, etc. functions return
these.  This is illustrated below:

<pre class="example">     class mylibrary : public library_base {
       class my_library::entry_type : public library_entry::impl {
     
         // Do a deep-copy of the entry
         virtual library_entry::impl* clone() const {
           return new entry_type(*this);
         }
     
         // Parse the entry
         virtual bool readentry( library_bas&amp; lb ) {
           ifstream &amp;ifs = dynamic_cast&lt; cclib&amp; &gt;( lb ).ifs;
           if (!ifs) return false; // Have we reached the end of file?
           string entry; getline( ifs, entry );
     
           // Assume the entry is in the format Method Name:Place Notation
           string::size_type p = linebuf.find(':');
           name_ = string( entry, 0, p );
           pn_   = string( entry, p+1, string::npos );
           return true;
         }
     
         // Access parts of the entry
         virtual string name() const { return name_; }
         virtual string pn() const   { return pn_;   }
     
         string name_, pn_;
       };
     
       ifstream ifs;
     };
</pre>
   <p>An alternative implementation strategy would be to have <code>readline</code> store
the whole line in data member (i.e. make <var>entry</var> a data member), and
then get <code>name</code> and <code>pn</code> to generate these on-the-fly from the
<var>entry</var> string.

<div class="node">
<p><hr>
<a name="Proof"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Musical-Analysis">Musical Analysis</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Method-libraries">Method libraries</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">6 Method and Touch Proving</h2>

<p><a name="index-proving-rows-234"></a><a name="index-_0040code_007bproof_007d-class-235"></a>

<ul class="menu">
<li><a accesskey="1" href="#The-proof-class">The proof class</a>
</ul>

<div class="node">
<p><hr>
<a name="The-proof-class"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Proof">Proof</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Proof">Proof</a>
<br>
</div>

<h3 class="section">6.1 The <code>proof</code> class</h3>

<p>The proof class provides a simple way of checking that a block of rows
are true.  It provides functions for finding out where a particular block
has failed.  Additionally, it will can check blocks that are more than
one extent long.

   <p>It is a template class, defined as <code>template &lt;class RowIterator&gt;
class proof;</code>.  You can therefore decide on your own method of
generating rows, as long as you can provide an iterator (see the
<acronym>STL</acronym>) for it.

   <p>It will check ALL rows given; therefore, if rounds are at the start and
end, then one of them should be removed before passing to the object.

   <p>The proof class only stores the results: it does not make a copy of the
actual rows.  However, pointers to false rows will be stored, so don't
destroy your rows before getting all the proof results.  This may be
changed in a later release.

   <p>Note: To avoid problems, make sure that all the rows have the same number
of bells in them, otherwise 12345 will not 123456.

<ul class="menu">
<li><a accesskey="1" href="#proof-Derivation">proof Derivation</a>
<li><a accesskey="2" href="#proof-Constructors">proof Constructors</a>
<li><a accesskey="3" href="#proof-Functions">proof Functions</a>
<li><a accesskey="4" href="#proof-Operators">proof Operators</a>
<li><a accesskey="5" href="#proof-Output">proof Output</a>
<li><a accesskey="6" href="#Falseness-Storage">Falseness Storage</a>
<li><a accesskey="7" href="#How-Proof-Works">How Proof Works</a>
</ul>

<div class="node">
<p><hr>
<a name="proof-Derivation"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#proof-Constructors">proof Constructors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-proof-class">The proof class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-proof-class">The proof class</a>
<br>
</div>

<h4 class="subsection">6.1.1 Derivation</h4>

<p>This class is not derived from any other classes.

<pre class="example">     template &lt;class RowIterator&gt; class proof;
</pre>
   <div class="node">
<p><hr>
<a name="proof-Constructors"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#proof-Functions">proof Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#proof-Derivation">proof Derivation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-proof-class">The proof class</a>
<br>
</div>

<h4 class="subsection">6.1.2 Constructors</h4>

<p>Where the variable <var>qp</var> is passed into a function, if this is set to true, the proof class will only check until the row blocks are found to be false, as soon as this is the case, the function will end and store the true/false result. No details will be stored about what lines the row block failed on.

<div class="defun">
&mdash; Constructor:  <b>proof::proof</b> (<var>void</var>)<var>;<a name="index-proof_003a_003aproof-236"></a></var><br>
<blockquote><p>Default Constructor. Sets trueness to false. Use the prove function to provide the rows to prove. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>proof::proof</b> (<var>RowIterator first, RowIterator last, bool qp = false</var>)<var>;<a name="index-proof_003a_003aproof-237"></a></var><br>
<blockquote><p>This checks for repeated rows from first to last. Expects up to 1 extent only. Result is stored in class for later retrieval. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>proof::proof</b> (<var>RowIterator first, RowIterator last, const int max, bool qp = false</var>)<var>;<a name="index-proof_003a_003aproof-238"></a></var><br>
<blockquote><p>This checks for repeated rows from first to last. Expects up to <var>max</var> extents. Result is stored in class for later retrieval. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>proof::proof</b> (<var>RowIterator true_first, RowIterator true_last, RowIterator unknown_first, RowIterator unknown_last, bool qp = false</var>)<var>;<a name="index-proof_003a_003aproof-239"></a></var><br>
<blockquote><p>This constructor takes two blocks of rows as it parameters. <var>true_first</var> to <var>true_last</var> are assumed to be a block of rows that are true. No trueness checking is performed on these rows. 
The function looks at rows <var>unknown_first</var> to <var>unknown_last</var> comparing them to the true block, and to the unknown block to see if they are repeated anywhere. 
The failure information is reset before the analysis takes place, hence any falseness details obtained will be for the new block only. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>proof::proof</b> (<var>RowIterator true_first, RowIterator true_last, RowIterator unknown_first, RowIterator unknown_last, const int max, bool qp = false</var>)<var>;<a name="index-proof_003a_003aproof-240"></a></var><br>
<blockquote><p>This constructor acts like the previous, except it will expect up to <var>max</var> extents (and hence repititions). 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="proof-Functions"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#proof-Operators">proof Operators</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#proof-Constructors">proof Constructors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-proof-class">The proof class</a>
<br>
</div>

<h4 class="subsection">6.1.3 Functions</h4>

<p>Where the variable <var>qp</var> is passed into a function, if this is set to true, the proof class will only check until the row blocks are found to be false, as soon as this is the case, the function will end and store the true/false result. No details will be stored about what lines the row block failed on.

<div class="defun">
&mdash; Function: bool <b>proof::prove</b> (<var>RowIterator first, RowIterator last, bool qp = false</var>)<var>;<a name="index-proof_003a_003aprove-241"></a></var><br>
<blockquote><p>This checks for repeated rows from first to last. Expects up to 1 extent only. Full result is stored in class for later retrieval, but trueness of rows is returned. This function will erase any falseness details stored in the class. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: bool <b>proof::prove</b> (<var>RowIterator first, RowIterator last, const int max, bool qp = false</var>)<var>;<a name="index-proof_003a_003aprove-242"></a></var><br>
<blockquote><p>This checks for repeated rows from first to last. Expects up to <var>max</var> extents. Full result is stored in class for later retrieval, but trueness of rows is returned. This function will erase any falseness details stored in the class. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: bool <b>proof::prove</b> (<var>RowIterator true_first, RowIterator true_last, RowIterator unknown_first, RowIterator unknown_last, bool qp = false</var>)<var>;<a name="index-proof_003a_003aprove-243"></a></var><br>
<blockquote><p>This function takes two blocks of rows as it parameters. <var>true_first</var> to <var>true_last</var> are assumed to be a block of rows that are true. No trueness checking is performed on these rows. 
The function looks at rows <var>unknown_first</var> to <var>unknown_last</var> comparing them to the true block, and to the unknown block to see if they are repeated anywhere. 
The failure information is reset before the analysis takes place, hence any falseness details obtained will be for the new block only. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: bool <b>proof::prove</b> (<var>RowIterator true_first, RowIterator true_last, RowIterator unknown_first, RowIterator unknown_last, const int max, bool qp = false</var>)<var>;<a name="index-proof_003a_003aprove-244"></a></var><br>
<blockquote><p>This function acts like the previous, except it will expect up to <var>max</var> extents (and hence repititions). 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="proof-Operators"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#proof-Output">proof Output</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#proof-Functions">proof Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-proof-class">The proof class</a>
<br>
</div>

<h4 class="subsection">6.1.4 Operators</h4>

<div class="defun">
&mdash; Operator: operator <b>proof::int</b> (<var>void</var>)<var> const;<a name="index-proof_003a_003aint-245"></a></var><br>
<blockquote><p>This returns true (or 1) if the touch is true. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: int <b>proof::operator!</b> (<var>void</var>)<var> const;<a name="index-proof_003a_003aoperator_0021-246"></a></var><br>
<blockquote><p>This returns true (or 1) if the touch is not true. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="proof-Output"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Falseness-Storage">Falseness Storage</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#proof-Operators">proof Operators</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-proof-class">The proof class</a>
<br>
</div>

<h4 class="subsection">6.1.5 Output</h4>

<p>Output of the proof class is achieved in one of two ways. Either, the functions proof::int and failed() are used, or an overloaded ostream operator for a fixed format.

<div class="node">
<p><hr>
<a name="Falseness-Storage"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#How-Proof-Works">How Proof Works</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#proof-Output">proof Output</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-proof-class">The proof class</a>
<br>
</div>

<h4 class="subsection">6.1.6 How falseness is stored</h4>

<p><a name="index-falseness-storage-247"></a>
When the proof class finds two or more rows that are the same, it stores the details in a private variable, <var>where</var>. This can be retrieved by the function <code>failed</code>. The variable is defined as:

<pre class="example">     typedef list&lt;linedetail&gt; proof::failinfo;
     failinfo <var>where</var>;
</pre>
   <p>linedetail is a struct defined as:

<pre class="example">     struct linedetail {
      row _row;
      list&lt;int&gt; _lines;
     };
</pre>
   <p>When a row is repeated more than once, a new linedetail item is added to <var>where</var>. In the linedetail data is stored a pointer, <var>_row</var>, to the first of the matching rows, and the row numbers are put into <var>_lines</var>. If the first row given to the class matches the 11th row, then 0 and 10 will be placed into <var>_lines</var>. If there are three or more rows that all match, then the relevant numbers will be placed into the <var>_lines</var> list without repeating any.

<div class="node">
<p><hr>
<a name="How-Proof-Works"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Falseness-Storage">Falseness Storage</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-proof-class">The proof class</a>
<br>
</div>

<h4 class="subsection">6.1.7 How it works</h4>

<p><a name="index-How-proof-works-248"></a>
There are two ways that the class can prove blocks of rows depending on if the number of rows is less or greater than an extent. In both methods, the procedures are carried through to the end to allow the user to see where the block of rows is false in all places, not just the first.

<h4 class="subsection">6.1.8 Single Extent</h4>

<p>If the single extent version of the function <code>proof::prove</code> is called, then we follow this procedure.

   <p>Here we look at the first row and compare it to the rest. Then we proceed to the second and compare that to the rest (starting from the third, and going to the end). We then continue this until we have completed all the rows. If two rows match the details are stored and the trueness is set to false.

<h4 class="subsection">6.1.9 Multiple Extents</h4>

<p>If the multiple extent version of the function <code>proof::prove</code> is called, then we follow this procedure.

   <p>Now we proceed through the list just once. Each row is put into a multimap, if at any time the amount of rows in this map exceed the maximum number of extents then the details are added into the failed information and the trueness is set to false.

<div class="node">
<p><hr>
<a name="Musical-Analysis"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Producing-printed-output">Producing printed output</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Proof">Proof</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">7 Analysis of Music</h2>

<p><a name="index-Music-Analysis-249"></a><a name="index-music-class-250"></a>
The music class provides analysis for music within a set of rows. The
class has been designed around providing a regular-expression style
matching algorithm. This provides flexibility in the way the user can
enter their own music. Additionally, for each 'regular-expression' a
score can be allocated. For a full description of the regular
expressions the ringing library currently provides see Music Regular
Expressions.

   <p>The music class processes each row just once, it does not store any
rows. It assumes that the first row given is a handstroke row. The class
should be able to handle any number of bells that the row class can. Note,
that matches for complete rows should be done on a same number of bells basis.

   <p>Each time the analysis function is called, the results stored in the
class are reset to zero, and then incremented based on the rows given.

<ul class="menu">
<li><a accesskey="1" href="#Stroke-Enumeration">Stroke Enumeration</a>
<li><a accesskey="2" href="#Music-Regular-Expressions">Music Regular Expressions</a>
<li><a accesskey="3" href="#Using-the-Music-Class">Using the Music Class</a>
<li><a accesskey="4" href="#music-class-definition">music class definition</a>
<li><a accesskey="5" href="#music-node-class-definition">music node class definition</a>
</ul>

<div class="node">
<p><hr>
<a name="Stroke-Enumeration"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Music-Regular-Expressions">Music Regular Expressions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Musical-Analysis">Musical Analysis</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Musical-Analysis">Musical Analysis</a>
<br>
</div>

<h3 class="section">7.1 Stroke Description</h3>

<p><a name="index-EStroke-251"></a><a name="index-eHandstroke-252"></a><a name="index-eBackstroke-253"></a><a name="index-eBoth-254"></a>
Part of the music class functionality is to allow handstrokes and
backstrokes to be specified independently, or together. An enumeration,
<code>EStroke</code> is provided to enable this to take place.

   <p>It is defined as follows:

<pre class="example">     enum EStroke
     {
       eHandstroke,
       eBackstroke,
       eBoth
     };
</pre>
   <div class="node">
<p><hr>
<a name="Music-Regular-Expressions"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Using-the-Music-Class">Using the Music Class</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Stroke-Enumeration">Stroke Enumeration</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Musical-Analysis">Musical Analysis</a>
<br>
</div>

<h3 class="section">7.2 Music Regular Expressions</h3>

<p><a name="index-Regular-Expressions-255"></a><a name="index-Specifiying-Musical-Rows-256"></a><a name="index-Musical-Rows-257"></a><a name="index-Music-Expressions-258"></a>
The <code>music_details</code> class provides the means to describe musical
rows to the <code>music</code> class. The <code>music_details</code> class stores
details of the expression to be matched (as a string) and an associated
rating, if the user so desires.

   <p>Ratings may be positive or negative, this allows a total weighted score
to be calculated from the sum of the result scores. For example, 678s
may be rated at a +2, but 87s at backstroke rated as -10.

   <p>When a match sequence is run via the music class, if a row matches that
described by the details provided to a <code>music_details</code> object, then
the count will be incremented.

   <p>The result can either be returned as a raw count, or as a score calculated from the multiplication of the count and the given rating.

   <p>If it is specified, then the count or score can be return for just the handstroke, backstroke or both.

   <p>Further details relating to the music_details class can be accessed from the menu below:

<ul class="menu">
<li><a accesskey="1" href="#Expression-Language">Expression Language</a>
<li><a accesskey="2" href="#Music_005fDetails-class">Music_Details class</a>
</ul>

<div class="node">
<p><hr>
<a name="Expression-Language"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Music_005fDetails-class">Music_Details class</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Music-Regular-Expressions">Music Regular Expressions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Music-Regular-Expressions">Music Regular Expressions</a>
<br>
</div>

<h4 class="subsection">7.2.1 Music Regular Expression Language</h4>

<p>The regular expression strings describing rows that can be matched as 'musical' can be specified using the following characters:

   <p>Representing a bell:

<pre class="example">     1234567890ETABCDFGHJKLMNPQRSUVWYZ
</pre>
   <p>Representing any bell:

<pre class="example">     ?
</pre>
   <p>Representing any bells in any order:

<pre class="example">     *
</pre>
   <p>Representing one of several bells in a set position:

<pre class="example">     [34]
</pre>
   <p>These constructs can be formed into the following (in all these cases we
are matching with a 6 bell method):

<pre class="example">     "12??56" In this case we are wishing to know how many rows occur that are 124356 or 123456.
</pre>
   <pre class="example">     "135246" In this case we are wishing to know how many times queens occur.
</pre>
   <pre class="example">     "*456" In this case we wish to know how many rows there are that finish in 456.
</pre>
   <pre class="example">     "654*" In this case we wish to know how many rows there are that start with 654.
</pre>
   <pre class="example">     "*456*" In this case we wish to know how many rows have 456 in the middle of them, note this includes rows that start 456 and end 456 as well.
</pre>
   <pre class="example">     "*[56]78" in this case we wish to know how many rows end in 578 or 678.
</pre>
   <div class="node">
<p><hr>
<a name="Music_005fDetails-class"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Expression-Language">Expression Language</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Music-Regular-Expressions">Music Regular Expressions</a>
<br>
</div>

<h4 class="subsection">7.2.2 Music Details class</h4>

<p><a name="index-music_005fdetails-259"></a>
The music_details class allows the specification of music via a regular
expression to the music class. Although functions are provided to return the
score, they are mainly intended for use by the music class itself. It should
be noted that the music class takes a copy of the music_details object rather
than a pointer.

<div class="defun">
&mdash; Constructor:  <b>music_details</b> (<var>const string &amp;e = "", const int &amp;s = 1</var>)<var>;<a name="index-music_005fdetails-260"></a></var><br>
&mdash; Constructor:  <b>music_details</b> (<var>const char *e, const int &amp;s = 1</var>)<var>;<a name="index-music_005fdetails-261"></a></var><br>
<blockquote><p>Creates the object and sets the initial expression to e and the score to use
to s. By default the score is 1. If the specified expression is invalid, the class will throw an <code>music_details::invalid_regex</code> exception (if they are enabled) or reset the expression to "". 
</p></blockquote></div>

<div class="defun">
&mdash; Destructor: ~music_details <b>(</b>)<var>;<a name="index-_0028-262"></a></var><br>
<blockquote><p>Destructor. Doesn't do much in this case. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>set</b> (<var>const string &amp;e, const int &amp;s = 1</var>)<var>;<a name="index-set-263"></a></var><br>
&mdash; Function: void <b>set</b> (<var>const char *e, const int &amp;s = 1</var>)<var>;<a name="index-set-264"></a></var><br>
<blockquote><p>Sets the expression to e and the score to s. It will also reset the counts
of rows matched. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: string <b>get</b> ()<var> const;<a name="index-get-265"></a></var><br>
<blockquote><p>Returns the currently stored expression. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: unsigned int <b>possible_matches</b> (<var>const unsigned int &amp;bells</var>)<var> const;<a name="index-possible_005fmatches-266"></a></var><br>
<blockquote><p>Returns the maximum number of possible matches (in one true extent) for the currently specified expression. <var>bells</var> must be specified as the <code>music_details</code> class has no knowledge of this under normal circumstances. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>possible_score</b> (<var>const unsigned int &amp;bells</var>)<var> const;<a name="index-possible_005fscore-267"></a></var><br>
<blockquote><p>Returns the maximum possible score (based on one true extent) for the currently specified expression. <var>bells</var> must be specified as the <code>music_details</code> class has no knowledge of this under normal circumstances. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: unsigned int <b>count</b> (<var>const EStroke&amp; = eBoth</var>)<var> const;<a name="index-count-268"></a></var><br>
<blockquote><p>Returns the number of rows matched based on the stroke that is passed in. 
If eBoth is passed, then the result will be the handstroke count plus the
backstroke count. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>total</b> (<var>const EStroke&amp; = eBoth</var>)<var> const;<a name="index-total-269"></a></var><br>
<blockquote><p>Returns the total score based on the stroke that is passed in. 
If eBoth is passed, then the result will be the handstroke score plus the
backstroke score. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>raw_score</b><var> const;<a name="index-raw_005fscore-270"></a></var><br>
<blockquote><p>Returns the score previously specified to the object. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Using-the-Music-Class"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#music-class-definition">music class definition</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Music-Regular-Expressions">Music Regular Expressions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Musical-Analysis">Musical Analysis</a>
<br>
</div>

<h3 class="section">7.3 Using the Music Class</h3>

<p>The basic process of using the music class is to create it, specify to it the music that you wish to look for in a set of rows, tell it to process the rows and then obtain the results.

   <p>We now describe this in more detail. First create an instance of the music class, specifying to it the number of bells you wish to work with:

<pre class="example">     music mu(5);
</pre>
   <p>Now specify the music that you are looking for via the music details class (see <a href="#Expression-Language">Expression Language</a> for how to do this). The music class behaves like a <code>vector&lt;music_details&gt;</code> structure so you can access the elements individually before and after. To add a music specification, do something like this:

<pre class="example">     music_details md("*45");
     mu.push_back(md);
</pre>
   <p>If you want, more can be added in the same way or by modifying md and pushing the new structure onto the back of the music list:

<pre class="example">     md.set("*345*");
     mu.push_back(md);
</pre>
   <p>Now you can supply the music class with rows to search against the specified music (note pbdoubles is a vector&lt;row&gt;)

<pre class="example">     mu.process_rows(pbdoubles.begin(), pbdoubles.end());
</pre>
   <p>Now you can obtain the results from the music class. You can do this in several ways. The first is to obtain the overall total score, for both strokes, or for one:

<pre class="example">     cout &lt;&lt; "Total Score: " &lt;&lt; mu.get_score() &lt;&lt; endl;
     cout &lt;&lt; "Total Score (Backstroke): " &lt;&lt; mu.get_score(eBackStroke) &lt;&lt; endl;
</pre>
   <p>The second way is to obtain results for individual items:

<pre class="example">     music::const_iterator k;
     
     for (k = mu.begin(); k != mu.end(); k++)
       cout &lt;&lt; "Total for " &lt;&lt; k-&gt;get() &lt;&lt; ": " &lt;&lt; t-&gt;count() &lt;&lt; " : " &lt;&lt; k-&gt;total() &lt;&lt; endl;
</pre>
   <p>This produces three columns, the first is the music expression that was searched for, the second is the number of matches, the third is the number of matches based on the score. See the <a href="#Music_005fDetails-class">Music_Details class</a> for more details on these functions.

<div class="node">
<p><hr>
<a name="music-class-definition"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#music-node-class-definition">music node class definition</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Using-the-Music-Class">Using the Music Class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Musical-Analysis">Musical Analysis</a>
<br>
</div>

<h3 class="section">7.4 Music Class definition</h3>

<p><a name="index-music-class-271"></a>
The <code>music</code> class is the main control of the music classes; it stores <code>music_details</code> objects to match music against and controls the construction of the <code>music_node</code> tree (see <a href="#music-node-class-definition">music node class definition</a>.

   <p>The class must know the number of bells in the rows that are to be examined before the <code>music_class</code> objects are passed to it; this allows it to create trees of the correct depth and structure to store the regular expressions in search format.

   <p>The <code>music_detail</code> objects are stored in a <code>vector&lt;music_details&gt;</code> structure, this is accessible via the functions provided (detailed below).

<ul class="menu">
<li><a accesskey="1" href="#Music-Derivation">Music Derivation</a>
<li><a accesskey="2" href="#Music-Constructors">Music Constructors</a>
<li><a accesskey="3" href="#Music-Type-Definitions">Music Type Definitions</a>
<li><a accesskey="4" href="#Music-Functions">Music Functions</a>
</ul>

<div class="node">
<p><hr>
<a name="Music-Derivation"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Music-Constructors">Music Constructors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#music-class-definition">music class definition</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#music-class-definition">music class definition</a>
<br>
</div>

<h4 class="subsection">7.4.1 Derivation</h4>

<p>This class is not derived from any other classes.

<pre class="example">     class music;
</pre>
   <div class="node">
<p><hr>
<a name="Music-Constructors"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Music-Type-Definitions">Music Type Definitions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Music-Derivation">Music Derivation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#music-class-definition">music class definition</a>
<br>
</div>

<h4 class="subsection">7.4.2 Constructors</h4>

<div class="defun">
&mdash; Constructor:  <b>music::music</b> (<var>const unsigned int &amp;b = 0</var>)<var>;<a name="index-music_003a_003amusic-272"></a></var><br>
<blockquote><p>This constructor initialises the number of bells to zero. If you don't specify bells here, you should specify the number of bells by the <code>set_bells()</code> function before adding expressions to be matched. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Music-Type-Definitions"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Music-Functions">Music Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Music-Constructors">Music Constructors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#music-class-definition">music class definition</a>
<br>
</div>

<h4 class="subsection">7.4.3 Type Definitions</h4>

<p>This section details the type definitions that the music class creates for the user to use.

<div class="defun">
&mdash; typedef: vector&lt;music_details&gt; <b>music::mdvector;</b><var><a name="index-music_003a_003amdvector_003b-273"></a></var><br>
<blockquote><p>This type defines the storage vector that records the expressions to be matched and is also used to obtain the results. 
</p></blockquote></div>

<div class="defun">
&mdash; typedef: vector&lt;music_details&gt;::iterator <b>music::iterator;</b><var><a name="index-music_003a_003aiterator_003b-274"></a></var><br>
&mdash; typedef: vector&lt;music_details&gt;::const_iterator <b>music::const_iterator;</b><var><a name="index-music_003a_003aconst_005fiterator_003b-275"></a></var><br>
<blockquote><p>This type defines a general iterator that can be used to iterate through the stored expressions. 
</p></blockquote></div>

<div class="defun">
&mdash; typedef: vector&lt;music_details&gt;::size_type <b>music::size_type;</b><var><a name="index-music_003a_003asize_005ftype_003b-276"></a></var><br>
<blockquote><p>This type defines the type of variable returned from the <code>size()</code> function. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Music-Functions"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Music-Type-Definitions">Music Type Definitions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#music-class-definition">music class definition</a>
<br>
</div>

<h4 class="subsection">7.4.4 Functions</h4>

<div class="defun">
&mdash; Function: void <b>push_back</b> (<var>const music_details &amp;</var>)<var>;<a name="index-push_005fback-277"></a></var><br>
<blockquote><p>This function adds a <code>music_details</code> expression onto the vector of expressions to be matched. It will also add it to the tree ready for processing against rows. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: music::iterator <b>begin</b> (<var>void</var>)<var>;<a name="index-begin-278"></a></var><br>
&mdash; Function: music::const_iterator <b>begin</b> (<var>void</var>)<var> const;<a name="index-begin-279"></a></var><br>
<blockquote><p>These functions return an iterator that points at the beginning of the expression list. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: music::iterator <b>end</b> (<var>void</var>)<var>;<a name="index-end-280"></a></var><br>
&mdash; Function: music::const_iterator <b>end</b> (<var>void</var>)<var> const;<a name="index-end-281"></a></var><br>
<blockquote><p>These functions return an iterator that points past the end of the expression list. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: music::size_type <b>size</b> (<var>void</var>)<var>;<a name="index-size-282"></a></var><br>
<blockquote><p>This function returns the number of expressions currently stored. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>set_bells</b> (<var>const unsigned int &amp;b</var>)<var>;<a name="index-set_005fbells-283"></a></var><br>
<blockquote><p>This function sets the number of bells that will be in the matched rows to <code>b</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: template &lt;class RowIterator&gt; void <b>process_rows</b> (<var>RowIterator first, RowIterator last, bool backstroke = false</var>)<var>;<a name="index-process_005frows-284"></a></var><br>
<blockquote><p>This function first resets the all of the music counts, and then processes the supplied rows. If backstroke is true, then a backstroke is assumed to be the first row, otherwise it will be noted as a handstroke. The stroke will be toggled for every row processed. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>get_score</b> (<var>const EStroke&amp; = eBoth</var>)<var>;<a name="index-get_005fscore-285"></a></var><br>
<blockquote><p>Returns the score for music matched at the specified stroke. If eBoth is specified as the stroke, then scores for both strokes are added together and returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: unsigned <b>int</b><var> get_count </var>(<var>const EStroke&amp; = eBoth</var>)<var>;<a name="index-int-286"></a></var><br>
<blockquote><p>Returns the total number of matches for all music expressions at the specified stroke. If eBoth is specified, then the counts for both strokes are added and returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>get_possible_score</b> (<var>void</var>)<var>;<a name="index-get_005fpossible_005fscore-287"></a></var><br>
<blockquote><p>This function returns the maximum possible score that could be obtained matching the expressions currently stored against a true extent on the number of bells previously specified. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="music-node-class-definition"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#music-class-definition">music class definition</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Musical-Analysis">Musical Analysis</a>
<br>
</div>

<h3 class="section">7.5 Music Node Class definition</h3>

<p><a name="index-music_005fnode-288"></a>
The <code>music_node</code> class provides the main expression matching routines for the <code>music</code> class. A <code>music</code> object stores one <code>TopNode</code> object, (of type <code>music_node</code>), when expressions are added to the <code>music</code> object, via a <code>music_details</code> class, a tree is formed under the <code>TopNode</code> object.

   <p>The <code>music_node</code> class is normally hidden from the user by the <code>music</code> class, however, it's functionality is described here to aid maintainance and understanding.

<ul class="menu">
<li><a accesskey="1" href="#Music_005fNode-Full-Description">Music_Node Full Description</a>
<li><a accesskey="2" href="#Music_005fNode-Derivation">Music_Node Derivation</a>
<li><a accesskey="3" href="#Music_005fNode-Constructors-and-Destructors">Music_Node Constructors and Destructors</a>
<li><a accesskey="4" href="#Music_005fNode-Type-Definitions">Music_Node Type Definitions</a>
<li><a accesskey="5" href="#Music_005fNode-Functions">Music_Node Functions</a>
<li><a accesskey="6" href="#Music_005fNode-Exceptions">Music_Node Exceptions</a>
</ul>

<div class="node">
<p><hr>
<a name="Music_005fNode-Full-Description"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Music_005fNode-Derivation">Music_Node Derivation</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#music-node-class-definition">music node class definition</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#music-node-class-definition">music node class definition</a>
<br>
</div>

<h4 class="subsection">7.5.1 Full Description</h4>

<p>Each node in the tree stores the expressions that finish at the node, and pointers to nodes below them, if any have been created. Note, for any node there are a maximum of n pointers, where n is the number of bells, plus one; The extra case in this instance is for a ? or * expression to match any bell.

   <p>When a row is to be matched against the expressions stored, each bell in the row is examined individually. If a pointer to a node for the same number as the current bell exists, the matching passes onto the node pointed at. For all cases, if an 'any' pointer exists, then the matching will be passes onto the any node.

   <p>When the expression matching comes up against a node where an expression is specified to finish at that node, then the counter for matches against the node is incremented. If there are no matches to the current bell, and the any pointer does not exist, then the matching simply finishes and returns back up the tree.

   <p>This is probably better explained by means of an example. Suppose the expression <span class="samp">321654</span> is added to the TopNode. If <span class="samp">+</span> is a node, and <span class="samp">|n</span> is a pointer between the nodes, where n is the number of bell pointed to, then the following tree is formed:

<pre class="example">     TopNode
     |3
     +
     |2
     +
     |1
     +
     |6
     +
     |5
     +
     |4
     + <span class="samp">321654</span> finishes here.
</pre>
   <p>When the row <span class="samp">326154</span> is attempted to be matched, the following happens:

<pre class="example">     TopNode -&gt; Pointer to 3 exists, so go to the next node.
     |3
     +       -&gt; Pointer to 2 exists, so go to the next node.
     |2
     +       -&gt; Pointer to 6 (or to any node) does not exist, so terminate.
     |1
</pre>
   <p>Now suppose <span class="samp">321*</span> and <span class="samp">?2*</span> is added to the list, the following tree is formed:

<pre class="example">                 TopNode
                    |
     -------------------------------
     |3                            |any
     +                             +
     |2                            |2
     +                             + <span class="samp">?2*</span> finishes here.
     |1
     + <span class="samp">321*</span> finishes here.
     |6
     +
     |5
     +
     |4
     + <span class="samp">321654</span> finishes here.
</pre>
   <p>Now, when the row <span class="samp">321654</span> is put through the matching process, the following happens. Taking first the pointer to bell '3' option of TopNode:

<pre class="example">     TopNode -&gt; Pointer to 3 exists, so go to the next node.
     |3
     +       -&gt; Pointer to 2 exists, so go to the next node.
     |2
     +       -&gt; Pointer to 1 exists, so go to the next node.
     |1
     +       -&gt; <span class="samp">321*</span> finishes here so increment, and then as pointer to 6
                exists, carry on to the next node.
     |6
     +       -&gt; Pointer to 5 exists, so go on.
     |5
     +       -&gt; Pointer to 4 exists, so go on.
     |4
     +       -&gt; <span class="samp">321654</span> finishes here so increment matches. No further
                pointers, so go back up the tree checking for <span class="samp">any</span> pointers
</pre>
   <p>When the matching gets back to the top of the tree and finds the any pointer in the top node, it will follow it as below:

<pre class="example">     TopNode -&gt; Any pointer exists, so follow it
     |any
     +       -&gt; Note, we are now on the second bell of the row, which in our case
                is <span class="samp">2</span>, pointer exists, so follow it.
     |2
     +       -&gt; <span class="samp">?2*</span> finishes here so increment matches.
</pre>
   <p>From these examples it can be seen that an optimisation is performed when there is a single <span class="samp">*</span> left, which saves the matching algorithm going through exvery any node.

<div class="node">
<p><hr>
<a name="Music_005fNode-Derivation"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Music_005fNode-Constructors-and-Destructors">Music_Node Constructors and Destructors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Music_005fNode-Full-Description">Music_Node Full Description</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#music-node-class-definition">music node class definition</a>
<br>
</div>

<h4 class="subsection">7.5.2 Derivation</h4>

<p>This class is not derived from any other classes.

<pre class="example">     class music_node;
</pre>
   <div class="node">
<p><hr>
<a name="Music_005fNode-Constructors-and-Destructors"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Music_005fNode-Type-Definitions">Music_Node Type Definitions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Music_005fNode-Derivation">Music_Node Derivation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#music-node-class-definition">music node class definition</a>
<br>
</div>

<h4 class="subsection">7.5.3 Constructors and Destructors</h4>

<div class="defun">
&mdash; Constructor:  <b>music_node::music_node</b> (<var>void</var>)<var>;<a name="index-music_005fnode_003a_003amusic_005fnode-289"></a></var><br>
&mdash; Constructor:  <b>music_node::music_node</b> (<var>const unsigned int &amp;b</var>)<var>;<a name="index-music_005fnode_003a_003amusic_005fnode-290"></a></var><br>
<blockquote><p>The constructor initialises the object and sets the number of bells in the rows that will be matched. If the default constructor is used, then the <code>set_bells()</code> function should be used to perform this action. 
</p></blockquote></div>

<div class="defun">
&mdash; Destructor:  <b>music_node::~music_node</b> (<var>void</var>)<var>;<a name="index-music_005fnode_003a_003a_007emusic_005fnode-291"></a></var><br>
<blockquote><p>The destructor will go through the tree structure, deleting the sub-nodes of the current node. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Music_005fNode-Type-Definitions"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Music_005fNode-Functions">Music_Node Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Music_005fNode-Constructors-and-Destructors">Music_Node Constructors and Destructors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#music-node-class-definition">music node class definition</a>
<br>
</div>

<h4 class="subsection">7.5.4 Type Definitions</h4>

<div class="defun">
&mdash; typedef: map&lt;unsigned <b>int</b><var>, music_node*&gt; BellNodeMap;<a name="index-int-292"></a></var><br>
<blockquote><p>This map is used to form the structure of the tree. The branches are stored in the structure, with the unsigned int being an index by bell number. Index 0 is for matching any bell. Note, where a node of the tree has no branches coming off of it (because it is the end, or there is nothing else to match against) the map will be empty. 
</p></blockquote></div>

<div class="defun">
&mdash; typedef: BellNodeMap::iterator <b>BellNodeMapIterator;</b><var><a name="index-BellNodeMapIterator_003b-293"></a></var><br>
<blockquote><p>This type definition is used to provide a shorter type name to iterate the map described above. 
</p></blockquote></div>

<div class="defun">
&mdash; typedef: vector&lt;unsigned <b>int&gt;</b><var> DetailsVector;<a name="index-int_003e-294"></a></var><br>
<blockquote><p>This type definition defines the vector that is used to store the id of the music_details expressions that end at this node. 
</p></blockquote></div>

<div class="defun">
&mdash; typedef: DetailsVector::iterator <b>DetailsVectorIterator;</b><var><a name="index-DetailsVectorIterator_003b-295"></a></var><br>
<blockquote><p>This type definition is used to provide a shorter type name to iterate the details vector defined above. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Music_005fNode-Functions"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Music_005fNode-Exceptions">Music_Node Exceptions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Music_005fNode-Type-Definitions">Music_Node Type Definitions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#music-node-class-definition">music node class definition</a>
<br>
</div>

<h4 class="subsection">7.5.5 Functions</h4>

<div class="defun">
&mdash; Function: void <b>set_bells</b> (<var>const unsigned int &amp;b</var>)<var>;<a name="index-set_005fbells-296"></a></var><br>
<blockquote><p>This function is used to set the number of bells that will be in the rows to be matched against. This provides a way for the algorithms to know when they are finished processing the expressions or row. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>add</b> (<var>const music_details &amp;md, const unsigned int &amp;i, const unsigned int &amp;key, const unsigned int &amp;pos</var>)<var>;<a name="index-add-297"></a></var><br>
<blockquote><p>This function is used to add the supplied expression (<code>md</code>), to the tree. The location in the expression to look at is supplied by <code>i</code>, the <code>key</code> is the reference number that the <code>music</code> class stores the <code>md</code> expression against, and the <code>pos</code> is the number of bells deep we are in the tree.

        <p>Depending on the item in the expression at index <code>i</code>, the algorithm will do different things, normally, it will call the <code>add_to_subtree(...)</code> function which in turn will usually call this function again; sometimes it will call itself (in the case of a <span class="samp">'*'</span>) to move along the current expression without necessarily adding it to a subtree. Hence, the <code>add(...)</code> function is an iterative one. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>add_to_subtree</b> (<var>const unsigned int &amp;place, const music_details &amp;md, const unsigned int &amp;i, const unsigned int &amp;key, const unsigned int &amp;pos, const bool &amp;process_star</var>)<var>;<a name="index-add_005fto_005fsubtree-298"></a></var><br>
<blockquote><p>This private function is used to create a branch (if required) and add an expression to a branch of a node. If it cannot allocate memory for the new node, it will either throw a <code>memory_error</code> exception (if enabled), or it will simply return without going any further.

        <p>The <code>place</code> parameter provides the branch number (= bell) to create and add to, the <code>process_star</code> parameter is used to indicate if the number of <span class="samp">*</span>s remaining should be processed or ignored. The rest of the parameters are as for the <code>add(...)</code> function. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>match</b> (<var>const row &amp;r, const unsigned int &amp;pos, vector&lt;music_details&gt; &amp;results, const EStroke &amp;stroke</var>)<var>;<a name="index-match-299"></a></var><br>
<blockquote><p>This function is iterative and is used to match the expressions stored to a row, <code>r</code>. If a node is found to have an expression ending there, the number of counts for that expression are incremented according to the specified <code>stroke</code>. The <code>pos</code> parameter is used to specify the current position in the row <code>r</code>, and the <code>results</code> parameter is the expressions for which the indexes have previously been stored, and against which the count should be incremented as appropriate. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Music_005fNode-Exceptions"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Music_005fNode-Functions">Music_Node Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#music-node-class-definition">music node class definition</a>
<br>
</div>

<h4 class="subsection">7.5.6 Exceptions</h4>

<p>There is one exception defined for this class:

<pre class="example">     struct memory_error : public overflow_error() {
       memory_error()
     };
     
     music_node::memory_error::memory_error()
       : overflow_error("Not enough memory to allocate to music_node item") {}
</pre>
   <p>This is used to indicate that there is not enough memory to add a music_node item.

<div class="node">
<p><hr>
<a name="Producing-printed-output"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Copying-this-manual">Copying this manual</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Musical-Analysis">Musical Analysis</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">8 Producing printed output</h2>

<p><a name="index-printing-300"></a>
The Ringing Class Library provides a flexible mechanism for producing
printed output of rows, methods and lines.  The way this mechanism is
designed means that the low-level details of printing are hidden from
the programmer.  Currently the classes in the library support output in
PostScript and PDF formats, and the modularity of the printing system
makes it easy to extend the library to provide other output formats.

   <p>Basic printing is provided in two classes: the <code>printpage</code> class
and the <code>printrow</code> class.  The first of these deals with placing
text and other objects directly on the page; the second allows for
formatted output of rows and lines.  These classes are both pure virtual
classes, which are specialised by subclasses to allow for different
output formats.

   <p>Printing of whole methods is accomplished by the <code>printmethod</code>
object.  This is not as flexible as the more generic functions of the
lower-level printing objects, but exists to provide a quick and easy way
to print out methods in a moderately variable format.

   <p>There are certain rules which should be followed when using the printing
classes.  For a single <code>printpage</code> object, only one <code>printrow</code>
object may exist at any one time.  All <code>printrow</code> objects associated
to a <code>printpage</code> object must be destroyed before starting a new page,
and before destroying the <code>printpage</code> object.  Failure to observe
these rules may result in unusable output.

<ul class="menu">
<li><a accesskey="1" href="#Auxiliary-classes">Auxiliary classes</a>
<li><a accesskey="2" href="#The-printpage-class">The printpage class</a>
<li><a accesskey="3" href="#The-printrow-class">The printrow class</a>
<li><a accesskey="4" href="#Printing-whole-methods">Printing whole methods</a>
<li><a accesskey="5" href="#Printing-in-PostScript">Printing in PostScript</a>
<li><a accesskey="6" href="#Printing-to-PDF-files">Printing to PDF files</a>
</ul>

<div class="node">
<p><hr>
<a name="Auxiliary-classes"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#The-printpage-class">The printpage class</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Producing-printed-output">Producing printed output</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Producing-printed-output">Producing printed output</a>
<br>
</div>

<h3 class="section">8.1 Auxiliary classes</h3>

<p>The printing mechanism of the Ringing Class Library declares several
auxiliary classes, for specifying printing parameters in a device-independent
way.  This section describes those classes.

<ul class="menu">
<li><a accesskey="1" href="#The-dimension-class">The dimension class</a>
<li><a accesskey="2" href="#The-colour-class">The colour class</a>
<li><a accesskey="3" href="#The-text_005fstyle-class">The text_style class</a>
</ul>

<div class="node">
<p><hr>
<a name="The-dimension-class"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#The-colour-class">The colour class</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Auxiliary-classes">Auxiliary classes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Auxiliary-classes">Auxiliary classes</a>
<br>
</div>

<h4 class="subsection">8.1.1 The <code>dimension</code> class</h4>

<p>The <code>dimension</code> class is used extensively by the printing classes
to specify physical dimensions on the page.  The class has three public
data members and one public enumerated type:

<pre class="example">     class dimension {
     public:
       enum units {
         points, inches, cm, mm
       };
     
       int n, d;
       units u;
     }
</pre>
   <p>The integers <code>n</code> and <code>d</code> hold the numerator and denominator
respectively of the dimension.  The member <code>u</code> defines which units
the dimension is given in.  For example, a <code>dimension</code> object
representing three quarters of an inch would have <code>n</code> equal to 3,
<code>d</code> equal to 4, and <code>u</code> equal to <code>dimension::inches</code>. 
Points here are PostScript points, which are equal to 1/72 of an inch.

   <p>The <code>dimension</code> class has several member functions.

<div class="defun">
&mdash; Constructor:  <b>dimension::dimension</b> (<var>void</var>)<var>;<a name="index-dimension_003a_003adimension-301"></a></var><br>
<blockquote><p>This constructs a dimension equal to 0. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>dimension::dimension</b> (<var>int i</var>)<var>;<a name="index-dimension_003a_003adimension-302"></a></var><br>
<blockquote><p>This constructs a dimension equal to <var>i</var> points. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>dimension::dimension</b> (<var>int i, int j, dimension::units u</var>)<var>;<a name="index-dimension_003a_003adimension-303"></a></var><br>
<blockquote><p>This constructs a dimension equal to the fraction <var>i</var>/<var>j</var> in
units <var>u</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: dimension <b>dimension::operator-</b> (<var>void</var>)<var><a name="index-dimension_003a_003aoperator_002d-304"></a></var><br>
<blockquote><p>This operator returns the negation of the dimension. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: dimension&amp; <b>dimension::operator*=</b> (<var>int i</var>)<var><a name="index-dimension_003a_003aoperator_002a_003d-305"></a></var><br>
&mdash; Operator: dimension <b>dimension::operator*</b> (<var>int i</var>)<var><a name="index-dimension_003a_003aoperator_002a-306"></a></var><br>
<blockquote><p>These operators multiply the dimension by the integer <var>i</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: dimension&amp; <b>dimension::operator/=</b> (<var>int i</var>)<var><a name="index-dimension_003a_003aoperator_002f_003d-307"></a></var><br>
&mdash; Operator: dimension <b>dimension::operator/</b> (<var>int i</var>)<var><a name="index-dimension_003a_003aoperator_002f-308"></a></var><br>
<blockquote><p>These operators divide the dimension by the integer <var>i</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Operator: bool <b>dimension::operator==</b> (<var>int i</var>)<var>;<a name="index-dimension_003a_003aoperator_003d_003d-309"></a></var><br>
&mdash; Operator: bool <b>dimension::operator!=</b> (<var>int i</var>)<var>;<a name="index-dimension_003a_003aoperator_0021_003d-310"></a></var><br>
<blockquote><p>These operators are only useful for comparing a dimension to 0. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>dimension::reduce</b> (<var>void</var>)<var>;<a name="index-dimension_003a_003areduce-311"></a></var><br>
<blockquote><p>This function reduces the fraction <code>n</code>/<code>d</code> to lowest terms. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: float <b>dimension::in_points</b> (<var>void</var>)<var>;<a name="index-dimension_003a_003ain_005fpoints-312"></a></var><br>
<blockquote><p>This returns a floating point numbers representing the dimension in
points. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>dimension::set_float</b> (<var>float value, int denom, units uu=points</var>)<var>;<a name="index-dimension_003a_003aset_005ffloat-313"></a></var><br>
<blockquote><p>This function sets the dimension to an approximation of the given
floating-point number <var>value</var>.  Specifically, the denominator is set
to <var>denom</var>, and the numerator is set to the integer closest to
the product of <var>value</var> and <var>denom</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>dimension::read</b> (<var>const string&amp; s</var>)<var>;<a name="index-dimension_003a_003aread-314"></a></var><br>
&mdash; Function: void <b>dimension::read</b> (<var>const char* s</var>)<var>;<a name="index-dimension_003a_003aread-315"></a></var><br>
<blockquote><p>These functions read a dimension from a string.  The string should contain
following parts:
          <ul>
<li>An optional minus sign;

          <li>a number, in either decimal format or as a fraction;

          <li>the units. 
</ul>

        <p>For example, the following strings would all be recognised: <span class="samp">0.4 cm</span>;
<span class="samp">1 1/2"</span>, <span class="samp">56 pt</span>.  The allowed unit names are <span class="samp">pt</span>,
<span class="samp">points</span>, <span class="samp">point</span>, <span class="samp">in</span>, <span class="samp">inch</span>, <span class="samp">inches</span>,
<span class="samp">"</span>, <span class="samp">cm</span>, <span class="samp">mm</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: string&amp; <b>dimension::write</b> (<var>string&amp; s</var>)<var>;<a name="index-dimension_003a_003awrite-316"></a></var><br>
<blockquote><p>This function writes the dimension to the string <var>s</var>. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="The-colour-class"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#The-text_005fstyle-class">The text_style class</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-dimension-class">The dimension class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Auxiliary-classes">Auxiliary classes</a>
<br>
</div>

<h4 class="subsection">8.1.2 The <code>colour</code> class</h4>

<p>The <code>colour</code> class is a structure which represents a colour.  It
is defined thus:

<pre class="example">     struct colour { bool grey; float red, green, blue; };
</pre>
   <p>The red-green-blue (<acronym>RGB</acronym>) colour space is used to specify
colours.  This is not particularly well suited to printing, where a
subtractive colour model such as <acronym>CMYK</acronym> is more useful, but
<acronym>RGB</acronym> is at least very widely used.  Colours printed using the
Ringing Class Library will probably vary quite a lot from one device to
another, but your blue lines will be blue and your red lines will be
red.

   <p>To specify a colour in a <code>colour</code> object, simply set <code>grey</code> to
<code>false</code> and set the other three members to numbers between 0 and 1,
inclusive.  You can also specify a shade of grey by setting <code>grey</code> to
<code>true</code>; then the <code>red</code> element specifies the shade of grey, from
0 (black) to 1 (white).

<div class="node">
<p><hr>
<a name="The-text_005fstyle-class"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-colour-class">The colour class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Auxiliary-classes">Auxiliary classes</a>
<br>
</div>

<h4 class="subsection">8.1.3 The <code>text_style</code> class</h4>

<p>The <code>text_style</code> class is a structure which represents a text
style.  It contains a font name, a size in tenths of a point and a
colour.  It also defines an enumerated type which may be used to
describe text alignment.

<pre class="example">     struct text_style {
       string font;
       int size;
       colour col;
       enum alignment { left, right, centre };
     };
</pre>
   <p>Font names are dependent on the output device; as the only output device
currently supported is a PostScript device, the font name should be a
PostScript font name such as <span class="samp">Helvetica-Oblique</span> or <span class="samp">Times-Roman</span>.

<div class="node">
<p><hr>
<a name="The-printpage-class"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#The-printrow-class">The printrow class</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Auxiliary-classes">Auxiliary classes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Producing-printed-output">Producing printed output</a>
<br>
</div>

<h3 class="section">8.2 The <code>printpage</code> class</h3>

<p>The <code>printpage</code> class takes control of producing printed output on
a page.  To start printing, an object of some subclass of
<code>printpage</code> is created, which will handle all further printing. 
For example, to print to a PostScript stream or file, an object of class
<code>printpage_ps</code> would be created.  Once the <code>printpage</code> class
has been created, it can be used to place text directly on the page.  It
can also be used to create <code>printrow</code> objects for printing rows and
lines.

   <p>Note that positions on the page are always measured from the bottom left
corner.

   <p>The <code>printpage</code> class is a pure virtual class:  the only way to create
one is by constructing an object of a derived class.

<div class="defun">
&mdash; Function: void <b>printpage::new_page</b> (<var>void</var>)<var>;<a name="index-printpage_003a_003anew_005fpage-317"></a></var><br>
<blockquote><p>This tells the <code>printpage</code> object to finish printing the current
page and start a new page. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: virtual void <b>printpage::text</b> (<var>const string t, const dimension&amp; x, const dimension&amp; y, text_style::alignment a, const text_style&amp; s</var>)<var>;<a name="index-printpage_003a_003atext-318"></a></var><br>
<blockquote><p>This function places a text string on the page.  The string is given in
<var>t</var> and should consist of printable characters.  The position at
which the string is to be printed, measured from the bottom left corner
of the page, is given by <var>x</var> and <var>y</var>.  The alignment of the text
about this point is given by <var>a</var>, and the text style is given by
<var>s</var>. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="The-printrow-class"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Printing-whole-methods">Printing whole methods</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-printpage-class">The printpage class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Producing-printed-output">Producing printed output</a>
<br>
</div>

<h3 class="section">8.3 The <code>printrow</code> class</h3>

<p>Printing of rows and lines is handled by the <code>printrow</code> class and its
subclasses.  An object of type <code>printrow</code> is created, attached to
a given <code>printpage</code> object.  After the object has been created, it
can be given rows to print.  The rows can be printed in various ways:  the
actual numbers representing the row may or may not be printed, and lines
can be drawn for selected bells.

<ul class="menu">
<li><a accesskey="1" href="#Using-the-printrow-class">Using the printrow class</a>
<li><a accesskey="2" href="#Row-printing-options">Row printing options</a>
</ul>

<div class="node">
<p><hr>
<a name="Using-the-printrow-class"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Row-printing-options">Row printing options</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-printrow-class">The printrow class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-printrow-class">The printrow class</a>
<br>
</div>

<h4 class="subsection">8.3.1 Using the <code>printrow</code> class</h4>

<p>A <code>printrow</code> object is created by one of the following constructors. 
Note that there are certain options which cannot be changed once the
object has been created, so unless the default options are going to be
used it is necessary to use the second form of the constructor.

<div class="defun">
&mdash; Constructor:  <b>printrow::printrow</b> (<var>const printpage&amp; pp</var>)<var>;<a name="index-printrow_003a_003aprintrow-319"></a></var><br>
<blockquote><p>This constructor builds a <code>printrow</code> object associated to the
<code>printpage</code> object given by <var>pp</var>.  The options are initialised
to the default options. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>printrow::printrow</b> (<var>const printpage&amp; pp, const printrow::options&amp; op</var>)<var>;<a name="index-printrow_003a_003aprintrow-320"></a></var><br>
<blockquote><p>This constructor builds a <code>printrow</code> object associated to the
<code>printpage</code> object given by <var>pp</var>, and initialised the options
to <var>op</var>. 
</p></blockquote></div>

   <p>Once the <code>printrow</code> object has been created, it must be positioned
on the page before any rows can be printed.

<div class="defun">
&mdash; Function: void <b>printrow::set_position</b> (<var>const dimension&amp; x, const dimension&amp; y</var>)<var>;<a name="index-printrow_003a_003aset_005fposition-321"></a></var><br>
<blockquote><p>This function sets the position of the <code>printrow</code> object to the given
place on the page, measured from the bottom left.  The position given is
where the first bell of the next row printed will appear. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>printrow::move_position</b> (<var>const dimension&amp; x, const dimension&amp; y</var>)<var>;<a name="index-printrow_003a_003amove_005fposition-322"></a></var><br>
<blockquote><p>This function is like the preceding one, but the position given by <var>x</var>
and <var>y</var> are taken relative to the current position of the <code>printrow</code>
object.  The current position is either the place where the top left bell of
the last column printed appeared, or as set by a <code>set_position</code> or
<code>move_position</code> function call, whichever is more recent. 
</p></blockquote></div>

   <p>Certain options (see <a href="#Row-printing-options">Row printing options</a>) may be changed while the
<code>printrow</code> object exists.

<div class="defun">
&mdash; Function: const printrow::options&amp; <b>printrow::get_options</b> (<var>void</var>)<var>;<a name="index-printrow_003a_003aget_005foptions-323"></a></var><br>
<blockquote><p>This function returns the current options. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>printrow::set_options</b> (<var>const printrow::options&amp; o</var>)<var>;<a name="index-printrow_003a_003aset_005foptions-324"></a></var><br>
<blockquote><p>This function sets the options to those given by <var>o</var>.  Note that
only certain option changes will have any effect once the object has
been constructed. 
</p></blockquote></div>

   <p>After setting the position, rows can be printed.

<div class="defun">
&mdash; Operator: printrow&amp; <b>printrow::operator&lt;&lt;</b> (<var>const printrow&amp; pr, const row&amp; r</var>)<var>;<a name="index-printrow_003a_003aoperator_003c_003c-325"></a></var><br>
<blockquote><p>This operator is used to print a row <var>r</var> using the <code>printrow</code>
object <var>pr</var>.  This prints the numbers of the row if the <code>numbers</code>
flag of the options is set, and also draws the lines for any bells which
have been specified in the options.  The row is printed underneath the
previous row. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>printrow::rule</b> (<var>void</var>)<var>;<a name="index-printrow_003a_003arule-326"></a></var><br>
<blockquote><p>This function draws a horizontal rule below the last row printed. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>printrow::dot</b> (<var>int i</var>)<var>;<a name="index-printrow_003a_003adot-327"></a></var><br>
<blockquote><p>This function draws a small dot at the place where bell <var>i</var> was in the
last row printed.  If <var>i</var> is -1, prints dots for all bells which are
having lines drawn. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>printrow::placebell</b> (<var>int i</var>)<var>;<a name="index-printrow_003a_003aplacebell-328"></a></var><br>
<blockquote><p>This function finds what place the bell <var>i</var> was at in the last row
printed, and then prints this number in a circle to the right of that row. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>printrow::text</b> (<var>const string&amp; t, const dimension&amp; x, text_style::alignment al, bool between, bool right</var>)<var>;<a name="index-printrow_003a_003atext-329"></a></var><br>
<blockquote><p>This function prints some text to one side of the last row printed.  The
text is given in <var>t</var> and is printed in the same style as the rows. 
If the boolean argument <var>right</var> is true, the text is printed to the
right of the row; otherwise the text is printed to the left of the row. 
The dimension <var>x</var> is a distance from the leftmost or rightmost
number in the row, and the text is aligned about this point as given by
<var>al</var> (see <a href="#The-text_005fstyle-class">The text_style class</a>).  If the argument <var>between</var>
is true, then the text is not aligned vertically with the previous row,
but rather appears halfway between the previous row and the next one to
be printed.  This last option is useful, for example, for printing place
notation beside a method. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Row-printing-options"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Using-the-printrow-class">Using the printrow class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-printrow-class">The printrow class</a>
<br>
</div>

<h4 class="subsection">8.3.2 Row printing options</h4>

<p>The way in which rows are printed by a <code>printrow</code> object is
controlled by various options.  These options are given by a
<code>printrow::options</code> object.

<pre class="example">     struct options {
       enum o_flags {
         numbers = 0x01,
         miss_numbers = 0x02
       };
       unsigned int flags;
       text_style style;
       dimension xspace, yspace;
       struct line_style {
         dimension width;
         colour col;
       };
       map&lt;int, line_style&gt; lines;
     
       void defaults(void);
     };
</pre>
   <p>The <code>flags</code> member contains various flags; bit values are given by
the enumerated type <code>o_flags</code>, and possible values for <code>flags</code>
can be obtained by logically ORing these values together.  The bits
are as follows:
     <ul>
<li>The <code>options::numbers</code> bit controls whether the actual numbers of the
rows are printed.  If this bit is not set, only lines will be printed.

     <li>If the <code>options::miss_numbers</code> bit, then any numbers which would
appear underneath lines are missed out.  An example of this may be seen
in the <cite>Ringing World</cite> diary, where all rows except lead heads are
printed with this property. 
</ul>
   This option may be changed, with immediate effect, at any point during
printing.

   <p>The <code>style</code> member controls the style in which the rows are
printed; for the declaration of the <code>text_style</code> class, see
<a href="#The-text_005fstyle-class">The text_style class</a>.  This option may not be changed during printing.

   <p>The <code>xspace</code> and <code>yspace</code> members give the horizontal space
between numbers in a row, and the vertical space between rows, respectively. 
For the declaration of the <code>dimension</code> class, see
<a href="#The-dimension-class">The dimension class</a>.  These options may not be changed during
printing.

   <p>The <code>lines</code> member controls which &ldquo;blue lines&rdquo; are printed.  Each
element of the map has an integer, denoting the bell number, and a
<code>line_style</code> element which defines the style of the line.  The two
members of <code>line_style</code> are a <code>dimension</code> object, giving the
width of the line, and a <code>colour</code> object, giving the colour of the
line.  This option may be changed in between columns, but not in the
middle of a column.

   <p>For example, suppose that we wish to print rows in 10-point Helvetica, with
spacing of 12 points horizontally and vertically.  We want to draw a blue
line half a point thick for the second bell.  The following code sets
up a <code>printrow::options</code> object to accomplish this:

<pre class="example">     printrow::options o;
     o.flags = printrow::options::numbers;
     o.style.size = 100;
     o.style.font = "Helvetica";
     o.xspace.n = 12;
     o.yspace.n = 12;
     line_style s; s.width.n = 1; s.width.d = 2; s.width.u = dimension::points;
     s.col.grey = false; s.col.red = 0; s.col.green = 0; s.col.blue = 1.0;
     o.lines[1] = s;
</pre>
   <p>There is one member function of <code>printrow::options</code>.

<div class="defun">
&mdash; Function: void <b>printrow::options::defaults</b> (<var>void</var>)<var>;<a name="index-printrow_003a_003aoptions_003a_003adefaults-330"></a></var><br>
<blockquote><p>This function sets up the <code>printrow::options</code> object to the defaults
as given in the example above. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Printing-whole-methods"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Printing-in-PostScript">Printing in PostScript</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-printrow-class">The printrow class</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Producing-printed-output">Producing printed output</a>
<br>
</div>

<h3 class="section">8.4 Printing whole methods</h3>

<p>It should be reasonably clear how the <code>printrow</code> object might be
used to print out numbers and lines for a method.  This simple but
tedious task is automated by the <code>printmethod</code> object.  The
<code>printmethod</code> object is not designed to be as flexible as the rest
of the printing mechanism, but rather to accomplish its one aim, that of
printing out methods, in as simple a way as possible.

   <p>The appearance of the printed method is controlled by setting the public
data members of the <code>printmethod</code> object.  When all the parameters
have been set up, the function <code>printmethod::print()</code> is used to
print the method to a given <code>printpage</code> object.

   <p>The output consists of a series of <dfn>columns</dfn>, each of which contains
the same number of rows.  When one column is full, a new column is
started to the right of the last one.  A number of columns, side by
side, are called a <dfn>column set</dfn>.  When one column set is complete, a
new column set is started below the last.  Whenever a new column is
started, the last row of the previous column is duplicated at the top of
the new column.

<ul class="menu">
<li><a accesskey="1" href="#Method-printing-parameters">Method printing parameters</a>
<li><a accesskey="2" href="#Using-the-printmethod-object">Using the printmethod object</a>
</ul>

<div class="node">
<p><hr>
<a name="Method-printing-parameters"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Using-the-printmethod-object">Using the printmethod object</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Printing-whole-methods">Printing whole methods</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Printing-whole-methods">Printing whole methods</a>
<br>
</div>

<h4 class="subsection">8.4.1 Method printing parameters</h4>

<p>The <code>printmethod</code> object has many public data members, which
control the format of the printed method.  These public data members are
described here.

<div class="defun">
&mdash; Variable: printrow::options <b>printmethod::opt</b><var><a name="index-printmethod_003a_003aopt-331"></a></var><br>
<blockquote><p>This member contains the options which are used to print each separate
row of the method.  For more information on this object, see <a href="#Row-printing-options">Row printing options</a>.  Note that the <code>miss_numbers</code> flag is overridden
by the setting of the <code>number_mode</code> member of the
<code>printmethod</code> object (see below). 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: dimension <b>printmethod::hgap</b><var><a name="index-printmethod_003a_003ahgap-332"></a></var><br>
&mdash; Variable: dimension <b>printmethod::vgap</b><var><a name="index-printmethod_003a_003avgap-333"></a></var><br>
<blockquote><p>These two members control the horizontal gap between columns, and the
vertical gap between column sets, respectively.  For more information on
the <code>dimension</code> class, see <a href="#The-dimension-class">The dimension class</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: int <b>printmethod::total_rows</b><var><a name="index-printmethod_003a_003atotal_005frows-334"></a></var><br>
<blockquote><p>This integer sets the total number of rows which will be printed.  This
total does not count those rows which are duplicated because they appear
at the end of a column. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: int <b>printmethod::rows_per_column</b><var><a name="index-printmethod_003a_003arows_005fper_005fcolumn-335"></a></var><br>
<blockquote><p>This integer controls the number of rows printed in each column.  In
fact each column will contain one more than this number of rows, because
the last row of each column is duplicated at the top of the next column. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: int <b>printmethod::columns_per_set</b><var><a name="index-printmethod_003a_003acolumns_005fper_005fset-336"></a></var><br>
<blockquote><p>This integer controls the number of columns which appear in each
horizontal column set, that is, the number of columns across the printed
output. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: int <b>printmethod::sets_per_page</b><var><a name="index-printmethod_003a_003asets_005fper_005fpage-337"></a></var><br>
<blockquote><p>This integer controls the number of column sets which appear on each
page, that is, the number of columns down the printed page.  If the total
number of columns printed exceeds this numbers, more than one page of
output will be produced. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: dimension <b>printmethod::xoffset</b><var><a name="index-printmethod_003a_003axoffset-338"></a></var><br>
&mdash; Variable: dimension <b>printmethod::yoffset</b><var><a name="index-printmethod_003a_003ayoffset-339"></a></var><br>
<blockquote><p>These two members position the output on the page.  Together, they
contain the position of the top left bell of the top left column of the
output. measured from the bottom left hand corner of the page.  For more
information on the <code>dimension</code> class, see <a href="#The-dimension-class">The dimension class</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: list&lt;pair&lt;int, int&gt; &gt; <b>printmethod::rules</b><var><a name="index-printmethod_003a_003arules-340"></a></var><br>
<blockquote><p>This member controls the printing of horizontal rules in the output. 
Each entry in the list is a pair (<var>a</var>, <var>b</var>) of integers; this
entry means that a rule will be drawn after the <var>a</var>th row in each
lead, and every <var>b</var> rows after that.  For example, the usual setting
for a treble dodging method would be the pair (4,4), indicating that
rules should be drawn every four rows, starting with a rule after the
fourth row.  Similarly the usual setting for Stedman would be the pair
(3,6). 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: printmethod::number_mode_t <b>printmethod::number_mode</b><var><a name="index-printmethod_003a_003anumber_005fmode-341"></a></var><br>
<blockquote><p>This member sets the behaviour with regard to missing numbers underneath
lines.  There are four possible settings, described by an enumerated
type:
     <pre class="example">          enum number_mode_t { miss_never, miss_always,
                                miss_column, miss_lead };
     </pre>
        <p>The meaning of these options is as follows:

          <ul>
<li><code>miss_never</code>: numbers are always drawn;
<li><code>miss_always</code>: numbers are never drawn when they appear
underneath a line;
<li><code>miss_column</code>: numbers are only drawn underneath lines in the
first and last rows of a column;
<li><code>miss_lead</code>: numbers are only drawn underneath lines at lead
heads. 
</ul>
        </p></blockquote></div>

<div class="defun">
&mdash; Variable: printmethod::pn_mode_t <b>printmethod::pn_mode</b><var><a name="index-printmethod_003a_003apn_005fmode-342"></a></var><br>
<blockquote><p>This member controls the printing of place notation next to the method. 
There are three possible settings, described by an enumerated type:
     <pre class="example">          enum pn_mode_t { pn_none, pn_first, pn_all };
     </pre>
        <p>These options are interpreted as follows:

          <ul>
<li><code>pn_none</code>: place notation is never printed;
<li><code>pn_first</code>: place notation is printed to the left of the
first lead of the method and, if the method is symmetrical about the
half lead, only the first half of the place notation and the lead end
are printed;
<li><code>pn_all</code>: full place notation is printed to the left of every
lead. 
</ul>
        </p></blockquote></div>

<div class="defun">
&mdash; Variable: int <b>printmethod::placebells</b><var><a name="index-printmethod_003a_003aplacebells-343"></a></var><br>
<blockquote><p>This integer controls whether place bells are printed, and for which
bell.  If this member contains an integer greater than or equal to zero,
then place bells are printed for the corresponding bell.  To suppress
the printing of place bells, set this member to <code>-1</code>. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Using-the-printmethod-object"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Method-printing-parameters">Method printing parameters</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Printing-whole-methods">Printing whole methods</a>
<br>
</div>

<h4 class="subsection">8.4.2 Using the <code>printmethod</code> object</h4>

<p>Before printing a method using a <code>printmethod</code> object, two things
must be set up:  the object must be given a method to print, and the
parameters for printing described in the previous section must be
initialised.

   <p>The class has two constructors:

<div class="defun">
&mdash; Constructor:  <b>printmethod::printmethod</b> (<var>void</var>)<var>;<a name="index-printmethod_003a_003aprintmethod-344"></a></var><br>
&mdash; Constructor:  <b>printmethod::printmethod</b> (<var>const method&amp; m</var>)<var>;<a name="index-printmethod_003a_003aprintmethod-345"></a></var><br>
<blockquote><p>These two constructors create a <code>printmethod</code> object.  In the first
case, no method is specified; a method will have to be given later,
before anything can be printed.  In the second case, a reference to the
method <var>m</var> is stored for printing after the parameters have been set
up. 
</p></blockquote></div>

   <p>After the object has been created, the method can be queried and changed
with these functions:

<div class="defun">
&mdash; Function: const method&amp; <b>printmethod::get_method</b> (<var>void</var>)<var>;<a name="index-printmethod_003a_003aget_005fmethod-346"></a></var><br>
<blockquote><p>This returns the method referred to by this <code>printmethod</code> object. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>printmethod::set_method</b> (<var>const method&amp; m</var>)<var>;<a name="index-printmethod_003a_003aset_005fmethod-347"></a></var><br>
<blockquote><p>This function stored a reference to the method <var>m</var> in the
<code>printmethod</code> object, for subsequence printing. 
</p></blockquote></div>

   <p>The parameters for printing, described in the previous section, may be
manipulated with several member functions.

<div class="defun">
&mdash; Function: void <b>printmethod::defaults</b> (<var>void</var>)<var>;<a name="index-printmethod_003a_003adefaults-348"></a></var><br>
<blockquote><p>This function sets the parameters to default values, which relate to the
method to be printed; so it should not be called before a method has
been given to the <code>printmethod</code> object.  Specifically, the
parameters are set as follows:

          <ul>
<li>Numbers are to be printed in 10-point Helvetica, and the spacing
between bells is 12 points both horizontally and vertically;
<li>Each column contains a single lead; an entire plain course of the
method will be printed, with leads side by side;
<li>The output is positioned at the bottom left of the page;
<li>Numbers will be missed underneath lines, except for lead heads;
<li>Place notation will be printed to the left of the first lead only;
<li>Each hunt bell is shown with a red line, a quarter of a point
thick;
<li>The smallest working bell which makes a place over the lead end is
shown with a blue line, half a point thick, and place bells are shown
for this bell.  If no working bell makes a place over the lead end, the
smallest working bell is chosen instead. 
</ul>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>printmethod::fit_to_space</b> (<var>const dimension&amp; width, const dimension&amp; height, bool vgap_mode, float aspect</var>)<var>;<a name="index-printmethod_003a_003afit_005fto_005fspace-349"></a></var><br>
<blockquote><p>This function scales and arranges the method to fit in the given space,
as specified by <var>width</var> and <var>height</var>.  The parameters which are
calculated by this function are <code>rows_per_column</code>,
<code>columns_per_set</code>, <code>hgap</code>, <code>vgap</code>, <code>opt.style.size</code>,
<code>opt.xspace</code> and <code>opt.yspace</code>.  Two possible layouts are
possible: if <var>vgap_mode</var> is <code>false</code>, then only one column set
is used, with each column containing a whole number of leads; if
<var>vgap_mode</var> is <code>true</code>, then each column contains precisely one
lead, and as many column sets as necessary are used.  The effect of this
is that, in the first case, the second lead appears below the first one;
in the second case, the second lead appears to the right of the first
one.  The last argument <var>aspect</var> sets the ratio of <code>opt.xspace</code>
to <code>opt.yspace</code>.

        <p>The chosen layout is that which, given the constraints specified, allows
the largest of output. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: float <b>printmethod::total_width</b> (<var>void</var>)<var>;<a name="index-printmethod_003a_003atotal_005fwidth-350"></a></var><br>
&mdash; Function: float <b>printmethod::total_height</b> (<var>void</var>)<var>;<a name="index-printmethod_003a_003atotal_005fheight-351"></a></var><br>
<blockquote><p>These functions give the total width and height, respectively, in points
of the printed output using the current parameters. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Printing-in-PostScript"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Printing-to-PDF-files">Printing to PDF files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Printing-whole-methods">Printing whole methods</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Producing-printed-output">Producing printed output</a>
<br>
</div>

<h3 class="section">8.5 Printing in PostScript</h3>

<p>The Ringing Class Library provides subclasses of the <code>printpage</code> and
<code>printrow</code> classes for producing output in the PostScript language. 
These classes are declared in the <span class="file">ringing/print_ps.h</span> header file. 
The output conforms to the Document Structuring Conventions (<acronym>DSC</acronym>)
version 3.0 and uses only Level 1 language.

   <p>The <code>printpage_ps</code> class is derived from <code>printpage</code>, and handles
all output to a PostScript stream.  The new functions in this class are
constructors and some PostScript-specific operations.

<div class="defun">
&mdash; Constructor:  <b>printpage_ps::printpage_ps</b> (<var>ostream&amp; o</var>)<var>;<a name="index-printpage_005fps_003a_003aprintpage_005fps-352"></a></var><br>
<blockquote><p>This creates a new PostScript printing object, which will send its
output to the stream <var>o</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>printpage_ps::printpage_ps</b> (<var>ostream&amp; o, const dimension&amp; page_height</var>)<var>;<a name="index-printpage_005fps_003a_003aprintpage_005fps-353"></a></var><br>
<blockquote><p>This creates a new PostScript printing object, which will send its output
to the stream <var>o</var>.  Each page will be printed with landscape orientation;
because of the way PostScript works, this means that the page height must
be given. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>printpage_ps::printpage_ps</b> (<var>ostream o, int x0, int y0, int x1, int y1</var>)<var>;<a name="index-printpage_005fps_003a_003aprintpage_005fps-354"></a></var><br>
<blockquote><p>This creates a new object which will write an Encapsulated PostScript
(<acronym>EPS</acronym>) file to the stream <var>o</var>.  The bounding box for the
<acronym>EPS</acronym> file is specified in points by the arguments <var>x0</var>, <var>y0</var>,
<var>x1</var> and <var>y1</var>.  This bounding box has no effect on where you can
print things using this object, but other applications manipulating the
<acronym>EPS</acronym> file may rely on the bounding box in order to work properly. 
</p></blockquote></div>

   <p>The <code>printrow_ps</code> class is for printing rows to a <code>printpage_ps</code>
object.  You will probably never have to deal with this class directly, as
it should be created and dealt with by the interface for the <code>printrow</code>
class.

<div class="node">
<p><hr>
<a name="Printing-to-PDF-files"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Printing-in-PostScript">Printing in PostScript</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Producing-printed-output">Producing printed output</a>
<br>
</div>

<h3 class="section">8.6 Printing to <acronym>PDF</acronym> files</h3>

<p>Subclasses of the <code>printpage</code> and <code>printrow</code> classes are also
provided for providing output in Adobe Portable Document Format
(<acronym>PDF</acronym>).  These classes are declared in the <code>print_pdf.h</code>
header file.

   <p>Some specific issues must be considered when creating <acronym>PDF</acronym>
files.  Firstly, although the classes support output to an arbitrary
stream, some care must be taken.  This is because <acronym>PDF</acronym> files
contain tables which cross-reference different parts of the file; and
these tables therefore contain byte offsets into the file.  If you use
the <acronym>PDF</acronym> printing classes to write to a text-mode file on some
system, such as Microsoft Windows, which convert single line feeds to
carriage-return and line-feed pairs, then this byte count will be
incorrect.  The safe way round this is to <strong>always open
<acronym>PDF</acronym> output streams in binary mode</strong>.

   <p>The second specific issue which arises when creating a <acronym>PDF</acronym>
file is that of fonts.  In order to position text correctly on the page,
the class library needs to know the metrics of every character in each
font used.  As a result, it is only possible to use the standard 14
<acronym>PDF</acronym> fonts when printing from the Ringing Class Library.  These
standard fonts are:
     <ul>
<li>Courier, Courier-Bold, Courier-Oblique, Courier-BoldOblique

     <li>Helvetica, Helvetica-Bold, Helvetica-Oblique, Helvetica-BoldOblique

     <li>Times-Roman, Times-Bold, Times-Italic, Times-BoldItalic

     <li>Symbol

     <li>ZapfDingbats
</ul>

   <p>The <code>printpage_pdf</code> class is derived from <code>printpage</code>.  The only
new functions defined in this class are its two constructors:

<div class="defun">
&mdash; Constructor:  <b>printpage_pdf::printpage_pdf</b> (<var>ostream&amp; o, const dimension&amp; width, const dimension&amp; height, bool l=false</var>)<var>;<a name="index-printpage_005fpdf_003a_003aprintpage_005fpdf-355"></a></var><br>
<blockquote><p>This constructor creates an object for writing a <acronym>PDF</acronym> file to the
output stream <var>o</var>.  The page width and height are set to <var>width</var> and
<var>height</var> respectively.  If the Boolean parameter <var>l</var> is set,
the page will be printed in landscape format. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor:  <b>printpage_pdf::printpage_pdf</b> (<var>ostream&amp; o, bool l=false</var>)<var>;<a name="index-printpage_005fpdf_003a_003aprintpage_005fpdf-356"></a></var><br>
<blockquote><p>This constructor works as the previous one, but the page size is set to A4. 
</p></blockquote></div>

   <p>The subclass of <code>printrow</code> for printing to a <acronym>PDF</acronym> file is called
<code>printrow_pdf</code>; but as an object of this class will always be created
through the parent <code>printpage</code> object, the programmer should never
need to deal with the <code>printrow_pdf</code> class.

<div class="node">
<p><hr>
<a name="Copying-this-manual"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Index">Index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Producing-printed-output">Producing printed output</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="appendix">Appendix A Copying this manual</h2>

<ul class="menu">
<li><a accesskey="1" href="#GNU-Free-Documentation-License">GNU Free Documentation License</a>
</ul>

<div class="node">
<p><hr>
<a name="GNU-Free-Documentation-License"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Copying-this-manual">Copying this manual</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Copying-this-manual">Copying this manual</a>
<br>
</div>

<h3 class="appendixsec">A.1 GNU Free Documentation License</h3>

<p><a name="index-FDL_002c-GNU-Free-Documentation-License-357"></a><div align="center">Version 1.1, March 2000</div>

<pre class="display">     Copyright &copy; 2000 Free Software Foundation, Inc.
     59 Temple Place, Suite 330, Boston, MA  02111-1307, USA
     
     Everyone is permitted to copy and distribute verbatim copies
     of this license document, but changing it is not allowed.
</pre>
     <ol type=1 start=0>
<li>PREAMBLE

     <p>The purpose of this License is to make a manual, textbook, or other
written document <dfn>free</dfn> in the sense of freedom: to assure everyone
the effective freedom to copy and redistribute it, with or without
modifying it, either commercially or noncommercially.  Secondarily,
this License preserves for the author and publisher a way to get
credit for their work, while not being considered responsible for
modifications made by others.

     <p>This License is a kind of &ldquo;copyleft&rdquo;, which means that derivative
works of the document must themselves be free in the same sense.  It
complements the GNU General Public License, which is a copyleft
license designed for free software.

     <p>We have designed this License in order to use it for manuals for free
software, because free software needs free documentation: a free
program should come with manuals providing the same freedoms that the
software does.  But this License is not limited to software manuals;
it can be used for any textual work, regardless of subject matter or
whether it is published as a printed book.  We recommend this License
principally for works whose purpose is instruction or reference.

     <li>APPLICABILITY AND DEFINITIONS

     <p>This License applies to any manual or other work that contains a
notice placed by the copyright holder saying it can be distributed
under the terms of this License.  The &ldquo;Document&rdquo;, below, refers to any
such manual or work.  Any member of the public is a licensee, and is
addressed as &ldquo;you&rdquo;.

     <p>A &ldquo;Modified Version&rdquo; of the Document means any work containing the
Document or a portion of it, either copied verbatim, or with
modifications and/or translated into another language.

     <p>A &ldquo;Secondary Section&rdquo; is a named appendix or a front-matter section of
the Document that deals exclusively with the relationship of the
publishers or authors of the Document to the Document's overall subject
(or to related matters) and contains nothing that could fall directly
within that overall subject.  (For example, if the Document is in part a
textbook of mathematics, a Secondary Section may not explain any
mathematics.)  The relationship could be a matter of historical
connection with the subject or with related matters, or of legal,
commercial, philosophical, ethical or political position regarding
them.

     <p>The &ldquo;Invariant Sections&rdquo; are certain Secondary Sections whose titles
are designated, as being those of Invariant Sections, in the notice
that says that the Document is released under this License.

     <p>The &ldquo;Cover Texts&rdquo; are certain short passages of text that are listed,
as Front-Cover Texts or Back-Cover Texts, in the notice that says that
the Document is released under this License.

     <p>A &ldquo;Transparent&rdquo; copy of the Document means a machine-readable copy,
represented in a format whose specification is available to the
general public, whose contents can be viewed and edited directly and
straightforwardly with generic text editors or (for images composed of
pixels) generic paint programs or (for drawings) some widely available
drawing editor, and that is suitable for input to text formatters or
for automatic translation to a variety of formats suitable for input
to text formatters.  A copy made in an otherwise Transparent file
format whose markup has been designed to thwart or discourage
subsequent modification by readers is not Transparent.  A copy that is
not &ldquo;Transparent&rdquo; is called &ldquo;Opaque&rdquo;.

     <p>Examples of suitable formats for Transparent copies include plain
<span class="sc">ascii</span> without markup, Texinfo input format, LaTeX input format,
<acronym>SGML</acronym> or <acronym>XML</acronym> using a publicly available
<acronym>DTD</acronym>, and standard-conforming simple <acronym>HTML</acronym> designed
for human modification.  Opaque formats include PostScript,
<acronym>PDF</acronym>, proprietary formats that can be read and edited only by
proprietary word processors, <acronym>SGML</acronym> or <acronym>XML</acronym> for which
the <acronym>DTD</acronym> and/or processing tools are not generally available,
and the machine-generated <acronym>HTML</acronym> produced by some word
processors for output purposes only.

     <p>The &ldquo;Title Page&rdquo; means, for a printed book, the title page itself,
plus such following pages as are needed to hold, legibly, the material
this License requires to appear in the title page.  For works in
formats which do not have any title page as such, &ldquo;Title Page&rdquo; means
the text near the most prominent appearance of the work's title,
preceding the beginning of the body of the text.

     <li>VERBATIM COPYING

     <p>You may copy and distribute the Document in any medium, either
commercially or noncommercially, provided that this License, the
copyright notices, and the license notice saying this License applies
to the Document are reproduced in all copies, and that you add no other
conditions whatsoever to those of this License.  You may not use
technical measures to obstruct or control the reading or further
copying of the copies you make or distribute.  However, you may accept
compensation in exchange for copies.  If you distribute a large enough
number of copies you must also follow the conditions in section 3.

     <p>You may also lend copies, under the same conditions stated above, and
you may publicly display copies.

     <li>COPYING IN QUANTITY

     <p>If you publish printed copies of the Document numbering more than 100,
and the Document's license notice requires Cover Texts, you must enclose
the copies in covers that carry, clearly and legibly, all these Cover
Texts: Front-Cover Texts on the front cover, and Back-Cover Texts on
the back cover.  Both covers must also clearly and legibly identify
you as the publisher of these copies.  The front cover must present
the full title with all words of the title equally prominent and
visible.  You may add other material on the covers in addition. 
Copying with changes limited to the covers, as long as they preserve
the title of the Document and satisfy these conditions, can be treated
as verbatim copying in other respects.

     <p>If the required texts for either cover are too voluminous to fit
legibly, you should put the first ones listed (as many as fit
reasonably) on the actual cover, and continue the rest onto adjacent
pages.

     <p>If you publish or distribute Opaque copies of the Document numbering
more than 100, you must either include a machine-readable Transparent
copy along with each Opaque copy, or state in or with each Opaque copy
a publicly-accessible computer-network location containing a complete
Transparent copy of the Document, free of added material, which the
general network-using public has access to download anonymously at no
charge using public-standard network protocols.  If you use the latter
option, you must take reasonably prudent steps, when you begin
distribution of Opaque copies in quantity, to ensure that this
Transparent copy will remain thus accessible at the stated location
until at least one year after the last time you distribute an Opaque
copy (directly or through your agents or retailers) of that edition to
the public.

     <p>It is requested, but not required, that you contact the authors of the
Document well before redistributing any large number of copies, to give
them a chance to provide you with an updated version of the Document.

     <li>MODIFICATIONS

     <p>You may copy and distribute a Modified Version of the Document under
the conditions of sections 2 and 3 above, provided that you release
the Modified Version under precisely this License, with the Modified
Version filling the role of the Document, thus licensing distribution
and modification of the Modified Version to whoever possesses a copy
of it.  In addition, you must do these things in the Modified Version:

          <ol type=A start=1>
<li>Use in the Title Page (and on the covers, if any) a title distinct
from that of the Document, and from those of previous versions
(which should, if there were any, be listed in the History section
of the Document).  You may use the same title as a previous version
if the original publisher of that version gives permission.

          <li>List on the Title Page, as authors, one or more persons or entities
responsible for authorship of the modifications in the Modified
Version, together with at least five of the principal authors of the
Document (all of its principal authors, if it has less than five).

          <li>State on the Title page the name of the publisher of the
Modified Version, as the publisher.

          <li>Preserve all the copyright notices of the Document.

          <li>Add an appropriate copyright notice for your modifications
adjacent to the other copyright notices.

          <li>Include, immediately after the copyright notices, a license notice
giving the public permission to use the Modified Version under the
terms of this License, in the form shown in the Addendum below.

          <li>Preserve in that license notice the full lists of Invariant Sections
and required Cover Texts given in the Document's license notice.

          <li>Include an unaltered copy of this License.

          <li>Preserve the section entitled &ldquo;History&rdquo;, and its title, and add to
it an item stating at least the title, year, new authors, and
publisher of the Modified Version as given on the Title Page.  If
there is no section entitled &ldquo;History&rdquo; in the Document, create one
stating the title, year, authors, and publisher of the Document as
given on its Title Page, then add an item describing the Modified
Version as stated in the previous sentence.

          <li>Preserve the network location, if any, given in the Document for
public access to a Transparent copy of the Document, and likewise
the network locations given in the Document for previous versions
it was based on.  These may be placed in the &ldquo;History&rdquo; section. 
You may omit a network location for a work that was published at
least four years before the Document itself, or if the original
publisher of the version it refers to gives permission.

          <li>In any section entitled &ldquo;Acknowledgments&rdquo; or &ldquo;Dedications&rdquo;,
preserve the section's title, and preserve in the section all the
substance and tone of each of the contributor acknowledgments
and/or dedications given therein.

          <li>Preserve all the Invariant Sections of the Document,
unaltered in their text and in their titles.  Section numbers
or the equivalent are not considered part of the section titles.

          <li>Delete any section entitled &ldquo;Endorsements&rdquo;.  Such a section
may not be included in the Modified Version.

          <li>Do not retitle any existing section as &ldquo;Endorsements&rdquo;
or to conflict in title with any Invariant Section.
          </ol>

     <p>If the Modified Version includes new front-matter sections or
appendices that qualify as Secondary Sections and contain no material
copied from the Document, you may at your option designate some or all
of these sections as invariant.  To do this, add their titles to the
list of Invariant Sections in the Modified Version's license notice. 
These titles must be distinct from any other section titles.

     <p>You may add a section entitled &ldquo;Endorsements&rdquo;, provided it contains
nothing but endorsements of your Modified Version by various
parties&mdash;for example, statements of peer review or that the text has
been approved by an organization as the authoritative definition of a
standard.

     <p>You may add a passage of up to five words as a Front-Cover Text, and a
passage of up to 25 words as a Back-Cover Text, to the end of the list
of Cover Texts in the Modified Version.  Only one passage of
Front-Cover Text and one of Back-Cover Text may be added by (or
through arrangements made by) any one entity.  If the Document already
includes a cover text for the same cover, previously added by you or
by arrangement made by the same entity you are acting on behalf of,
you may not add another; but you may replace the old one, on explicit
permission from the previous publisher that added the old one.

     <p>The author(s) and publisher(s) of the Document do not by this License
give permission to use their names for publicity for or to assert or
imply endorsement of any Modified Version.

     <li>COMBINING DOCUMENTS

     <p>You may combine the Document with other documents released under this
License, under the terms defined in section 4 above for modified
versions, provided that you include in the combination all of the
Invariant Sections of all of the original documents, unmodified, and
list them all as Invariant Sections of your combined work in its
license notice.

     <p>The combined work need only contain one copy of this License, and
multiple identical Invariant Sections may be replaced with a single
copy.  If there are multiple Invariant Sections with the same name but
different contents, make the title of each such section unique by
adding at the end of it, in parentheses, the name of the original
author or publisher of that section if known, or else a unique number. 
Make the same adjustment to the section titles in the list of
Invariant Sections in the license notice of the combined work.

     <p>In the combination, you must combine any sections entitled &ldquo;History&rdquo;
in the various original documents, forming one section entitled
&ldquo;History&rdquo;; likewise combine any sections entitled &ldquo;Acknowledgments&rdquo;,
and any sections entitled &ldquo;Dedications&rdquo;.  You must delete all sections
entitled &ldquo;Endorsements.&rdquo;

     <li>COLLECTIONS OF DOCUMENTS

     <p>You may make a collection consisting of the Document and other documents
released under this License, and replace the individual copies of this
License in the various documents with a single copy that is included in
the collection, provided that you follow the rules of this License for
verbatim copying of each of the documents in all other respects.

     <p>You may extract a single document from such a collection, and distribute
it individually under this License, provided you insert a copy of this
License into the extracted document, and follow this License in all
other respects regarding verbatim copying of that document.

     <li>AGGREGATION WITH INDEPENDENT WORKS

     <p>A compilation of the Document or its derivatives with other separate
and independent documents or works, in or on a volume of a storage or
distribution medium, does not as a whole count as a Modified Version
of the Document, provided no compilation copyright is claimed for the
compilation.  Such a compilation is called an &ldquo;aggregate&rdquo;, and this
License does not apply to the other self-contained works thus compiled
with the Document, on account of their being thus compiled, if they
are not themselves derivative works of the Document.

     <p>If the Cover Text requirement of section 3 is applicable to these
copies of the Document, then if the Document is less than one quarter
of the entire aggregate, the Document's Cover Texts may be placed on
covers that surround only the Document within the aggregate. 
Otherwise they must appear on covers around the whole aggregate.

     <li>TRANSLATION

     <p>Translation is considered a kind of modification, so you may
distribute translations of the Document under the terms of section 4. 
Replacing Invariant Sections with translations requires special
permission from their copyright holders, but you may include
translations of some or all Invariant Sections in addition to the
original versions of these Invariant Sections.  You may include a
translation of this License provided that you also include the
original English version of this License.  In case of a disagreement
between the translation and the original English version of this
License, the original English version will prevail.

     <li>TERMINATION

     <p>You may not copy, modify, sublicense, or distribute the Document except
as expressly provided for under this License.  Any other attempt to
copy, modify, sublicense or distribute the Document is void, and will
automatically terminate your rights under this License.  However,
parties who have received copies, or rights, from you under this
License will not have their licenses terminated so long as such
parties remain in full compliance.

     <li>FUTURE REVISIONS OF THIS LICENSE

     <p>The Free Software Foundation may publish new, revised versions
of the GNU Free Documentation License from time to time.  Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns.  See
<a href="http://www.gnu.org/copyleft/">http://www.gnu.org/copyleft/</a>.

     <p>Each version of the License is given a distinguishing version number. 
If the Document specifies that a particular numbered version of this
License &ldquo;or any later version&rdquo; applies to it, you have the option of
following the terms and conditions either of that specified version or
of any later version that has been published (not as a draft) by the
Free Software Foundation.  If the Document does not specify a version
number of this License, you may choose any version ever published (not
as a draft) by the Free Software Foundation.
        </ol>

<h4 class="appendixsubsec">A.1.1 ADDENDUM: How to use this License for your documents</h4>

<p>To use this License in a document you have written, include a copy of
the License in the document and put the following copyright and
license notices just after the title page:

<pre class="smallexample">       Copyright (C)  <var>year</var>  <var>your name</var>.
       Permission is granted to copy, distribute and/or modify this document
       under the terms of the GNU Free Documentation License, Version 1.1
       or any later version published by the Free Software Foundation;
       with the Invariant Sections being <var>list their titles</var>, with the
       Front-Cover Texts being <var>list</var>, and with the Back-Cover Texts being <var>list</var>.
       A copy of the license is included in the section entitled ``GNU
       Free Documentation License''.
</pre>
   <p>If you have no Invariant Sections, write &ldquo;with no Invariant Sections&rdquo;
instead of saying which ones are invariant.  If you have no
Front-Cover Texts, write &ldquo;no Front-Cover Texts&rdquo; instead of
&ldquo;Front-Cover Texts being <var>list</var>&rdquo;; likewise for Back-Cover Texts.

   <p>If your document contains nontrivial examples of program code, we
recommend releasing these examples in parallel under your choice of
free software license, such as the GNU General Public License,
to permit their use in free software.

<!-- Local Variables: -->
<!-- ispell-local-pdict: "ispell-dict" -->
<!-- End: -->
<div class="node">
<p><hr>
<a name="Index"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Copying-this-manual">Copying this manual</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="unnumbered">Index</h2>

<ul class="index-cp" compact>
<li><a href="#index-algebra-of-rows-8">algebra of rows</a>: <a href="#Row-Operations">Row Operations</a></li>
<li><a href="#index-_0040code_007bbell_007d-class-19"><code>bell</code> class</a>: <a href="#The-bell-Class">The bell Class</a></li>
<li><a href="#index-change-16">change</a>: <a href="#Changes">Changes</a></li>
<li><a href="#index-change-6">change</a>: <a href="#Rows-and-changes">Rows and changes</a></li>
<li><a href="#index-_0040code_007bchange_007d-class-69"><code>change</code> class</a>: <a href="#The-change-Class">The change Class</a></li>
<li><a href="#index-cycles-15">cycles</a>: <a href="#Row-Properties">Row Properties</a></li>
<li><a href="#index-eBackstroke-253">eBackstroke</a>: <a href="#Stroke-Enumeration">Stroke Enumeration</a></li>
<li><a href="#index-eBoth-254">eBoth</a>: <a href="#Stroke-Enumeration">Stroke Enumeration</a></li>
<li><a href="#index-eHandstroke-252">eHandstroke</a>: <a href="#Stroke-Enumeration">Stroke Enumeration</a></li>
<li><a href="#index-EStroke-251">EStroke</a>: <a href="#Stroke-Enumeration">Stroke Enumeration</a></li>
<li><a href="#index-facets-159">facets</a>: <a href="#Facets">Facets</a></li>
<li><a href="#index-falseness-storage-247">falseness storage</a>: <a href="#Falseness-Storage">Falseness Storage</a></li>
<li><a href="#index-FDL_002c-GNU-Free-Documentation-License-357">FDL, GNU Free Documentation License</a>: <a href="#GNU-Free-Documentation-License">GNU Free Documentation License</a></li>
<li><a href="#index-How-proof-works-248">How proof works</a>: <a href="#How-Proof-Works">How Proof Works</a></li>
<li><a href="#index-installation-2">installation</a>: <a href="#Installing-and-using-the-library">Installing and using the library</a></li>
<li><a href="#index-introduction-1">introduction</a>: <a href="#Introduction">Introduction</a></li>
<li><a href="#index-library-139">library</a>: <a href="#Method-libraries">Method libraries</a></li>
<li><a href="#index-_0040code_007blibrary_007d-class-141"><code>library</code> class</a>: <a href="#The-library-class">The library class</a></li>
<li><a href="#index-_0040code_007blibrary_007d-internals-201"><code>library</code> internals</a>: <a href="#library-internals">library internals</a></li>
<li><a href="#index-_0040code_007blibrary_003a_003aconst_005fiterator_007d-class-192"><code>library::const_iterator</code> class</a>: <a href="#The-library_005fbase-const_005fiterator-class">The library_base const_iterator class</a></li>
<li><a href="#index-_0040code_007blibrary_005fbase_007d-class-179"><code>library_base</code> class</a>: <a href="#The-library_005fbase-class">The library_base class</a></li>
<li><a href="#index-_0040code_007blibrary_005fbase_003a_003aconst_005fiterator_007d-class-191"><code>library_base::const_iterator</code> class</a>: <a href="#The-library_005fbase-const_005fiterator-class">The library_base const_iterator class</a></li>
<li><a href="#index-_0040code_007blibrary_005fentry_007d-class-151"><code>library_entry</code> class</a>: <a href="#The-library_005fentry-class">The library_entry class</a></li>
<li><a href="#index-_0040code_007blibrary_005fentry_007d-internals-218"><code>library_entry</code> internals</a>: <a href="#library_005fentry-internals">library_entry internals</a></li>
<li><a href="#index-_0040code_007blibrary_005fentry_003a_003aimpl_007d-class-226"><code>library_entry::impl</code> class</a>: <a href="#The-library_005fentry-impl-class">The library_entry impl class</a></li>
<li><a href="#index-method-107">method</a>: <a href="#Methods">Methods</a></li>
<li><a href="#index-_0040code_007bmethod_007d-class-108"><code>method</code> class</a>: <a href="#The-method-Class">The method Class</a></li>
<li><a href="#index-method-library-140">method library</a>: <a href="#Method-libraries">Method libraries</a></li>
<li><a href="#index-Music-Analysis-249">Music Analysis</a>: <a href="#Musical-Analysis">Musical Analysis</a></li>
<li><a href="#index-music-class-271">music class</a>: <a href="#music-class-definition">music class definition</a></li>
<li><a href="#index-music-class-250">music class</a>: <a href="#Musical-Analysis">Musical Analysis</a></li>
<li><a href="#index-Music-Expressions-258">Music Expressions</a>: <a href="#Music-Regular-Expressions">Music Regular Expressions</a></li>
<li><a href="#index-music_005fdetails-259">music_details</a>: <a href="#Music_005fDetails-class">Music_Details class</a></li>
<li><a href="#index-music_005fnode-288">music_node</a>: <a href="#music-node-class-definition">music node class definition</a></li>
<li><a href="#index-Musical-Rows-257">Musical Rows</a>: <a href="#Music-Regular-Expressions">Music Regular Expressions</a></li>
<li><a href="#index-order-12">order</a>: <a href="#Row-Properties">Row Properties</a></li>
<li><a href="#index-parity-14">parity</a>: <a href="#Row-Properties">Row Properties</a></li>
<li><a href="#index-_0040code_007bpermute_007d-function-96"><code>permute</code> function</a>: <a href="#The-permute-function">The permute function</a></li>
<li><a href="#index-place-notation-17">place notation</a>: <a href="#Changes">Changes</a></li>
<li><a href="#index-printing-300">printing</a>: <a href="#Producing-printed-output">Producing printed output</a></li>
<li><a href="#index-_0040code_007bproof_007d-class-235"><code>proof</code> class</a>: <a href="#Proof">Proof</a></li>
<li><a href="#index-proving-rows-234">proving rows</a>: <a href="#Proof">Proof</a></li>
<li><a href="#index-Regular-Expressions-255">Regular Expressions</a>: <a href="#Music-Regular-Expressions">Music Regular Expressions</a></li>
<li><a href="#index-row-5">row</a>: <a href="#Rows-and-changes">Rows and changes</a></li>
<li><a href="#index-row-algebra-7">row algebra</a>: <a href="#Row-Operations">Row Operations</a></li>
<li><a href="#index-_0040code_007brow_007d-class-27"><code>row</code> class</a>: <a href="#The-row-Class">The row Class</a></li>
<li><a href="#index-row-operations-9">row operations</a>: <a href="#Row-Operations">Row Operations</a></li>
<li><a href="#index-row-properties-11">row properties</a>: <a href="#Row-Properties">Row Properties</a></li>
<li><a href="#index-_0040code_007brow_005fblock_007d-class-103"><code>row_block</code> class</a>: <a href="#The-row_005fblock-class">The row_block class</a></li>
<li><a href="#index-sign-13">sign</a>: <a href="#Row-Properties">Row Properties</a></li>
<li><a href="#index-Specifiying-Musical-Rows-256">Specifiying Musical Rows</a>: <a href="#Music-Regular-Expressions">Music Regular Expressions</a></li>
<li><a href="#index-Standard-Template-Library-3">Standard Template Library</a>: <a href="#The-Standard-Template-Library">The Standard Template Library</a></li>
<li><a href="#index-STL-4">STL</a>: <a href="#The-Standard-Template-Library">The Standard Template Library</a></li>
<li><a href="#index-swap-18">swap</a>: <a href="#Changes">Changes</a></li>
<li><a href="#index-transposition-10">transposition</a>: <a href="#Row-Operations">Row Operations</a></li>
<li><a href="#index-XML-libraries-166">XML libraries</a>: <a href="#XML-libraries">XML libraries</a></li>
<li><a href="#index-_0040code_007bxmllib_007d-class-167"><code>xmllib</code> class</a>: <a href="#The-xmllib-class">The xmllib class</a></li>
   </ul></body></html>

